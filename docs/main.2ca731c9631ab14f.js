"use strict";(self.webpackChunkcalculator_AI_jb7=self.webpackChunkcalculator_AI_jb7||[]).push([[179],{383:(Fn,mt,ae)=>{ae.d(mt,{u:()=>yM});const U="180",R={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},st={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},at=0,qe=1,Ft=2,It=1,Ve=2,Le=3,pt=0,fn=1,nt=2,Qt=0,Xt=1,Nn=2,Pn=3,Di=4,kt=5,wt=100,dt=101,pn=102,ti=103,He=104,St=200,Fe=201,gt=202,un=203,jn=204,$t=205,Os=206,ur=207,Da=208,Ia=209,cc=210,cs=211,ye=212,be=213,Se=214,Ee=0,et=1,je=2,Wt=3,hi=4,fi=5,Mt=6,Ii=7,Ui=0,ho=1,In=2,Li=0,vr=1,pi=2,Lr=3,ll=4,uc=5,lu=6,Qo=7,Xe=301,xt=302,Fs=303,qi=304,xr=306,Ks=1e3,Ln=1001,cu=1002,qn=1003,md=1004,ea=1005,dr=1006,na=1007,oe=1008,We=1009,ze=1010,Ut=1011,ni=1012,Bi=1013,Cn=1014,si=1015,Qr=1016,ws=1017,ii=1018,_t=1020,Un=35902,ri=35899,us=1021,vi=1022,on=1023,Us=1026,fo=1027,ia=1028,cl=1029,Bs=1030,ra=1031,kn=1033,hc=33776,fc=33777,sa=33778,Cs=33779,ul=35840,Mr=35841,uu=35842,dl=35843,Zn=36196,Zi=37492,Ki=37496,Ao=37808,hr=37809,Do=37810,hl=37811,Pa=37812,ds=37813,Rt=37814,mn=37815,Ri=37816,Ci=37817,hs=37818,Wi=37819,br=37820,xi=37821,fl=36492,es=36494,dn=36495,oa=36283,aa=36284,du=36285,Pi=36286,ms=3201,Ts=0,Fa=1,Sr="",gi="srgb",As="srgb-linear",po="linear",ci="srgb",gl=7680,Tm=512,Js=513,mc=514,ua=515,gc=516,Fh=517,pu=518,yl=519,gs="300 es",ts=2e3;class _o{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return void 0!==i&&void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){const i=this._listeners;if(void 0===i)return;const s=i[e];if(void 0!==s){const a=s.indexOf(t);-1!==a&&s.splice(a,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const i=t[e.type];if(void 0!==i){e.target=this;const s=i.slice(0);for(let a=0,d=s.length;a<d;a++)s[a].call(this,e);e.target=null}}}const Er=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Qs=1234567;const Ro=Math.PI/180,Vs=180/Math.PI;function Yt(){const l=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Er[255&l]+Er[l>>8&255]+Er[l>>16&255]+Er[l>>24&255]+"-"+Er[255&e]+Er[e>>8&255]+"-"+Er[e>>16&15|64]+Er[e>>24&255]+"-"+Er[63&t|128]+Er[t>>8&255]+"-"+Er[t>>16&255]+Er[t>>24&255]+Er[255&i]+Er[i>>8&255]+Er[i>>16&255]+Er[i>>24&255]).toLowerCase()}function Ct(l,e,t){return Math.max(e,Math.min(t,l))}function _d(l,e){return(l%e+e)%e}function yo(l,e,t){return(1-t)*l+t*e}function $i(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return l/4294967295;case Uint16Array:return l/65535;case Uint8Array:return l/255;case Int32Array:return Math.max(l/2147483647,-1);case Int16Array:return Math.max(l/32767,-1);case Int8Array:return Math.max(l/127,-1);default:throw new Error("Invalid component type.")}}function Tn(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return Math.round(4294967295*l);case Uint16Array:return Math.round(65535*l);case Uint8Array:return Math.round(255*l);case Int32Array:return Math.round(2147483647*l);case Int16Array:return Math.round(32767*l);case Int8Array:return Math.round(127*l);default:throw new Error("Invalid component type.")}}const fr={DEG2RAD:Ro,RAD2DEG:Vs,generateUUID:Yt,clamp:Ct,euclideanModulo:_d,mapLinear:function Vh(l,e,t,i,s){return i+(l-e)*(s-i)/(t-e)},inverseLerp:function Hh(l,e,t){return l!==e?(t-l)/(e-l):0},lerp:yo,damp:function zh(l,e,t,i){return yo(l,e,1-Math.exp(-t*i))},pingpong:function rp(l,e=1){return e-Math.abs(_d(l,2*e)-e)},smoothstep:function yd(l,e,t){return l<=e?0:l>=t?1:(l=(l-e)/(t-e))*l*(3-2*l)},smootherstep:function Ge(l,e,t){return l<=e?0:l>=t?1:(l=(l-e)/(t-e))*l*l*(l*(6*l-15)+10)},randInt:function Xn(l,e){return l+Math.floor(Math.random()*(e-l+1))},randFloat:function Ua(l,e){return l+Math.random()*(e-l)},randFloatSpread:function _u(l){return l*(.5-Math.random())},seededRandom:function or(l){void 0!==l&&(Qs=l);let e=Qs+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function vd(l){return l*Ro},radToDeg:function Po(l){return l*Vs},isPowerOfTwo:function Gr(l){return 0==(l&l-1)&&0!==l},ceilPowerOfTwo:function Ba(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},floorPowerOfTwo:function Hs(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},setQuaternionFromProperEuler:function _c(l,e,t,i,s){const a=Math.cos,d=Math.sin,m=a(t/2),y=d(t/2),v=a((e+i)/2),M=d((e+i)/2),b=a((e-i)/2),E=d((e-i)/2),C=a((i-e)/2),D=d((i-e)/2);switch(s){case"XYX":l.set(m*M,y*b,y*E,m*v);break;case"YZY":l.set(y*E,m*M,y*b,m*v);break;case"ZXZ":l.set(y*b,y*E,m*M,m*v);break;case"XZX":l.set(m*M,y*D,y*C,m*v);break;case"YXY":l.set(y*C,m*M,y*D,m*v);break;case"ZYZ":l.set(y*D,y*C,m*M,m*v);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}},normalize:Tn,denormalize:$i};class Ce{constructor(e=0,t=0){Ce.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Ct(this.x,e.x,t.x),this.y=Ct(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Ct(this.x,e,t),this.y=Ct(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Ct(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ct(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),s=Math.sin(t),a=this.x-e.x,d=this.y-e.y;return this.x=a*i-d*s+e.x,this.y=a*s+d*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class wr{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,a,d,m){let y=i[s+0],v=i[s+1],M=i[s+2],b=i[s+3];const E=a[d+0],C=a[d+1],D=a[d+2],O=a[d+3];if(0===m)return e[t+0]=y,e[t+1]=v,e[t+2]=M,void(e[t+3]=b);if(1===m)return e[t+0]=E,e[t+1]=C,e[t+2]=D,void(e[t+3]=O);if(b!==O||y!==E||v!==C||M!==D){let N=1-m;const A=y*E+v*C+M*D+b*O,H=A>=0?1:-1,k=1-A*A;if(k>Number.EPSILON){const Z=Math.sqrt(k),q=Math.atan2(Z,A*H);N=Math.sin(N*q)/Z,m=Math.sin(m*q)/Z}const V=m*H;if(y=y*N+E*V,v=v*N+C*V,M=M*N+D*V,b=b*N+O*V,N===1-m){const Z=1/Math.sqrt(y*y+v*v+M*M+b*b);y*=Z,v*=Z,M*=Z,b*=Z}}e[t]=y,e[t+1]=v,e[t+2]=M,e[t+3]=b}static multiplyQuaternionsFlat(e,t,i,s,a,d){const m=i[s],y=i[s+1],v=i[s+2],M=i[s+3],b=a[d],E=a[d+1],C=a[d+2],D=a[d+3];return e[t]=m*D+M*b+y*C-v*E,e[t+1]=y*D+M*E+v*b-m*C,e[t+2]=v*D+M*C+m*E-y*b,e[t+3]=M*D-m*b-y*E-v*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,s=e._y,a=e._z,d=e._order,m=Math.cos,y=Math.sin,v=m(i/2),M=m(s/2),b=m(a/2),E=y(i/2),C=y(s/2),D=y(a/2);switch(d){case"XYZ":this._x=E*M*b+v*C*D,this._y=v*C*b-E*M*D,this._z=v*M*D+E*C*b,this._w=v*M*b-E*C*D;break;case"YXZ":this._x=E*M*b+v*C*D,this._y=v*C*b-E*M*D,this._z=v*M*D-E*C*b,this._w=v*M*b+E*C*D;break;case"ZXY":this._x=E*M*b-v*C*D,this._y=v*C*b+E*M*D,this._z=v*M*D+E*C*b,this._w=v*M*b-E*C*D;break;case"ZYX":this._x=E*M*b-v*C*D,this._y=v*C*b+E*M*D,this._z=v*M*D-E*C*b,this._w=v*M*b+E*C*D;break;case"YZX":this._x=E*M*b+v*C*D,this._y=v*C*b+E*M*D,this._z=v*M*D-E*C*b,this._w=v*M*b-E*C*D;break;case"XZY":this._x=E*M*b-v*C*D,this._y=v*C*b-E*M*D,this._z=v*M*D+E*C*b,this._w=v*M*b+E*C*D;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],s=t[4],a=t[8],d=t[1],m=t[5],y=t[9],v=t[2],M=t[6],b=t[10],E=i+m+b;if(E>0){const C=.5/Math.sqrt(E+1);this._w=.25/C,this._x=(M-y)*C,this._y=(a-v)*C,this._z=(d-s)*C}else if(i>m&&i>b){const C=2*Math.sqrt(1+i-m-b);this._w=(M-y)/C,this._x=.25*C,this._y=(s+d)/C,this._z=(a+v)/C}else if(m>b){const C=2*Math.sqrt(1+m-i-b);this._w=(a-v)/C,this._x=(s+d)/C,this._y=.25*C,this._z=(y+M)/C}else{const C=2*Math.sqrt(1+b-i-m);this._w=(d-s)/C,this._x=(a+v)/C,this._y=(y+M)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ct(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,s=e._y,a=e._z,d=e._w,m=t._x,y=t._y,v=t._z,M=t._w;return this._x=i*M+d*m+s*v-a*y,this._y=s*M+d*y+a*m-i*v,this._z=a*M+d*v+i*y-s*m,this._w=d*M-i*m-s*y-a*v,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,s=this._y,a=this._z,d=this._w;let m=d*e._w+i*e._x+s*e._y+a*e._z;if(m<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,m=-m):this.copy(e),m>=1)return this._w=d,this._x=i,this._y=s,this._z=a,this;const y=1-m*m;if(y<=Number.EPSILON){const C=1-t;return this._w=C*d+t*this._w,this._x=C*i+t*this._x,this._y=C*s+t*this._y,this._z=C*a+t*this._z,this.normalize(),this}const v=Math.sqrt(y),M=Math.atan2(v,m),b=Math.sin((1-t)*M)/v,E=Math.sin(t*M)/v;return this._w=d*b+this._w*E,this._x=i*b+this._x*E,this._y=s*b+this._y*E,this._z=a*b+this._z*E,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),a=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,t=0,i=0){K.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Gh.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Gh.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[3]*i+a[6]*s,this.y=a[1]*t+a[4]*i+a[7]*s,this.z=a[2]*t+a[5]*i+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,a=e.elements,d=1/(a[3]*t+a[7]*i+a[11]*s+a[15]);return this.x=(a[0]*t+a[4]*i+a[8]*s+a[12])*d,this.y=(a[1]*t+a[5]*i+a[9]*s+a[13])*d,this.z=(a[2]*t+a[6]*i+a[10]*s+a[14])*d,this}applyQuaternion(e){const t=this.x,i=this.y,s=this.z,a=e.x,d=e.y,m=e.z,y=e.w,v=2*(d*s-m*i),M=2*(m*t-a*s),b=2*(a*i-d*t);return this.x=t+y*v+d*b-m*M,this.y=i+y*M+m*v-a*b,this.z=s+y*b+a*M-d*v,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*s,this.y=a[1]*t+a[5]*i+a[9]*s,this.z=a[2]*t+a[6]*i+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Ct(this.x,e.x,t.x),this.y=Ct(this.y,e.y,t.y),this.z=Ct(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Ct(this.x,e,t),this.y=Ct(this.y,e,t),this.z=Ct(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Ct(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,s=e.y,a=e.z,d=t.x,m=t.y,y=t.z;return this.x=s*y-a*m,this.y=a*d-i*y,this.z=i*m-s*d,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return eo.copy(this).projectOnVector(e),this.sub(eo)}reflect(e){return this.sub(eo.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Ct(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const eo=new K,Gh=new wr;class Rn{constructor(e,t,i,s,a,d,m,y,v){Rn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,s,a,d,m,y,v)}set(e,t,i,s,a,d,m,y,v){const M=this.elements;return M[0]=e,M[1]=s,M[2]=m,M[3]=t,M[4]=a,M[5]=y,M[6]=i,M[7]=d,M[8]=v,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,a=this.elements,d=i[0],m=i[3],y=i[6],v=i[1],M=i[4],b=i[7],E=i[2],C=i[5],D=i[8],O=s[0],N=s[3],A=s[6],H=s[1],k=s[4],V=s[7],Z=s[2],q=s[5],ee=s[8];return a[0]=d*O+m*H+y*Z,a[3]=d*N+m*k+y*q,a[6]=d*A+m*V+y*ee,a[1]=v*O+M*H+b*Z,a[4]=v*N+M*k+b*q,a[7]=v*A+M*V+b*ee,a[2]=E*O+C*H+D*Z,a[5]=E*N+C*k+D*q,a[8]=E*A+C*V+D*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],s=e[2],a=e[3],d=e[4],m=e[5],y=e[6],v=e[7],M=e[8];return t*d*M-t*m*v-i*a*M+i*m*y+s*a*v-s*d*y}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],a=e[3],d=e[4],m=e[5],y=e[6],v=e[7],M=e[8],b=M*d-m*v,E=m*y-M*a,C=v*a-d*y,D=t*b+i*E+s*C;if(0===D)return this.set(0,0,0,0,0,0,0,0,0);const O=1/D;return e[0]=b*O,e[1]=(s*v-M*i)*O,e[2]=(m*i-s*d)*O,e[3]=E*O,e[4]=(M*t-s*y)*O,e[5]=(s*a-m*t)*O,e[6]=C*O,e[7]=(i*y-v*t)*O,e[8]=(d*t-i*a)*O,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,a,d,m){const y=Math.cos(a),v=Math.sin(a);return this.set(i*y,i*v,-i*(y*d+v*m)+d+e,-s*v,s*y,-s*(-v*d+y*m)+m+t,0,0,1),this}scale(e,t){return this.premultiply(xd.makeScale(e,t)),this}rotate(e){return this.premultiply(xd.makeRotation(-e)),this}translate(e,t){return this.premultiply(xd.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const xd=new Rn;function Wh(l){for(let e=l.length-1;e>=0;--e)if(l[e]>=65535)return!0;return!1}function Ml(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}function bd(){const l=Ml("canvas");return l.style.display="block",l}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const yu={};function bl(l){l in yu||(yu[l]=!0,console.warn(l))}const xu=(new Rn).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Sd=(new Rn).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function $h(){const l={enabled:!0,workingColorSpace:As,spaces:{},convert:function(s,a,d){return!1===this.enabled||a===d||!a||!d||(this.spaces[a].transfer===ci&&(s.r=Ds(s.r),s.g=Ds(s.g),s.b=Ds(s.b)),this.spaces[a].primaries!==this.spaces[d].primaries&&(s.applyMatrix3(this.spaces[a].toXYZ),s.applyMatrix3(this.spaces[d].fromXYZ)),this.spaces[d].transfer===ci&&(s.r=ha(s.r),s.g=ha(s.g),s.b=ha(s.b))),s},workingToColorSpace:function(s,a){return this.convert(s,this.workingColorSpace,a)},colorSpaceToWorking:function(s,a){return this.convert(s,a,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Sr?po:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,a=this.workingColorSpace){return s.fromArray(this.spaces[a].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,a,d){return s.copy(this.spaces[a].toXYZ).multiply(this.spaces[d].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,a){return bl("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),l.workingToColorSpace(s,a)},toWorkingColorSpace:function(s,a){return bl("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),l.colorSpaceToWorking(s,a)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return l.define({[As]:{primaries:e,whitePoint:i,transfer:po,toXYZ:xu,fromXYZ:Sd,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:gi},outputColorSpaceConfig:{drawingBufferColorSpace:gi}},[gi]:{primaries:e,whitePoint:i,transfer:ci,toXYZ:xu,fromXYZ:Sd,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:gi}}}),l}const Kn=$h();function Ds(l){return l<.04045?.0773993808*l:Math.pow(.9478672986*l+.0521327014,2.4)}function ha(l){return l<.0031308?12.92*l:1.055*Math.pow(l,.41666)-.055}let _s;class ar{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{void 0===_s&&(_s=Ml("canvas")),_s.width=e.width,_s.height=e.height;const s=_s.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=_s}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Ml("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),a=s.data;for(let d=0;d<a.length;d++)a[d]=255*Ds(a[d]/255);return i.putImageData(s,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Ds(t[i]/255)):Ds(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let fa=0;class _i{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:fa++}),this.uuid=Yt(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(null!==s){let a;if(Array.isArray(s)){a=[];for(let d=0,m=s.length;d<m;d++)a.push(Mu(s[d].isDataTexture?s[d].image:s[d]))}else a=Mu(s);i.url=a}return t||(e.images[this.uuid]=i),i}}function Mu(l){return typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&l instanceof ImageBitmap?ar.getDataURL(l):l.data?{data:Array.from(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let T=0;const B=new K;let P=(()=>{class l extends _o{constructor(t=l.DEFAULT_IMAGE,i=l.DEFAULT_MAPPING,s=Ln,a=Ln,d=dr,m=oe,y=on,v=We,M=l.DEFAULT_ANISOTROPY,b=Sr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:T++}),this.uuid=Yt(),this.name="",this.source=new _i(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=a,this.magFilter=d,this.minFilter=m,this.anisotropy=M,this.format=y,this.internalFormat=null,this.type=v,this.offset=new Ce(0,0),this.repeat=new Ce(1,1),this.center=new Ce(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Rn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=b,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(B).x}get height(){return this.source.getSize(B).y}get depth(){return this.source.getSize(B).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,i){this.updateRanges.push({start:t,count:i})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const i in t){const s=t[i];if(void 0===s){console.warn(`THREE.Texture.setValues(): parameter '${i}' has value of undefined.`);continue}const a=this[i];void 0!==a?a&&s&&a.isVector2&&s.isVector2||a&&s&&a.isVector3&&s.isVector3||a&&s&&a.isMatrix3&&s.isMatrix3?a.copy(s):this[i]=s:console.warn(`THREE.Texture.setValues(): property '${i}' does not exist.`)}}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const s={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ks:t.x=t.x-Math.floor(t.x);break;case Ln:t.x=t.x<0?0:1;break;case cu:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ks:t.y=t.y-Math.floor(t.y);break;case Ln:t.y=t.y<0?0:1;break;case cu:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}return l.DEFAULT_IMAGE=null,l.DEFAULT_MAPPING=300,l.DEFAULT_ANISOTROPY=1,l})();class G{constructor(e=0,t=0,i=0,s=1){G.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,a=this.w,d=e.elements;return this.x=d[0]*t+d[4]*i+d[8]*s+d[12]*a,this.y=d[1]*t+d[5]*i+d[9]*s+d[13]*a,this.z=d[2]*t+d[6]*i+d[10]*s+d[14]*a,this.w=d[3]*t+d[7]*i+d[11]*s+d[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,a;const y=e.elements,v=y[0],M=y[4],b=y[8],E=y[1],C=y[5],D=y[9],O=y[2],N=y[6],A=y[10];if(Math.abs(M-E)<.01&&Math.abs(b-O)<.01&&Math.abs(D-N)<.01){if(Math.abs(M+E)<.1&&Math.abs(b+O)<.1&&Math.abs(D+N)<.1&&Math.abs(v+C+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(v+1)/2,V=(C+1)/2,Z=(A+1)/2,q=(M+E)/4,ee=(b+O)/4,ne=(D+N)/4;return k>V&&k>Z?k<.01?(i=0,s=.707106781,a=.707106781):(i=Math.sqrt(k),s=q/i,a=ee/i):V>Z?V<.01?(i=.707106781,s=0,a=.707106781):(s=Math.sqrt(V),i=q/s,a=ne/s):Z<.01?(i=.707106781,s=.707106781,a=0):(a=Math.sqrt(Z),i=ee/a,s=ne/a),this.set(i,s,a,t),this}let H=Math.sqrt((N-D)*(N-D)+(b-O)*(b-O)+(E-M)*(E-M));return Math.abs(H)<.001&&(H=1),this.x=(N-D)/H,this.y=(b-O)/H,this.z=(E-M)/H,this.w=Math.acos((v+C+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Ct(this.x,e.x,t.x),this.y=Ct(this.y,e.y,t.y),this.z=Ct(this.z,e.z,t.z),this.w=Ct(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Ct(this.x,e,t),this.y=Ct(this.y,e,t),this.z=Ct(this.z,e,t),this.w=Ct(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Ct(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class te extends _o{constructor(e=1,t=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:dr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth,this.scissor=new G(0,0,e,t),this.scissorTest=!1,this.viewport=new G(0,0,e,t);const a=new P({width:e,height:t,depth:i.depth});this.textures=[];const d=i.count;for(let m=0;m<d;m++)this.textures[m]=a.clone(),this.textures[m].isRenderTargetTexture=!0,this.textures[m].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const t={minFilter:dr,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let s=0,a=this.textures.length;s<a;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=i,this.textures[s].isArrayTexture=this.textures[s].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new _i(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class _e extends te{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Ae extends P{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=qn,this.minFilter=qn,this.wrapR=Ln,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Qn extends P{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=qn,this.minFilter=qn,this.wrapR=Ln,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class gn{constructor(e=new K(1/0,1/0,1/0),t=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Yn.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Yn.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Yn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const a=i.getAttribute("position");if(!0===t&&void 0!==a&&!0!==e.isInstancedMesh)for(let d=0,m=a.count;d<m;d++)!0===e.isMesh?e.getVertexPosition(d,Yn):Yn.fromBufferAttribute(a,d),Yn.applyMatrix4(e.matrixWorld),this.expandByPoint(Yn);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),ai.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),ai.copy(i.boundingBox)),ai.applyMatrix4(e.matrixWorld),this.union(ai)}const s=e.children;for(let a=0,d=s.length;a<d;a++)this.expandByObject(s[a],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Yn),Yn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ys),vs.subVectors(this.max,ys),ki.subVectors(e.a,ys),Fr.subVectors(e.b,ys),ns.subVectors(e.c,ys),is.subVectors(Fr,ki),pr.subVectors(ns,Fr),Ur.subVectors(ki,ns);let t=[0,-is.z,is.y,0,-pr.z,pr.y,0,-Ur.z,Ur.y,is.z,0,-is.x,pr.z,0,-pr.x,Ur.z,0,-Ur.x,-is.y,is.x,0,-pr.y,pr.x,0,-Ur.y,Ur.x,0];return!(!pa(t,ki,Fr,ns,vs)||(t=[1,0,0,0,1,0,0,0,1],!pa(t,ki,Fr,ns,vs)))&&(bu.crossVectors(is,pr),t=[bu.x,bu.y,bu.z],pa(t,ki,Fr,ns,vs))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Yn).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Yn).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(_n[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_n[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_n[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_n[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_n[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_n[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_n[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_n[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_n)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const _n=[new K,new K,new K,new K,new K,new K,new K,new K],Yn=new K,ai=new gn,ki=new K,Fr=new K,ns=new K,is=new K,pr=new K,Ur=new K,ys=new K,vs=new K,bu=new K,ka=new K;function pa(l,e,t,i,s){for(let a=0,d=l.length-3;a<=d;a+=3){ka.fromArray(l,a);const m=s.x*Math.abs(ka.x)+s.y*Math.abs(ka.y)+s.z*Math.abs(ka.z),y=e.dot(ka),v=t.dot(ka),M=i.dot(ka);if(Math.max(-Math.max(y,v,M),Math.min(y,v,M))>m)return!1}return!0}const jh=new gn,Su=new K,Eu=new K;class Wr{constructor(e=new K,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):jh.setFromPoints(e).getCenter(i);let s=0;for(let a=0,d=e.length;a<d;a++)s=Math.max(s,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Su.subVectors(e,this.center);const t=Su.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),s=.5*(i-this.radius);this.center.addScaledVector(Su,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Eu.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Su.copy(e.center).add(Eu)),this.expandByPoint(Su.copy(e.center).sub(Eu))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const vo=new K,Sl=new K,El=new K,wl=new K,Ed=new K,Cl=new K,Is=new K;class rs{constructor(e=new K,t=new K(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,vo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=vo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(vo.copy(this.origin).addScaledVector(this.direction,t),vo.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){Sl.copy(e).add(t).multiplyScalar(.5),El.copy(t).sub(e).normalize(),wl.copy(this.origin).sub(Sl);const a=.5*e.distanceTo(t),d=-this.direction.dot(El),m=wl.dot(this.direction),y=-wl.dot(El),v=wl.lengthSq(),M=Math.abs(1-d*d);let b,E,C,D;if(M>0)if(b=d*y-m,E=d*m-y,D=a*M,b>=0)if(E>=-D)if(E<=D){const O=1/M;b*=O,E*=O,C=b*(b+d*E+2*m)+E*(d*b+E+2*y)+v}else E=a,b=Math.max(0,-(d*E+m)),C=-b*b+E*(E+2*y)+v;else E=-a,b=Math.max(0,-(d*E+m)),C=-b*b+E*(E+2*y)+v;else E<=-D?(b=Math.max(0,-(-d*a+m)),E=b>0?-a:Math.min(Math.max(-a,-y),a),C=-b*b+E*(E+2*y)+v):E<=D?(b=0,E=Math.min(Math.max(-a,-y),a),C=E*(E+2*y)+v):(b=Math.max(0,-(d*a+m)),E=b>0?a:Math.min(Math.max(-a,-y),a),C=-b*b+E*(E+2*y)+v);else E=d>0?-a:a,b=Math.max(0,-(d*E+m)),C=-b*b+E*(E+2*y)+v;return i&&i.copy(this.origin).addScaledVector(this.direction,b),s&&s.copy(Sl).addScaledVector(El,E),C}intersectSphere(e,t){vo.subVectors(e.center,this.origin);const i=vo.dot(this.direction),s=vo.dot(vo)-i*i,a=e.radius*e.radius;if(s>a)return null;const d=Math.sqrt(a-s),m=i-d,y=i+d;return y<0?null:this.at(m<0?y:m,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,a,d,m,y;const v=1/this.direction.x,M=1/this.direction.y,b=1/this.direction.z,E=this.origin;return v>=0?(i=(e.min.x-E.x)*v,s=(e.max.x-E.x)*v):(i=(e.max.x-E.x)*v,s=(e.min.x-E.x)*v),M>=0?(a=(e.min.y-E.y)*M,d=(e.max.y-E.y)*M):(a=(e.max.y-E.y)*M,d=(e.min.y-E.y)*M),i>d||a>s||((a>i||isNaN(i))&&(i=a),(d<s||isNaN(s))&&(s=d),b>=0?(m=(e.min.z-E.z)*b,y=(e.max.z-E.z)*b):(m=(e.max.z-E.z)*b,y=(e.min.z-E.z)*b),i>y||m>s)||((m>i||i!=i)&&(i=m),(y<s||s!=s)&&(s=y),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return null!==this.intersectBox(e,vo)}intersectTriangle(e,t,i,s,a){Ed.subVectors(t,e),Cl.subVectors(i,e),Is.crossVectors(Ed,Cl);let m,d=this.direction.dot(Is);if(d>0){if(s)return null;m=1}else{if(!(d<0))return null;m=-1,d=-d}wl.subVectors(this.origin,e);const y=m*this.direction.dot(Cl.crossVectors(wl,Cl));if(y<0)return null;const v=m*this.direction.dot(Ed.cross(wl));if(v<0||y+v>d)return null;const M=-m*wl.dot(Is);return M<0?null:this.at(M/d,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class yn{constructor(e,t,i,s,a,d,m,y,v,M,b,E,C,D,O,N){yn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,s,a,d,m,y,v,M,b,E,C,D,O,N)}set(e,t,i,s,a,d,m,y,v,M,b,E,C,D,O,N){const A=this.elements;return A[0]=e,A[4]=t,A[8]=i,A[12]=s,A[1]=a,A[5]=d,A[9]=m,A[13]=y,A[2]=v,A[6]=M,A[10]=b,A[14]=E,A[3]=C,A[7]=D,A[11]=O,A[15]=N,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new yn).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,s=1/ma.setFromMatrixColumn(e,0).length(),a=1/ma.setFromMatrixColumn(e,1).length(),d=1/ma.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*a,t[5]=i[5]*a,t[6]=i[6]*a,t[7]=0,t[8]=i[8]*d,t[9]=i[9]*d,t[10]=i[10]*d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,s=e.y,a=e.z,d=Math.cos(i),m=Math.sin(i),y=Math.cos(s),v=Math.sin(s),M=Math.cos(a),b=Math.sin(a);if("XYZ"===e.order){const E=d*M,C=d*b,D=m*M,O=m*b;t[0]=y*M,t[4]=-y*b,t[8]=v,t[1]=C+D*v,t[5]=E-O*v,t[9]=-m*y,t[2]=O-E*v,t[6]=D+C*v,t[10]=d*y}else if("YXZ"===e.order){const E=y*M,C=y*b,D=v*M,O=v*b;t[0]=E+O*m,t[4]=D*m-C,t[8]=d*v,t[1]=d*b,t[5]=d*M,t[9]=-m,t[2]=C*m-D,t[6]=O+E*m,t[10]=d*y}else if("ZXY"===e.order){const E=y*M,C=y*b,D=v*M,O=v*b;t[0]=E-O*m,t[4]=-d*b,t[8]=D+C*m,t[1]=C+D*m,t[5]=d*M,t[9]=O-E*m,t[2]=-d*v,t[6]=m,t[10]=d*y}else if("ZYX"===e.order){const E=d*M,C=d*b,D=m*M,O=m*b;t[0]=y*M,t[4]=D*v-C,t[8]=E*v+O,t[1]=y*b,t[5]=O*v+E,t[9]=C*v-D,t[2]=-v,t[6]=m*y,t[10]=d*y}else if("YZX"===e.order){const E=d*y,C=d*v,D=m*y,O=m*v;t[0]=y*M,t[4]=O-E*b,t[8]=D*b+C,t[1]=b,t[5]=d*M,t[9]=-m*M,t[2]=-v*M,t[6]=C*b+D,t[10]=E-O*b}else if("XZY"===e.order){const E=d*y,C=d*v,D=m*y,O=m*v;t[0]=y*M,t[4]=-b,t[8]=v*M,t[1]=E*b+O,t[5]=d*M,t[9]=C*b-D,t[2]=D*b-C,t[6]=m*M,t[10]=O*b+E}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Xh,e,yc)}lookAt(e,t,i){const s=this.elements;return Cr.subVectors(e,t),0===Cr.lengthSq()&&(Cr.z=1),Cr.normalize(),No.crossVectors(i,Cr),0===No.lengthSq()&&(1===Math.abs(i.z)?Cr.x+=1e-4:Cr.z+=1e-4,Cr.normalize(),No.crossVectors(i,Cr)),No.normalize(),wd.crossVectors(Cr,No),s[0]=No.x,s[4]=wd.x,s[8]=Cr.x,s[1]=No.y,s[5]=wd.y,s[9]=Cr.y,s[2]=No.z,s[6]=wd.z,s[10]=Cr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,a=this.elements,d=i[0],m=i[4],y=i[8],v=i[12],M=i[1],b=i[5],E=i[9],C=i[13],D=i[2],O=i[6],N=i[10],A=i[14],H=i[3],k=i[7],V=i[11],Z=i[15],q=s[0],ee=s[4],ne=s[8],X=s[12],j=s[1],se=s[5],me=s[9],ve=s[13],we=s[2],Ne=s[6],De=s[10],it=s[14],Ie=s[3],At=s[7],zt=s[11],qt=s[15];return a[0]=d*q+m*j+y*we+v*Ie,a[4]=d*ee+m*se+y*Ne+v*At,a[8]=d*ne+m*me+y*De+v*zt,a[12]=d*X+m*ve+y*it+v*qt,a[1]=M*q+b*j+E*we+C*Ie,a[5]=M*ee+b*se+E*Ne+C*At,a[9]=M*ne+b*me+E*De+C*zt,a[13]=M*X+b*ve+E*it+C*qt,a[2]=D*q+O*j+N*we+A*Ie,a[6]=D*ee+O*se+N*Ne+A*At,a[10]=D*ne+O*me+N*De+A*zt,a[14]=D*X+O*ve+N*it+A*qt,a[3]=H*q+k*j+V*we+Z*Ie,a[7]=H*ee+k*se+V*Ne+Z*At,a[11]=H*ne+k*me+V*De+Z*zt,a[15]=H*X+k*ve+V*it+Z*qt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],s=e[8],a=e[12],d=e[1],m=e[5],y=e[9],v=e[13],M=e[2],b=e[6],E=e[10],C=e[14];return e[3]*(+a*y*b-s*v*b-a*m*E+i*v*E+s*m*C-i*y*C)+e[7]*(+t*y*C-t*v*E+a*d*E-s*d*C+s*v*M-a*y*M)+e[11]*(+t*v*b-t*m*C-a*d*b+i*d*C+a*m*M-i*v*M)+e[15]*(-s*m*M-t*y*b+t*m*E+s*d*b-i*d*E+i*y*M)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],a=e[3],d=e[4],m=e[5],y=e[6],v=e[7],M=e[8],b=e[9],E=e[10],C=e[11],D=e[12],O=e[13],N=e[14],A=e[15],H=b*N*v-O*E*v+O*y*C-m*N*C-b*y*A+m*E*A,k=D*E*v-M*N*v-D*y*C+d*N*C+M*y*A-d*E*A,V=M*O*v-D*b*v+D*m*C-d*O*C-M*m*A+d*b*A,Z=D*b*y-M*O*y-D*m*E+d*O*E+M*m*N-d*b*N,q=t*H+i*k+s*V+a*Z;if(0===q)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ee=1/q;return e[0]=H*ee,e[1]=(O*E*a-b*N*a-O*s*C+i*N*C+b*s*A-i*E*A)*ee,e[2]=(m*N*a-O*y*a+O*s*v-i*N*v-m*s*A+i*y*A)*ee,e[3]=(b*y*a-m*E*a-b*s*v+i*E*v+m*s*C-i*y*C)*ee,e[4]=k*ee,e[5]=(M*N*a-D*E*a+D*s*C-t*N*C-M*s*A+t*E*A)*ee,e[6]=(D*y*a-d*N*a-D*s*v+t*N*v+d*s*A-t*y*A)*ee,e[7]=(d*E*a-M*y*a+M*s*v-t*E*v-d*s*C+t*y*C)*ee,e[8]=V*ee,e[9]=(D*b*a-M*O*a-D*i*C+t*O*C+M*i*A-t*b*A)*ee,e[10]=(d*O*a-D*m*a+D*i*v-t*O*v-d*i*A+t*m*A)*ee,e[11]=(M*m*a-d*b*a-M*i*v+t*b*v+d*i*C-t*m*C)*ee,e[12]=Z*ee,e[13]=(M*O*s-D*b*s+D*i*E-t*O*E-M*i*N+t*b*N)*ee,e[14]=(D*m*s-d*O*s-D*i*y+t*O*y+d*i*N-t*m*N)*ee,e[15]=(d*b*s-M*m*s+M*i*y-t*b*y-d*i*E+t*m*E)*ee,this}scale(e){const t=this.elements,i=e.x,s=e.y,a=e.z;return t[0]*=i,t[4]*=s,t[8]*=a,t[1]*=i,t[5]*=s,t[9]*=a,t[2]*=i,t[6]*=s,t[10]*=a,t[3]*=i,t[7]*=s,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),s=Math.sin(t),a=1-i,d=e.x,m=e.y,y=e.z,v=a*d,M=a*m;return this.set(v*d+i,v*m-s*y,v*y+s*m,0,v*m+s*y,M*m+i,M*y-s*d,0,v*y-s*m,M*y+s*d,a*y*y+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,a,d){return this.set(1,i,a,0,e,1,d,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){const s=this.elements,a=t._x,d=t._y,m=t._z,y=t._w,v=a+a,M=d+d,b=m+m,E=a*v,C=a*M,D=a*b,O=d*M,N=d*b,A=m*b,H=y*v,k=y*M,V=y*b,Z=i.x,q=i.y,ee=i.z;return s[0]=(1-(O+A))*Z,s[1]=(C+V)*Z,s[2]=(D-k)*Z,s[3]=0,s[4]=(C-V)*q,s[5]=(1-(E+A))*q,s[6]=(N+H)*q,s[7]=0,s[8]=(D+k)*ee,s[9]=(N-H)*ee,s[10]=(1-(E+O))*ee,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){const s=this.elements;let a=ma.set(s[0],s[1],s[2]).length();const d=ma.set(s[4],s[5],s[6]).length(),m=ma.set(s[8],s[9],s[10]).length();this.determinant()<0&&(a=-a),e.x=s[12],e.y=s[13],e.z=s[14],zs.copy(this);const v=1/a,M=1/d,b=1/m;return zs.elements[0]*=v,zs.elements[1]*=v,zs.elements[2]*=v,zs.elements[4]*=M,zs.elements[5]*=M,zs.elements[6]*=M,zs.elements[8]*=b,zs.elements[9]*=b,zs.elements[10]*=b,t.setFromRotationMatrix(zs),i.x=a,i.y=d,i.z=m,this}makePerspective(e,t,i,s,a,d,m=ts,y=!1){const v=this.elements,M=2*a/(t-e),b=2*a/(i-s),E=(t+e)/(t-e),C=(i+s)/(i-s);let D,O;if(y)D=a/(d-a),O=d*a/(d-a);else if(m===ts)D=-(d+a)/(d-a),O=-2*d*a/(d-a);else{if(2001!==m)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+m);D=-d/(d-a),O=-d*a/(d-a)}return v[0]=M,v[4]=0,v[8]=E,v[12]=0,v[1]=0,v[5]=b,v[9]=C,v[13]=0,v[2]=0,v[6]=0,v[10]=D,v[14]=O,v[3]=0,v[7]=0,v[11]=-1,v[15]=0,this}makeOrthographic(e,t,i,s,a,d,m=ts,y=!1){const v=this.elements,M=2/(t-e),b=2/(i-s),E=-(t+e)/(t-e),C=-(i+s)/(i-s);let D,O;if(y)D=1/(d-a),O=d/(d-a);else if(m===ts)D=-2/(d-a),O=-(d+a)/(d-a);else{if(2001!==m)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+m);D=-1/(d-a),O=-a/(d-a)}return v[0]=M,v[4]=0,v[8]=0,v[12]=E,v[1]=0,v[5]=b,v[9]=0,v[13]=C,v[2]=0,v[6]=0,v[10]=D,v[14]=O,v[3]=0,v[7]=0,v[11]=0,v[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const ma=new K,zs=new yn,Xh=new K(0,0,0),yc=new K(1,1,1),No=new K,wd=new K,Cr=new K,Tl=new yn,Yh=new wr;let Lo=(()=>{class l{constructor(t=0,i=0,s=0,a=l.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=s,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,s,a=this._order){return this._x=t,this._y=i,this._z=s,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,s=!0){const a=t.elements,d=a[0],m=a[4],y=a[8],v=a[1],M=a[5],b=a[9],E=a[2],C=a[6],D=a[10];switch(i){case"XYZ":this._y=Math.asin(Ct(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(-b,D),this._z=Math.atan2(-m,d)):(this._x=Math.atan2(C,M),this._z=0);break;case"YXZ":this._x=Math.asin(-Ct(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(y,D),this._z=Math.atan2(v,M)):(this._y=Math.atan2(-E,d),this._z=0);break;case"ZXY":this._x=Math.asin(Ct(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-E,D),this._z=Math.atan2(-m,M)):(this._y=0,this._z=Math.atan2(v,d));break;case"ZYX":this._y=Math.asin(-Ct(E,-1,1)),Math.abs(E)<.9999999?(this._x=Math.atan2(C,D),this._z=Math.atan2(v,d)):(this._x=0,this._z=Math.atan2(-m,M));break;case"YZX":this._z=Math.asin(Ct(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(-b,M),this._y=Math.atan2(-E,d)):(this._x=0,this._y=Math.atan2(y,D));break;case"XZY":this._z=Math.asin(-Ct(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(C,M),this._y=Math.atan2(y,d)):(this._x=Math.atan2(-b,D),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===s&&this._onChangeCallback(),this}setFromQuaternion(t,i,s){return Tl.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Tl,i,s)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Yh.setFromEuler(this),this.setFromQuaternion(Yh,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return l.DEFAULT_ORDER="XYZ",l})();class Al{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Va=0;const Ha=new K,vc=new wr,Oo=new yn,wu=new K,Fo=new K,Am=new K,Dm=new wr,Cd=new K(1,0,0),Td=new K(0,1,0),xc=new K(0,0,1),ga={type:"added"},Mc={type:"removed"},xo={type:"childadded",child:null},za={type:"childremoved",child:null};let Br=(()=>{class l extends _o{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Va++}),this.uuid=Yt(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=l.DEFAULT_UP.clone();const t=new K,i=new Lo,s=new wr,a=new K(1,1,1);i._onChange(function d(){s.setFromEuler(i,!1)}),s._onChange(function m(){i.setFromQuaternion(s,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new yn},normalMatrix:{value:new Rn}}),this.matrix=new yn,this.matrixWorld=new yn,this.matrixAutoUpdate=l.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Al,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return vc.setFromAxisAngle(t,i),this.quaternion.multiply(vc),this}rotateOnWorldAxis(t,i){return vc.setFromAxisAngle(t,i),this.quaternion.premultiply(vc),this}rotateX(t){return this.rotateOnAxis(Cd,t)}rotateY(t){return this.rotateOnAxis(Td,t)}rotateZ(t){return this.rotateOnAxis(xc,t)}translateOnAxis(t,i){return Ha.copy(t).applyQuaternion(this.quaternion),this.position.add(Ha.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Cd,t)}translateY(t){return this.translateOnAxis(Td,t)}translateZ(t){return this.translateOnAxis(xc,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Oo.copy(this.matrixWorld).invert())}lookAt(t,i,s){t.isVector3?wu.copy(t):wu.set(t,i,s);const a=this.parent;this.updateWorldMatrix(!0,!1),Fo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Oo.lookAt(Fo,wu,this.up):Oo.lookAt(wu,Fo,this.up),this.quaternion.setFromRotationMatrix(Oo),a&&(Oo.extractRotation(a.matrixWorld),vc.setFromRotationMatrix(Oo),this.quaternion.premultiply(vc.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(ga),xo.child=t,this.dispatchEvent(xo),xo.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Mc),za.child=t,this.dispatchEvent(za),za.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Oo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Oo.multiply(t.parent.matrixWorld)),t.applyMatrix4(Oo),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(ga),xo.child=t,this.dispatchEvent(xo),xo.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let s=0,a=this.children.length;s<a;s++){const m=this.children[s].getObjectByProperty(t,i);if(void 0!==m)return m}}getObjectsByProperty(t,i,s=[]){this[t]===i&&s.push(this);const a=this.children;for(let d=0,m=a.length;d<m;d++)a[d].getObjectsByProperty(t,i,s);return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fo,t,Am),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fo,Dm,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateMatrixWorld(t)}updateWorldMatrix(t,i){const s=this.parent;if(!0===t&&null!==s&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i){const a=this.children;for(let d=0,m=a.length;d<m;d++)a[d].updateWorldMatrix(!1,!0)}}toJSON(t){const i=void 0===t||"string"==typeof t,s={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const a={};function d(y,v){return void 0===y[v.uuid]&&(y[v.uuid]=v.toJSON(t)),v.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.geometryInfo=this._geometryInfo.map(y=>({...y,boundingBox:y.boundingBox?y.boundingBox.toJSON():void 0,boundingSphere:y.boundingSphere?y.boundingSphere.toJSON():void 0})),a.instanceInfo=this._instanceInfo.map(y=>({...y})),a.availableInstanceIds=this._availableInstanceIds.slice(),a.availableGeometryIds=this._availableGeometryIds.slice(),a.nextIndexStart=this._nextIndexStart,a.nextVertexStart=this._nextVertexStart,a.geometryCount=this._geometryCount,a.maxInstanceCount=this._maxInstanceCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.matricesTexture=this._matricesTexture.toJSON(t),a.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(a.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(a.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(a.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=d(t.geometries,this.geometry);const y=this.geometry.parameters;if(void 0!==y&&void 0!==y.shapes){const v=y.shapes;if(Array.isArray(v))for(let M=0,b=v.length;M<b;M++)d(t.shapes,v[M]);else d(t.shapes,v)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(d(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const y=[];for(let v=0,M=this.material.length;v<M;v++)y.push(d(t.materials,this.material[v]));a.material=y}else a.material=d(t.materials,this.material);if(this.children.length>0){a.children=[];for(let y=0;y<this.children.length;y++)a.children.push(this.children[y].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let y=0;y<this.animations.length;y++)a.animations.push(d(t.animations,this.animations[y]))}if(i){const y=m(t.geometries),v=m(t.materials),M=m(t.textures),b=m(t.images),E=m(t.shapes),C=m(t.skeletons),D=m(t.animations),O=m(t.nodes);y.length>0&&(s.geometries=y),v.length>0&&(s.materials=v),M.length>0&&(s.textures=M),b.length>0&&(s.images=b),E.length>0&&(s.shapes=E),C.length>0&&(s.skeletons=C),D.length>0&&(s.animations=D),O.length>0&&(s.nodes=O)}return s.object=a,s;function m(y){const v=[];for(const M in y){const b=y[M];delete b.metadata,v.push(b)}return v}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let s=0;s<t.children.length;s++)this.add(t.children[s].clone());return this}}return l.DEFAULT_UP=new K(0,1,0),l.DEFAULT_MATRIX_AUTO_UPDATE=!0,l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,l})();const Gs=new K,Rs=new K,sp=new K,_a=new K,yi=new K,bc=new K,Im=new K,Ad=new K,qh=new K,Dd=new K,Cu=new G,op=new G,Dl=new G;class to{constructor(e=new K,t=new K,i=new K){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),Gs.subVectors(e,t),s.cross(Gs);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,t,i,s,a){Gs.subVectors(s,t),Rs.subVectors(i,t),sp.subVectors(e,t);const d=Gs.dot(Gs),m=Gs.dot(Rs),y=Gs.dot(sp),v=Rs.dot(Rs),M=Rs.dot(sp),b=d*v-m*m;if(0===b)return a.set(0,0,0),null;const E=1/b,C=(v*y-m*M)*E,D=(d*M-m*y)*E;return a.set(1-C-D,D,C)}static containsPoint(e,t,i,s){return null!==this.getBarycoord(e,t,i,s,_a)&&_a.x>=0&&_a.y>=0&&_a.x+_a.y<=1}static getInterpolation(e,t,i,s,a,d,m,y){return null===this.getBarycoord(e,t,i,s,_a)?(y.x=0,y.y=0,"z"in y&&(y.z=0),"w"in y&&(y.w=0),null):(y.setScalar(0),y.addScaledVector(a,_a.x),y.addScaledVector(d,_a.y),y.addScaledVector(m,_a.z),y)}static getInterpolatedAttribute(e,t,i,s,a,d){return Cu.setScalar(0),op.setScalar(0),Dl.setScalar(0),Cu.fromBufferAttribute(e,t),op.fromBufferAttribute(e,i),Dl.fromBufferAttribute(e,s),d.setScalar(0),d.addScaledVector(Cu,a.x),d.addScaledVector(op,a.y),d.addScaledVector(Dl,a.z),d}static isFrontFacing(e,t,i,s){return Gs.subVectors(i,t),Rs.subVectors(e,t),Gs.cross(Rs).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Gs.subVectors(this.c,this.b),Rs.subVectors(this.a,this.b),.5*Gs.cross(Rs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return to.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return to.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,s,a){return to.getInterpolation(e,this.a,this.b,this.c,t,i,s,a)}containsPoint(e){return to.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return to.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,s=this.b,a=this.c;let d,m;yi.subVectors(s,i),bc.subVectors(a,i),Ad.subVectors(e,i);const y=yi.dot(Ad),v=bc.dot(Ad);if(y<=0&&v<=0)return t.copy(i);qh.subVectors(e,s);const M=yi.dot(qh),b=bc.dot(qh);if(M>=0&&b<=M)return t.copy(s);const E=y*b-M*v;if(E<=0&&y>=0&&M<=0)return d=y/(y-M),t.copy(i).addScaledVector(yi,d);Dd.subVectors(e,a);const C=yi.dot(Dd),D=bc.dot(Dd);if(D>=0&&C<=D)return t.copy(a);const O=C*v-y*D;if(O<=0&&v>=0&&D<=0)return m=v/(v-D),t.copy(i).addScaledVector(bc,m);const N=M*D-C*b;if(N<=0&&b-M>=0&&C-D>=0)return Im.subVectors(a,s),m=(b-M)/(b-M+(C-D)),t.copy(s).addScaledVector(Im,m);const A=1/(N+O+E);return d=O*A,m=E*A,t.copy(i).addScaledVector(yi,d).addScaledVector(bc,m)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Rm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ei={h:0,s:0,l:0},Il={h:0,s:0,l:0};function Ga(l,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?l+6*(e-l)*t:t<.5?e:t<2/3?l+6*(e-l)*(2/3-t):l}class Nt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const s=e;s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=gi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Kn.colorSpaceToWorking(this,t),this}setRGB(e,t,i,s=Kn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Kn.colorSpaceToWorking(this,s),this}setHSL(e,t,i,s=Kn.workingColorSpace){if(e=_d(e,1),t=Ct(t,0,1),i=Ct(i,0,1),0===t)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+t):i+t-i*t,d=2*i-a;this.r=Ga(d,a,e+1/3),this.g=Ga(d,a,e),this.b=Ga(d,a,e-1/3)}return Kn.colorSpaceToWorking(this,s),this}setStyle(e,t=gi){function i(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const m=s[2];switch(s[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(m))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],d=a.length;if(3===d)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===d)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=gi){const i=Rm[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ds(e.r),this.g=Ds(e.g),this.b=Ds(e.b),this}copyLinearToSRGB(e){return this.r=ha(e.r),this.g=ha(e.g),this.b=ha(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=gi){return Kn.workingToColorSpace(Mi.copy(this),e),65536*Math.round(Ct(255*Mi.r,0,255))+256*Math.round(Ct(255*Mi.g,0,255))+Math.round(Ct(255*Mi.b,0,255))}getHexString(e=gi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Kn.workingColorSpace){Kn.workingToColorSpace(Mi.copy(this),t);const i=Mi.r,s=Mi.g,a=Mi.b,d=Math.max(i,s,a),m=Math.min(i,s,a);let y,v;const M=(m+d)/2;if(m===d)y=0,v=0;else{const b=d-m;switch(v=M<=.5?b/(d+m):b/(2-d-m),d){case i:y=(s-a)/b+(s<a?6:0);break;case s:y=(a-i)/b+2;break;case a:y=(i-s)/b+4}y/=6}return e.h=y,e.s=v,e.l=M,e}getRGB(e,t=Kn.workingColorSpace){return Kn.workingToColorSpace(Mi.copy(this),t),e.r=Mi.r,e.g=Mi.g,e.b=Mi.b,e}getStyle(e=gi){Kn.workingToColorSpace(Mi.copy(this),e);const t=Mi.r,i=Mi.g,s=Mi.b;return e!==gi?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*s)})`}offsetHSL(e,t,i){return this.getHSL(Ei),this.setHSL(Ei.h+e,Ei.s+t,Ei.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ei),e.getHSL(Il);const i=yo(Ei.h,Il.h,t),s=yo(Ei.s,Il.s,t),a=yo(Ei.l,Il.l,t);return this.setHSL(i,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,s=this.b,a=e.elements;return this.r=a[0]*t+a[3]*i+a[6]*s,this.g=a[1]*t+a[4]*i+a[7]*s,this.b=a[2]*t+a[5]*i+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Mi=new Nt;Nt.NAMES=Rm;let Wa=0;class Ws extends _o{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Wa++}),this.uuid=Yt(),this.name="",this.type="Material",this.blending=Xt,this.side=pt,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=jn,this.blendDst=$t,this.blendEquation=wt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Nt(0,0,0),this.blendAlpha=0,this.depthFunc=Wt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=gl,this.stencilZFail=gl,this.stencilZPass=gl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];void 0!==s?s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function s(a){const d=[];for(const m in a){const y=a[m];delete y.metadata,d.push(y)}return d}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(i.dispersion=this.dispersion),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Xt&&(i.blending=this.blending),this.side!==pt&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),this.blendSrc!==jn&&(i.blendSrc=this.blendSrc),this.blendDst!==$t&&(i.blendDst=this.blendDst),this.blendEquation!==wt&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Wt&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==gl&&(i.stencilFail=this.stencilFail),this.stencilZFail!==gl&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==gl&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const a=s(e.textures),d=s(e.images);a.length>0&&(i.textures=a),d.length>0&&(i.images=d)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const s=t.length;i=new Array(s);for(let a=0;a!==s;++a)i[a]=t[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Mo extends Ws{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Lo,this.combine=Ui,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const li=new K,Sc=new Ce;let Ec=0;class Tr{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Ec++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRanges=[],this.gpuType=si,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Sc.fromBufferAttribute(this,t),Sc.applyMatrix3(e),this.setXY(t,Sc.x,Sc.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)li.fromBufferAttribute(this,t),li.applyMatrix3(e),this.setXYZ(t,li.x,li.y,li.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)li.fromBufferAttribute(this,t),li.applyMatrix4(e),this.setXYZ(t,li.x,li.y,li.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)li.fromBufferAttribute(this,t),li.applyNormalMatrix(e),this.setXYZ(t,li.x,li.y,li.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)li.fromBufferAttribute(this,t),li.transformDirection(e),this.setXYZ(t,li.x,li.y,li.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=$i(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Tn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=$i(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=$i(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=$i(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=$i(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),s=Tn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,a){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),s=Tn(s,this.array),a=Tn(a,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class Zh extends Tr{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Kh extends Tr{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Bt extends Tr{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Id=0;const $r=new yn,Rd=new Br,Uo=new K,Xs=new gn,wc=new gn,Qi=new K;class An extends _o{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Id++}),this.uuid=Yt(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Wh(e)?Kh:Zh)(e,1):e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const a=(new Rn).getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const s=this.attributes.tangent;return void 0!==s&&(s.transformDirection(e),s.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return $r.makeRotationFromQuaternion(e),this.applyMatrix4($r),this}rotateX(e){return $r.makeRotationX(e),this.applyMatrix4($r),this}rotateY(e){return $r.makeRotationY(e),this.applyMatrix4($r),this}rotateZ(e){return $r.makeRotationZ(e),this.applyMatrix4($r),this}translate(e,t,i){return $r.makeTranslation(e,t,i),this.applyMatrix4($r),this}scale(e,t,i){return $r.makeScale(e,t,i),this.applyMatrix4($r),this}lookAt(e){return Rd.lookAt(e),Rd.updateMatrix(),this.applyMatrix4(Rd.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Uo).negate(),this.translate(Uo.x,Uo.y,Uo.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const i=[];for(let s=0,a=e.length;s<a;s++){const d=e[s];i.push(d.x,d.y,d.z||0)}this.setAttribute("position",new Bt(i,3))}else{const i=Math.min(e.length,t.count);for(let s=0;s<i;s++){const a=e[s];t.setXYZ(s,a.x,a.y,a.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new gn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++)Xs.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Qi.addVectors(this.boundingBox.min,Xs.min),this.boundingBox.expandByPoint(Qi),Qi.addVectors(this.boundingBox.max,Xs.max),this.boundingBox.expandByPoint(Qi)):(this.boundingBox.expandByPoint(Xs.min),this.boundingBox.expandByPoint(Xs.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Wr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new K,1/0);if(e){const i=this.boundingSphere.center;if(Xs.setFromBufferAttribute(e),t)for(let a=0,d=t.length;a<d;a++)wc.setFromBufferAttribute(t[a]),this.morphTargetsRelative?(Qi.addVectors(Xs.min,wc.min),Xs.expandByPoint(Qi),Qi.addVectors(Xs.max,wc.max),Xs.expandByPoint(Qi)):(Xs.expandByPoint(wc.min),Xs.expandByPoint(wc.max));Xs.getCenter(i);let s=0;for(let a=0,d=e.count;a<d;a++)Qi.fromBufferAttribute(e,a),s=Math.max(s,i.distanceToSquared(Qi));if(t)for(let a=0,d=t.length;a<d;a++){const m=t[a],y=this.morphTargetsRelative;for(let v=0,M=m.count;v<M;v++)Qi.fromBufferAttribute(m,v),y&&(Uo.fromBufferAttribute(e,v),Qi.add(Uo)),s=Math.max(s,i.distanceToSquared(Qi))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,s=t.normal,a=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Tr(new Float32Array(4*i.count),4));const d=this.getAttribute("tangent"),m=[],y=[];for(let ne=0;ne<i.count;ne++)m[ne]=new K,y[ne]=new K;const v=new K,M=new K,b=new K,E=new Ce,C=new Ce,D=new Ce,O=new K,N=new K;function A(ne,X,j){v.fromBufferAttribute(i,ne),M.fromBufferAttribute(i,X),b.fromBufferAttribute(i,j),E.fromBufferAttribute(a,ne),C.fromBufferAttribute(a,X),D.fromBufferAttribute(a,j),M.sub(v),b.sub(v),C.sub(E),D.sub(E);const se=1/(C.x*D.y-D.x*C.y);isFinite(se)&&(O.copy(M).multiplyScalar(D.y).addScaledVector(b,-C.y).multiplyScalar(se),N.copy(b).multiplyScalar(C.x).addScaledVector(M,-D.x).multiplyScalar(se),m[ne].add(O),m[X].add(O),m[j].add(O),y[ne].add(N),y[X].add(N),y[j].add(N))}let H=this.groups;0===H.length&&(H=[{start:0,count:e.count}]);for(let ne=0,X=H.length;ne<X;++ne){const j=H[ne],se=j.start;for(let ve=se,we=se+j.count;ve<we;ve+=3)A(e.getX(ve+0),e.getX(ve+1),e.getX(ve+2))}const k=new K,V=new K,Z=new K,q=new K;function ee(ne){Z.fromBufferAttribute(s,ne),q.copy(Z);const X=m[ne];k.copy(X),k.sub(Z.multiplyScalar(Z.dot(X))).normalize(),V.crossVectors(q,X);const se=V.dot(y[ne])<0?-1:1;d.setXYZW(ne,k.x,k.y,k.z,se)}for(let ne=0,X=H.length;ne<X;++ne){const j=H[ne],se=j.start;for(let ve=se,we=se+j.count;ve<we;ve+=3)ee(e.getX(ve+0)),ee(e.getX(ve+1)),ee(e.getX(ve+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Tr(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let E=0,C=i.count;E<C;E++)i.setXYZ(E,0,0,0);const s=new K,a=new K,d=new K,m=new K,y=new K,v=new K,M=new K,b=new K;if(e)for(let E=0,C=e.count;E<C;E+=3){const D=e.getX(E+0),O=e.getX(E+1),N=e.getX(E+2);s.fromBufferAttribute(t,D),a.fromBufferAttribute(t,O),d.fromBufferAttribute(t,N),M.subVectors(d,a),b.subVectors(s,a),M.cross(b),m.fromBufferAttribute(i,D),y.fromBufferAttribute(i,O),v.fromBufferAttribute(i,N),m.add(M),y.add(M),v.add(M),i.setXYZ(D,m.x,m.y,m.z),i.setXYZ(O,y.x,y.y,y.z),i.setXYZ(N,v.x,v.y,v.z)}else for(let E=0,C=t.count;E<C;E+=3)s.fromBufferAttribute(t,E+0),a.fromBufferAttribute(t,E+1),d.fromBufferAttribute(t,E+2),M.subVectors(d,a),b.subVectors(s,a),M.cross(b),i.setXYZ(E+0,M.x,M.y,M.z),i.setXYZ(E+1,M.x,M.y,M.z),i.setXYZ(E+2,M.x,M.y,M.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Qi.fromBufferAttribute(e,t),Qi.normalize(),e.setXYZ(t,Qi.x,Qi.y,Qi.z)}toNonIndexed(){function e(m,y){const v=m.array,M=m.itemSize,b=m.normalized,E=new v.constructor(y.length*M);let C=0,D=0;for(let O=0,N=y.length;O<N;O++){C=m.isInterleavedBufferAttribute?y[O]*m.data.stride+m.offset:y[O]*M;for(let A=0;A<M;A++)E[D++]=v[C++]}return new Tr(E,M,b)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new An,i=this.index.array,s=this.attributes;for(const m in s){const v=e(s[m],i);t.setAttribute(m,v)}const a=this.morphAttributes;for(const m in a){const y=[],v=a[m];for(let M=0,b=v.length;M<b;M++){const C=e(v[M],i);y.push(C)}t.morphAttributes[m]=y}t.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let m=0,y=d.length;m<y;m++){const v=d[m];t.addGroup(v.start,v.count,v.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const y=this.parameters;for(const v in y)void 0!==y[v]&&(e[v]=y[v]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const y in i)e.data.attributes[y]=i[y].toJSON(e.data);const s={};let a=!1;for(const y in this.morphAttributes){const v=this.morphAttributes[y],M=[];for(let b=0,E=v.length;b<E;b++)M.push(v[b].toJSON(e.data));M.length>0&&(s[y]=M,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const m=this.boundingSphere;return null!==m&&(e.data.boundingSphere=m.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone());const s=e.attributes;for(const v in s)this.setAttribute(v,s[v].clone(t));const a=e.morphAttributes;for(const v in a){const M=[],b=a[v];for(let E=0,C=b.length;E<C;E++)M.push(b[E].clone(t));this.morphAttributes[v]=M}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let v=0,M=d.length;v<M;v++){const b=d[v];this.addGroup(b.start,b.count,b.materialIndex)}const m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());const y=e.boundingSphere;return null!==y&&(this.boundingSphere=y.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Pd=new yn,ya=new rs,Au=new Wr,no=new K,Bo=new K,Nd=new K,Ld=new K,Rl=new K,Pl=new K,ap=new K,Du=new K;class kr extends Br{constructor(e=new An,t=new Mo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,d=s.length;a<d;a++){const m=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=a}}}}getVertexPosition(e,t){const i=this.geometry,a=i.morphAttributes.position,d=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const m=this.morphTargetInfluences;if(a&&m){Pl.set(0,0,0);for(let y=0,v=a.length;y<v;y++){const M=m[y];0!==M&&(Rl.fromBufferAttribute(a[y],e),Pl.addScaledVector(d?Rl:Rl.sub(t),M))}t.add(Pl)}return t}raycast(e,t){const i=this.geometry,a=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),Au.copy(i.boundingSphere),Au.applyMatrix4(a),ya.copy(e.ray).recast(e.near),(!1!==Au.containsPoint(ya.origin)||!(null===ya.intersectSphere(Au,no)||ya.origin.distanceToSquared(no)>(e.far-e.near)**2))&&(Pd.copy(a).invert(),ya.copy(e.ray).applyMatrix4(Pd),(null===i.boundingBox||!1!==ya.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,ya)))}_computeIntersections(e,t,i){let s;const a=this.geometry,d=this.material,m=a.index,y=a.attributes.position,v=a.attributes.uv,M=a.attributes.uv1,b=a.attributes.normal,E=a.groups,C=a.drawRange;if(null!==m)if(Array.isArray(d))for(let D=0,O=E.length;D<O;D++){const N=E[D],A=d[N.materialIndex];for(let V=Math.max(N.start,C.start),Z=Math.min(m.count,Math.min(N.start+N.count,C.start+C.count));V<Z;V+=3)s=Nl(this,A,e,i,v,M,b,m.getX(V),m.getX(V+1),m.getX(V+2)),s&&(s.faceIndex=Math.floor(V/3),s.face.materialIndex=N.materialIndex,t.push(s))}else for(let N=Math.max(0,C.start),A=Math.min(m.count,C.start+C.count);N<A;N+=3)s=Nl(this,d,e,i,v,M,b,m.getX(N),m.getX(N+1),m.getX(N+2)),s&&(s.faceIndex=Math.floor(N/3),t.push(s));else if(void 0!==y)if(Array.isArray(d))for(let D=0,O=E.length;D<O;D++){const N=E[D],A=d[N.materialIndex];for(let V=Math.max(N.start,C.start),Z=Math.min(y.count,Math.min(N.start+N.count,C.start+C.count));V<Z;V+=3)s=Nl(this,A,e,i,v,M,b,V,V+1,V+2),s&&(s.faceIndex=Math.floor(V/3),s.face.materialIndex=N.materialIndex,t.push(s))}else for(let N=Math.max(0,C.start),A=Math.min(y.count,C.start+C.count);N<A;N+=3)s=Nl(this,d,e,i,v,M,b,N,N+1,N+2),s&&(s.faceIndex=Math.floor(N/3),t.push(s))}}function Nl(l,e,t,i,s,a,d,m,y,v){l.getVertexPosition(m,Bo),l.getVertexPosition(y,Nd),l.getVertexPosition(v,Ld);const M=function Nm(l,e,t,i,s,a,d,m){let y;if(y=e.side===fn?i.intersectTriangle(d,a,s,!0,m):i.intersectTriangle(s,a,d,e.side===pt,m),null===y)return null;Du.copy(m),Du.applyMatrix4(l.matrixWorld);const v=t.ray.origin.distanceTo(Du);return v<t.near||v>t.far?null:{distance:v,point:Du.clone(),object:l}}(l,e,t,i,Bo,Nd,Ld,ap);if(M){const b=new K;to.getBarycoord(ap,Bo,Nd,Ld,b),s&&(M.uv=to.getInterpolatedAttribute(s,m,y,v,b,new Ce)),a&&(M.uv1=to.getInterpolatedAttribute(a,m,y,v,b,new Ce)),d&&(M.normal=to.getInterpolatedAttribute(d,m,y,v,b,new K),M.normal.dot(i.direction)>0&&M.normal.multiplyScalar(-1));const E={a:m,b:y,c:v,normal:new K,materialIndex:0};to.getNormal(Bo,Nd,Ld,E.normal),M.face=E,M.barycoord=b}return M}class Ll extends An{constructor(e=1,t=1,i=1,s=1,a=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:a,depthSegments:d};const m=this;s=Math.floor(s),a=Math.floor(a),d=Math.floor(d);const y=[],v=[],M=[],b=[];let E=0,C=0;function D(O,N,A,H,k,V,Z,q,ee,ne,X){const j=V/ee,se=Z/ne,me=V/2,ve=Z/2,we=q/2,Ne=ee+1,De=ne+1;let it=0,Ie=0;const At=new K;for(let zt=0;zt<De;zt++){const qt=zt*se-ve;for(let Vn=0;Vn<Ne;Vn++)At[O]=(Vn*j-me)*H,At[N]=qt*k,At[A]=we,v.push(At.x,At.y,At.z),At[O]=0,At[N]=0,At[A]=q>0?1:-1,M.push(At.x,At.y,At.z),b.push(Vn/ee),b.push(1-zt/ne),it+=1}for(let zt=0;zt<ne;zt++)for(let qt=0;qt<ee;qt++){const ui=E+qt+Ne*(zt+1),Ti=E+(qt+1)+Ne*(zt+1),di=E+(qt+1)+Ne*zt;y.push(E+qt+Ne*zt,ui,di),y.push(ui,Ti,di),Ie+=6}m.addGroup(C,Ie,X),C+=Ie,E+=it}D("z","y","x",-1,-1,i,t,e,d,a,0),D("z","y","x",1,-1,i,t,-e,d,a,1),D("x","z","y",1,1,e,i,t,s,d,2),D("x","z","y",1,-1,e,i,-t,s,d,3),D("x","y","z",1,-1,e,t,i,s,a,4),D("x","y","z",-1,-1,e,t,-i,s,a,5),this.setIndex(y),this.setAttribute("position",new Bt(v,3)),this.setAttribute("normal",new Bt(M,3)),this.setAttribute("uv",new Bt(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ll(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Cc(l){const e={};for(const t in l){e[t]={};for(const i in l[t]){const s=l[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():e[t][i]=Array.isArray(s)?s.slice():s}}return e}function Ar(l){const e={};for(let t=0;t<l.length;t++){const i=Cc(l[t]);for(const s in i)e[s]=i[s]}return e}function Qh(l){const e=l.getRenderTarget();return null===e?l.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:Kn.workingColorSpace}const Od={clone:Cc,merge:Ar};class io extends Ws{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Cc(e.uniforms),this.uniformsGroups=function E_(l){const e=[];for(let t=0;t<l.length;t++)e.push(l[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const d=this.uniforms[s].value;t.uniforms[s]=d&&d.isTexture?{type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?{type:"c",value:d.getHex()}:d&&d.isVector2?{type:"v2",value:d.toArray()}:d&&d.isVector3?{type:"v3",value:d.toArray()}:d&&d.isVector4?{type:"v4",value:d.toArray()}:d&&d.isMatrix3?{type:"m3",value:d.toArray()}:d&&d.isMatrix4?{type:"m4",value:d.toArray()}:{value:d}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const s in this.extensions)!0===this.extensions[s]&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class lp extends Br{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new yn,this.projectionMatrix=new yn,this.projectionMatrixInverse=new yn,this.coordinateSystem=ts,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Dr=new K,Fd=new Ce,ef=new Ce;class ss extends lp{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Vs*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ro*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Vs*Math.atan(Math.tan(.5*Ro*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Dr.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Dr.x,Dr.y).multiplyScalar(-e/Dr.z),Dr.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Dr.x,Dr.y).multiplyScalar(-e/Dr.z)}getViewSize(e,t){return this.getViewBounds(e,Fd,ef),t.subVectors(ef,Fd)}setViewOffset(e,t,i,s,a,d){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=a,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ro*this.fov)/this.zoom,i=2*t,s=this.aspect*i,a=-.5*s;const d=this.view;if(null!==this.view&&this.view.enabled){const y=d.fullWidth,v=d.fullHeight;a+=d.offsetX*s/y,t-=d.offsetY*i/v,s*=d.width/y,i*=d.height/v}const m=this.filmOffset;0!==m&&(a+=e*m/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Jv extends Br{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new ss(-90,1,e,t);s.layers=this.layers,this.add(s);const a=new ss(-90,1,e,t);a.layers=this.layers,this.add(a);const d=new ss(-90,1,e,t);d.layers=this.layers,this.add(d);const m=new ss(-90,1,e,t);m.layers=this.layers,this.add(m);const y=new ss(-90,1,e,t);y.layers=this.layers,this.add(y);const v=new ss(-90,1,e,t);v.layers=this.layers,this.add(v)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,s,a,d,m,y]=t;for(const v of t)this.remove(v);if(e===ts)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),m.up.set(0,1,0),m.lookAt(0,0,1),y.up.set(0,1,0),y.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),m.up.set(0,-1,0),m.lookAt(0,0,1),y.up.set(0,-1,0),y.lookAt(0,0,-1)}for(const v of t)this.add(v),v.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,d,m,y,v,M]=this.children,b=e.getRenderTarget(),E=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),D=e.xr.enabled;e.xr.enabled=!1;const O=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(t,a),e.setRenderTarget(i,1,s),e.render(t,d),e.setRenderTarget(i,2,s),e.render(t,m),e.setRenderTarget(i,3,s),e.render(t,y),e.setRenderTarget(i,4,s),e.render(t,v),i.texture.generateMipmaps=O,e.setRenderTarget(i,5,s),e.render(t,M),e.setRenderTarget(b,E,C),e.xr.enabled=D,i.texture.needsPMREMUpdate=!0}}class tf extends P{constructor(e=[],t=Xe,i,s,a,d,m,y,v,M){super(e,t,i,s,a,d,m,y,v,M),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class cp extends _e{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new tf([i,i,i,i,i,i]),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Ll(5,5,5),a=new io({name:"CubemapFromEquirect",uniforms:Cc(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:fn,blending:Qt});a.uniforms.tEquirect.value=t;const d=new kr(s,a),m=t.minFilter;return t.minFilter===oe&&(t.minFilter=dr),new Jv(1,10,this).update(e,d),t.minFilter=m,d.geometry.dispose(),d.material.dispose(),this}clear(e,t=!0,i=!0,s=!0){const a=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(t,i,s);e.setRenderTarget(a)}}class ko extends Br{constructor(){super(),this.isGroup=!0,this.type="Group"}}const nf={type:"move"};class os{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ko,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ko,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ko,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let s=null,a=null,d=null;const m=this._targetRay,y=this._grip,v=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(v&&e.hand){d=!0;for(const O of e.hand.values()){const N=t.getJointPose(O,i),A=this._getHandJoint(v,O);null!==N&&(A.matrix.fromArray(N.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=N.radius),A.visible=null!==N}const E=v.joints["index-finger-tip"].position.distanceTo(v.joints["thumb-tip"].position),C=.02,D=.005;v.inputState.pinching&&E>C+D?(v.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!v.inputState.pinching&&E<=C-D&&(v.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==y&&e.gripSpace&&(a=t.getPose(e.gripSpace,i),null!==a&&(y.matrix.fromArray(a.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,a.linearVelocity?(y.hasLinearVelocity=!0,y.linearVelocity.copy(a.linearVelocity)):y.hasLinearVelocity=!1,a.angularVelocity?(y.hasAngularVelocity=!0,y.angularVelocity.copy(a.angularVelocity)):y.hasAngularVelocity=!1));null!==m&&(s=t.getPose(e.targetRaySpace,i),null===s&&null!==a&&(s=a),null!==s&&(m.matrix.fromArray(s.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,s.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(s.linearVelocity)):m.hasLinearVelocity=!1,s.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(s.angularVelocity)):m.hasAngularVelocity=!1,this.dispatchEvent(nf)))}return null!==m&&(m.visible=null!==s),null!==y&&(y.visible=null!==a),null!==v&&(v.visible=null!==d),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new ko;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class Ru{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Nt(e),this.density=t}clone(){return new Ru(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fm extends Br{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Lo,this.environmentIntensity=1,this.environmentRotation=new Lo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Ud{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRanges=[],this.version=0,this.uuid=Yt()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let s=0,a=this.stride;s<a;s++)this.array[e+s]=t.array[i+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Yt()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Yt()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const er=new K;class xs{constructor(e,t,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)er.fromBufferAttribute(this,t),er.applyMatrix4(e),this.setXYZ(t,er.x,er.y,er.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)er.fromBufferAttribute(this,t),er.applyNormalMatrix(e),this.setXYZ(t,er.x,er.y,er.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)er.fromBufferAttribute(this,t),er.transformDirection(e),this.setXYZ(t,er.x,er.y,er.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=$i(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Tn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=$i(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=$i(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=$i(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=$i(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),s=Tn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,t,i,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),s=Tn(s,this.array),a=Tn(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=a,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[s+a])}return new Tr(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xs(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[s+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Fu=new K,Vr=new K,va=new Rn;class Vo{constructor(e=new K(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const s=Fu.subVectors(i,t).cross(Vr.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Fu),s=this.normal.dot(i);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:t.copy(e.start).addScaledVector(i,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||va.getNormalMatrix(e),s=this.coplanarPoint(Fu).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Fc=new Wr,gp=new Ce(.5,.5),Uc=new K;class kl{constructor(e=new Vo,t=new Vo,i=new Vo,s=new Vo,a=new Vo,d=new Vo){this.planes=[e,t,i,s,a,d]}set(e,t,i,s,a,d){const m=this.planes;return m[0].copy(e),m[1].copy(t),m[2].copy(i),m[3].copy(s),m[4].copy(a),m[5].copy(d),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ts,i=!1){const s=this.planes,a=e.elements,d=a[0],m=a[1],y=a[2],v=a[3],M=a[4],b=a[5],E=a[6],C=a[7],D=a[8],O=a[9],N=a[10],A=a[11],H=a[12],k=a[13],V=a[14],Z=a[15];if(s[0].setComponents(v-d,C-M,A-D,Z-H).normalize(),s[1].setComponents(v+d,C+M,A+D,Z+H).normalize(),s[2].setComponents(v+m,C+b,A+O,Z+k).normalize(),s[3].setComponents(v-m,C-b,A-O,Z-k).normalize(),i)s[4].setComponents(y,E,N,V).normalize(),s[5].setComponents(v-y,C-E,A-N,Z-V).normalize();else if(s[4].setComponents(v-y,C-E,A-N,Z-V).normalize(),t===ts)s[5].setComponents(v+y,C+E,A+N,Z+V).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);s[5].setComponents(y,E,N,V).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Fc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Fc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Fc)}intersectsSprite(e){Fc.center.set(0,0,0);const t=gp.distanceTo(e.center);return Fc.radius=.7071067811865476+t,Fc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fc)}intersectsSphere(e){const t=this.planes,i=e.center,s=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const s=t[i];if(Uc.x=s.normal.x>0?e.max.x:e.min.x,Uc.y=s.normal.y>0?e.max.y:e.min.y,Uc.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Uc)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class Ss extends Ws{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Nt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ku=new K,Rr=new K,zo=new yn,Ma=new rs,Vu=new Wr,Hl=new K,vp=new K;class Hu extends Br{constructor(e=new An,t=new Ss){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let s=1,a=t.count;s<a;s++)ku.fromBufferAttribute(t,s-1),Rr.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=ku.distanceTo(Rr);e.setAttribute("lineDistance",new Bt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,a=e.params.Line.threshold,d=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Vu.copy(i.boundingSphere),Vu.applyMatrix4(s),Vu.radius+=a,!1===e.ray.intersectsSphere(Vu))return;zo.copy(s).invert(),Ma.copy(e.ray).applyMatrix4(zo);const m=a/((this.scale.x+this.scale.y+this.scale.z)/3),y=m*m,v=this.isLineSegments?2:1,M=i.index,E=i.attributes.position;if(null!==M){const C=Math.max(0,d.start),D=Math.min(M.count,d.start+d.count);for(let O=C,N=D-1;O<N;O+=v){const A=M.getX(O),H=M.getX(O+1),k=zu(this,e,Ma,y,A,H,O);k&&t.push(k)}if(this.isLineLoop){const O=M.getX(D-1),N=M.getX(C),A=zu(this,e,Ma,y,O,N,D-1);A&&t.push(A)}}else{const C=Math.max(0,d.start),D=Math.min(E.count,d.start+d.count);for(let O=C,N=D-1;O<N;O+=v){const A=zu(this,e,Ma,y,O,O+1,O);A&&t.push(A)}if(this.isLineLoop){const O=zu(this,e,Ma,y,D-1,C,D-1);O&&t.push(O)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,d=s.length;a<d;a++){const m=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=a}}}}}function zu(l,e,t,i,s,a,d){const m=l.geometry.attributes.position;if(ku.fromBufferAttribute(m,s),Rr.fromBufferAttribute(m,a),t.distanceSqToSegment(ku,Rr,Hl,vp)>i)return;Hl.applyMatrix4(l.matrixWorld);const v=e.ray.origin.distanceTo(Hl);return v<e.near||v>e.far?void 0:{distance:v,point:vp.clone().applyMatrix4(l.matrixWorld),index:d,face:null,faceIndex:null,barycoord:null,object:l}}const Gu=new K,Xd=new K;class Wu extends Hu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let s=0,a=t.count;s<a;s+=2)Gu.fromBufferAttribute(t,s),Xd.fromBufferAttribute(t,s+1),i[s]=0===s?0:i[s-1],i[s+1]=i[s]+Gu.distanceTo(Xd);e.setAttribute("lineDistance",new Bt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class zl extends Ws{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const hf=new yn,ff=new rs,Yd=new Wr,qd=new K;class Zd extends Br{constructor(e=new An,t=new zl){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,a=e.params.Points.threshold,d=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Yd.copy(i.boundingSphere),Yd.applyMatrix4(s),Yd.radius+=a,!1===e.ray.intersectsSphere(Yd))return;hf.copy(s).invert(),ff.copy(e.ray).applyMatrix4(hf);const m=a/((this.scale.x+this.scale.y+this.scale.z)/3),y=m*m,v=i.index,b=i.attributes.position;if(null!==v)for(let D=Math.max(0,d.start),O=Math.min(v.count,d.start+d.count);D<O;D++){const N=v.getX(D);qd.fromBufferAttribute(b,N),Hm(qd,N,y,s,e,t,this)}else for(let D=Math.max(0,d.start),O=Math.min(b.count,d.start+d.count);D<O;D++)qd.fromBufferAttribute(b,D),Hm(qd,D,y,s,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(void 0!==s){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,d=s.length;a<d;a++){const m=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=a}}}}}function Hm(l,e,t,i,s,a,d){const m=ff.distanceSqToPoint(l);if(m<t){const y=new K;ff.closestPointToPoint(l,y),y.applyMatrix4(i);const v=s.ray.origin.distanceTo(y);if(v<s.near||v>s.far)return;a.push({distance:v,distanceToRay:Math.sqrt(m),point:y,index:e,face:null,faceIndex:null,barycoord:null,object:d})}}class Jd extends P{constructor(e,t,i=Cn,s,a,d,m=qn,y=qn,v,M=Us,b=1){if(M!==Us&&M!==fo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:b},s,a,d,m,y,M,i,v),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new _i(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class Hc extends P{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}const $u=new K,ju=new K,Wc=new K,Ps=new to;class Xu extends An{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const s=Math.pow(10,4),a=Math.cos(Ro*t),d=e.getIndex(),m=e.getAttribute("position"),y=d?d.count:m.count,v=[0,0,0],M=["a","b","c"],b=new Array(3),E={},C=[];for(let D=0;D<y;D+=3){d?(v[0]=d.getX(D),v[1]=d.getX(D+1),v[2]=d.getX(D+2)):(v[0]=D,v[1]=D+1,v[2]=D+2);const{a:O,b:N,c:A}=Ps;if(O.fromBufferAttribute(m,v[0]),N.fromBufferAttribute(m,v[1]),A.fromBufferAttribute(m,v[2]),Ps.getNormal(Wc),b[0]=`${Math.round(O.x*s)},${Math.round(O.y*s)},${Math.round(O.z*s)}`,b[1]=`${Math.round(N.x*s)},${Math.round(N.y*s)},${Math.round(N.z*s)}`,b[2]=`${Math.round(A.x*s)},${Math.round(A.y*s)},${Math.round(A.z*s)}`,b[0]!==b[1]&&b[1]!==b[2]&&b[2]!==b[0])for(let H=0;H<3;H++){const k=(H+1)%3,V=b[H],Z=b[k],q=Ps[M[H]],ee=Ps[M[k]],ne=`${V}_${Z}`,X=`${Z}_${V}`;X in E&&E[X]?(Wc.dot(E[X].normal)<=a&&(C.push(q.x,q.y,q.z),C.push(ee.x,ee.y,ee.z)),E[X]=null):ne in E||(E[ne]={index0:v[H],index1:v[k],normal:Wc.clone()})}}for(const D in E)if(E[D]){const{index0:O,index1:N}=E[D];$u.fromBufferAttribute(m,O),ju.fromBufferAttribute(m,N),C.push($u.x,$u.y,$u.z),C.push(ju.x,ju.y,ju.z)}this.setAttribute("position",new Bt(C,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Qu extends An{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};const a=e/2,d=t/2,m=Math.floor(i),y=Math.floor(s),v=m+1,M=y+1,b=e/m,E=t/y,C=[],D=[],O=[],N=[];for(let A=0;A<M;A++){const H=A*E-d;for(let k=0;k<v;k++)D.push(k*b-a,-H,0),O.push(0,0,1),N.push(k/m),N.push(1-A/y)}for(let A=0;A<y;A++)for(let H=0;H<m;H++){const V=H+v*(A+1),Z=H+1+v*(A+1),q=H+1+v*A;C.push(H+v*A,V,q),C.push(V,Z,q)}this.setIndex(C),this.setAttribute("position",new Bt(D,3)),this.setAttribute("normal",new Bt(O,3)),this.setAttribute("uv",new Bt(N,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qu(e.width,e.height,e.widthSegments,e.heightSegments)}}class Jc extends An{constructor(e=1,t=32,i=16,s=0,a=2*Math.PI,d=0,m=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:s,phiLength:a,thetaStart:d,thetaLength:m},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const y=Math.min(d+m,Math.PI);let v=0;const M=[],b=new K,E=new K,C=[],D=[],O=[],N=[];for(let A=0;A<=i;A++){const H=[],k=A/i;let V=0;0===A&&0===d?V=.5/t:A===i&&y===Math.PI&&(V=-.5/t);for(let Z=0;Z<=t;Z++){const q=Z/t;b.x=-e*Math.cos(s+q*a)*Math.sin(d+k*m),b.y=e*Math.cos(d+k*m),b.z=e*Math.sin(s+q*a)*Math.sin(d+k*m),D.push(b.x,b.y,b.z),E.copy(b).normalize(),O.push(E.x,E.y,E.z),N.push(q+V,1-k),H.push(v++)}M.push(H)}for(let A=0;A<i;A++)for(let H=0;H<t;H++){const V=M[A][H],Z=M[A+1][H],q=M[A+1][H+1];(0!==A||d>0)&&C.push(M[A][H+1],V,q),(A!==i-1||y<Math.PI)&&C.push(V,Z,q)}this.setIndex(C),this.setAttribute("position",new Bt(D,3)),this.setAttribute("normal",new Bt(O,3)),this.setAttribute("uv",new Bt(N,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class el extends An{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],i=new Set,s=new K,a=new K;if(null!==e.index){const d=e.attributes.position,m=e.index;let y=e.groups;0===y.length&&(y=[{start:0,count:m.count,materialIndex:0}]);for(let v=0,M=y.length;v<M;++v){const b=y[v],E=b.start;for(let D=E,O=E+b.count;D<O;D+=3)for(let N=0;N<3;N++){const A=m.getX(D+N),H=m.getX(D+(N+1)%3);s.fromBufferAttribute(d,A),a.fromBufferAttribute(d,H),!0===ah(s,a,i)&&(t.push(s.x,s.y,s.z),t.push(a.x,a.y,a.z))}}}else{const d=e.attributes.position;for(let m=0,y=d.count/3;m<y;m++)for(let v=0;v<3;v++){const b=3*m+(v+1)%3;s.fromBufferAttribute(d,3*m+v),a.fromBufferAttribute(d,b),!0===ah(s,a,i)&&(t.push(s.x,s.y,s.z),t.push(a.x,a.y,a.z))}}this.setAttribute("position",new Bt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function ah(l,e,t){const i=`${l.x},${l.y},${l.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${l.x},${l.y},${l.z}`;return!0!==t.has(i)&&!0!==t.has(s)&&(t.add(i),t.add(s),!0)}class Qc extends Ws{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Nt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ts,this.normalScale=new Ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Lo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Np extends Ws{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Rf extends Ws{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Zl(l,e){return l&&l.constructor!==e?"number"==typeof e.BYTES_PER_ELEMENT?new e(l):Array.prototype.slice.call(l):l}class Lf{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,s=t[i],a=t[i-1];e:{t:{let d;n:{i:if(!(e<s)){for(let m=i+2;;){if(void 0===s){if(e<a)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===m)break;if(a=s,s=t[++i],e<s)break t}d=t.length;break n}if(e>=a)break e;{const m=t[1];e<m&&(i=2,a=m);for(let y=i-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(i===y)break;if(s=a,a=t[--i-1],e>=a)break t}d=i,i=0}}for(;i<d;){const m=i+d>>>1;e<t[m]?d=m:i=m+1}if(s=t[i],a=t[i-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===s)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,a,s)}return this.interpolate_(i,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=e*s;for(let d=0;d!==s;++d)t[d]=i[a+d];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class og extends Lf{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const s=this.parameterPositions;let a=e-2,d=e+1,m=s[a],y=s[d];if(void 0===m)switch(this.getSettings_().endingStart){case 2401:a=e,m=2*t-i;break;case 2402:a=s.length-2,m=t+s[a]-s[a+1];break;default:a=e,m=i}if(void 0===y)switch(this.getSettings_().endingEnd){case 2401:d=e,y=2*i-t;break;case 2402:d=1,y=i+s[1]-s[0];break;default:d=e-1,y=t}const v=.5*(i-t),M=this.valueSize;this._weightPrev=v/(t-m),this._weightNext=v/(y-i),this._offsetPrev=a*M,this._offsetNext=d*M}interpolate_(e,t,i,s){const a=this.resultBuffer,d=this.sampleValues,m=this.valueSize,y=e*m,v=y-m,M=this._offsetPrev,b=this._offsetNext,E=this._weightPrev,C=this._weightNext,D=(i-t)/(s-t),O=D*D,N=O*D,A=-E*N+2*E*O-E*D,H=(1+E)*N+(-1.5-2*E)*O+(-.5+E)*D+1,k=(-1-C)*N+(1.5+C)*O+.5*D,V=C*N-C*O;for(let Z=0;Z!==m;++Z)a[Z]=A*d[M+Z]+H*d[v+Z]+k*d[y+Z]+V*d[b+Z];return a}}class ag extends Lf{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const a=this.resultBuffer,d=this.sampleValues,m=this.valueSize,y=e*m,v=y-m,M=(i-t)/(s-t),b=1-M;for(let E=0;E!==m;++E)a[E]=d[v+E]*b+d[y+E]*M;return a}}class N_ extends Lf{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class mr{constructor(e,t,i,s){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Zl(t,this.TimeBufferType),this.values=Zl(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Zl(e.times,Array),values:Zl(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new N_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ag(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new og(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){const i=this.times,s=i.length;let a=0,d=s-1;for(;a!==s&&i[a]<e;)++a;for(;-1!==d&&i[d]>t;)--d;if(++d,0!==a||d!==s){a>=d&&(d=Math.max(d,1),a=d-1);const m=this.getValueSize();this.times=i.slice(a,d),this.values=this.values.slice(a*m,d*m)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,a=i.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let m=0;m!==a;m++){const y=i[m];if("number"==typeof y&&isNaN(y)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,m,y),e=!1;break}if(null!==d&&d>y){console.error("THREE.KeyframeTrack: Out of order keys.",this,m,y,d),e=!1;break}d=y}if(void 0!==s&&function Pf(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}(s))for(let m=0,y=s.length;m!==y;++m){const v=s[m];if(isNaN(v)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,m,v),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),s=2302===this.getInterpolation(),a=e.length-1;let d=1;for(let m=1;m<a;++m){let y=!1;const v=e[m];if(v!==e[m+1]&&(1!==m||v!==e[0]))if(s)y=!0;else{const b=m*i,E=b-i,C=b+i;for(let D=0;D!==i;++D){const O=t[b+D];if(O!==t[E+D]||O!==t[C+D]){y=!0;break}}}if(y){if(m!==d){e[d]=e[m];const b=m*i,E=d*i;for(let C=0;C!==i;++C)t[E+C]=t[b+C]}++d}}if(a>0){e[d]=e[a];for(let m=a*i,y=d*i,v=0;v!==i;++v)t[y+v]=t[m+v];++d}return d!==e.length?(this.times=e.slice(0,d),this.values=t.slice(0,d*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),s=new(0,this.constructor)(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}mr.prototype.ValueTypeName="",mr.prototype.TimeBufferType=Float32Array,mr.prototype.ValueBufferType=Float32Array,mr.prototype.DefaultInterpolation=2301;class id extends mr{constructor(e,t,i){super(e,t,i)}}id.prototype.ValueTypeName="bool",id.prototype.ValueBufferType=Array,id.prototype.DefaultInterpolation=2300,id.prototype.InterpolantFactoryMethodLinear=void 0,id.prototype.InterpolantFactoryMethodSmooth=void 0;(class Op extends mr{constructor(e,t,i,s){super(e,t,i,s)}}).prototype.ValueTypeName="color";(class ch extends mr{constructor(e,t,i,s){super(e,t,i,s)}}).prototype.ValueTypeName="number";class lg extends Lf{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const a=this.resultBuffer,d=this.sampleValues,m=this.valueSize,y=(i-t)/(s-t);let v=e*m;for(let M=v+m;v!==M;v+=4)wr.slerpFlat(a,0,d,v-m,d,v,y);return a}}class uh extends mr{constructor(e,t,i,s){super(e,t,i,s)}InterpolantFactoryMethodLinear(e){return new lg(this.times,this.values,this.getValueSize(),e)}}uh.prototype.ValueTypeName="quaternion",uh.prototype.InterpolantFactoryMethodSmooth=void 0;class tu extends mr{constructor(e,t,i){super(e,t,i)}}tu.prototype.ValueTypeName="string",tu.prototype.ValueBufferType=Array,tu.prototype.DefaultInterpolation=2300,tu.prototype.InterpolantFactoryMethodLinear=void 0,tu.prototype.InterpolantFactoryMethodSmooth=void 0;(class rd extends mr{constructor(e,t,i,s){super(e,t,i,s)}}).prototype.ValueTypeName="vector";class ie extends Error{constructor(e,t){super(e),this.response=t}}class Hr extends Br{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Nt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}const Jl=new yn,hh=new K,O_=new K;class RM{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ce(512,512),this.mapType=We,this.map=null,this.mapPass=null,this.matrix=new yn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new kl,this._frameExtents=new Ce(1,1),this._viewportCount=1,this._viewports=[new G(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;hh.setFromMatrixPosition(e.matrixWorld),t.position.copy(hh),O_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(O_),t.updateMatrixWorld(),Jl.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Jl,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Jl)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const F_=new yn,fh=new K,U_=new K;class Qv extends RM{constructor(){super(new ss(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ce(4,2),this._viewportCount=6,this._viewports=[new G(2,1,1,1),new G(0,1,1,1),new G(3,1,1,1),new G(1,1,1,1),new G(3,0,1,1),new G(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,s=this.matrix,a=e.distance||i.far;a!==i.far&&(i.far=a,i.updateProjectionMatrix()),fh.setFromMatrixPosition(e.matrixWorld),i.position.copy(fh),U_.copy(i.position),U_.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(U_),i.updateMatrixWorld(),s.makeTranslation(-fh.x,-fh.y,-fh.z),F_.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(F_,i.coordinateSystem,i.reversedDepth)}}class sd extends Hr{constructor(e,t,i=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new Qv}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class cg extends lp{constructor(e=-1,t=1,i=1,s=-1,a=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=a,this.far=d,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,a,d){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=a,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=i-e,d=i+e,m=s+t,y=s-t;if(null!==this.view&&this.view.enabled){const v=(this.right-this.left)/this.view.fullWidth/this.zoom,M=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=v*this.view.offsetX,d=a+v*this.view.width,m-=M*this.view.offsetY,y=m-M*this.view.height}this.projectionMatrix.makeOrthographic(a,d,m,y,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class k_ extends Hr{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class z_ extends An{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class r0 extends ss{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const fg="\\[\\]\\.:\\/",K_=new RegExp("["+fg+"]","g"),Hp="[^"+fg+"]",o0="[^"+fg.replace("\\.","")+"]",BM=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Hp)+/(WCOD+)?/.source.replace("WCOD",o0)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hp)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hp)+"$"),pg=["material","materials","bones","map"];class J_{constructor(e,t,i){const s=i||Xi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const s=this._bindings[this._targetGroup.nCachedObjects_];void 0!==s&&s.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=i.length;s!==a;++s)i[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Xi=(()=>{class l{constructor(t,i,s){this.path=i,this.parsedPath=s||l.parseTrackName(i),this.node=l.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,s){return t&&t.isAnimationObjectGroup?new l.Composite(t,i,s):new l(t,i,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(K_,"")}static parseTrackName(t){const i=BM.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const s={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},a=s.nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==a&&-1!==a){const d=s.nodeName.substring(a+1);-1!==pg.indexOf(d)&&(s.nodeName=s.nodeName.substring(0,a),s.objectName=d)}if(null===s.propertyName||0===s.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const s=t.skeleton.getBoneByName(i);if(void 0!==s)return s}if(t.children){const s=function(d){for(let m=0;m<d.length;m++){const y=d[m];if(y.name===i||y.uuid===i)return y;const v=s(y.children);if(v)return v}return null},a=s(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const s=this.resolvedProperty;for(let a=0,d=s.length;a!==d;++a)t[i++]=s[a]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const s=this.resolvedProperty;for(let a=0,d=s.length;a!==d;++a)s[a]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const s=this.resolvedProperty;for(let a=0,d=s.length;a!==d;++a)s[a]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const s=this.resolvedProperty;for(let a=0,d=s.length;a!==d;++a)s[a]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,s=i.objectName,a=i.propertyName;let d=i.propertyIndex;if(t||(t=l.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(s){let M=i.objectIndex;switch(s){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let b=0;b<t.length;b++)if(t[b].name===M){M=b;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[s])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[s]}if(void 0!==M){if(void 0===t[M])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[M]}}const m=t[a];if(void 0===m)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+a+" but it wasn't found.",t);let y=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?y=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(y=this.Versioning.MatrixWorldNeedsUpdate);let v=this.BindingType.Direct;if(void 0!==d){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[d]&&(d=t.morphTargetDictionary[d])}v=this.BindingType.ArrayElement,this.resolvedProperty=m,this.propertyIndex=d}else void 0!==m.fromArray&&void 0!==m.toArray?(v=this.BindingType.HasFromToArray,this.resolvedProperty=m):Array.isArray(m)?(v=this.BindingType.EntireArray,this.resolvedProperty=m):this.propertyName=a;this.getValue=this.GetterByBindingType[v],this.setValue=this.SetterByBindingTypeAndVersioning[v][y]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return l.Composite=J_,l})();Xi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Xi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Xi.prototype.GetterByBindingType=[Xi.prototype._getValue_direct,Xi.prototype._getValue_array,Xi.prototype._getValue_arrayElement,Xi.prototype._getValue_toArray],Xi.prototype.SetterByBindingTypeAndVersioning=[[Xi.prototype._setValue_direct,Xi.prototype._setValue_direct_setNeedsUpdate,Xi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_array,Xi.prototype._setValue_array_setNeedsUpdate,Xi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_arrayElement,Xi.prototype._setValue_arrayElement_setNeedsUpdate,Xi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_fromArray,Xi.prototype._setValue_fromArray_setNeedsUpdate,Xi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class mg extends Ud{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class ny{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Ct(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Ct(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const ry=new K,od=new K,ic=new K,rc=new K,sy=new K,_g=new K,XM=new K;class m0 extends _o{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):console.warn("THREE.Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function Eg(l,e,t,i){const s=function nb(l){switch(l){case We:case ze:return{byteLength:1,components:1};case ni:case Ut:case Qr:return{byteLength:2,components:1};case ws:case ii:return{byteLength:2,components:4};case Cn:case Bi:case si:return{byteLength:4,components:1};case Un:case ri:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${l}.`)}(i);switch(t){case us:return l*e;case ia:case cl:return l*e/s.components*s.byteLength;case Bs:case ra:return l*e*2/s.components*s.byteLength;case vi:return l*e*3/s.components*s.byteLength;case on:case kn:return l*e*4/s.components*s.byteLength;case hc:case fc:return Math.floor((l+3)/4)*Math.floor((e+3)/4)*8;case sa:case Cs:return Math.floor((l+3)/4)*Math.floor((e+3)/4)*16;case Mr:case dl:return Math.max(l,16)*Math.max(e,8)/4;case ul:case uu:return Math.max(l,8)*Math.max(e,8)/2;case Zn:case Zi:return Math.floor((l+3)/4)*Math.floor((e+3)/4)*8;case Ki:case Ao:return Math.floor((l+3)/4)*Math.floor((e+3)/4)*16;case hr:return Math.floor((l+4)/5)*Math.floor((e+3)/4)*16;case Do:return Math.floor((l+4)/5)*Math.floor((e+4)/5)*16;case hl:return Math.floor((l+5)/6)*Math.floor((e+4)/5)*16;case Pa:return Math.floor((l+5)/6)*Math.floor((e+5)/6)*16;case ds:return Math.floor((l+7)/8)*Math.floor((e+4)/5)*16;case Rt:return Math.floor((l+7)/8)*Math.floor((e+5)/6)*16;case mn:return Math.floor((l+7)/8)*Math.floor((e+7)/8)*16;case Ri:return Math.floor((l+9)/10)*Math.floor((e+4)/5)*16;case Ci:return Math.floor((l+9)/10)*Math.floor((e+5)/6)*16;case hs:return Math.floor((l+9)/10)*Math.floor((e+7)/8)*16;case Wi:return Math.floor((l+9)/10)*Math.floor((e+9)/10)*16;case br:return Math.floor((l+11)/12)*Math.floor((e+9)/10)*16;case xi:return Math.floor((l+11)/12)*Math.floor((e+11)/12)*16;case fl:case es:case dn:return Math.ceil(l/4)*Math.ceil(e/4)*16;case oa:case aa:return Math.ceil(l/4)*Math.ceil(e/4)*8;case du:case Pi:return Math.ceil(l/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function y0(l,e,t,i,s,a,d){try{var m=l[a](d),y=m.value}catch(v){return void t(v)}m.done?e(y):Promise.resolve(y).then(i,s)}function kf(l){return function(){var e=this,t=arguments;return new Promise(function(i,s){var a=l.apply(e,t);function d(y){y0(a,i,s,d,m,"next",y)}function m(y){y0(a,i,s,d,m,"throw",y)}d(void 0)})}}function hy(){let l=null,e=!1,t=null,i=null;function s(a,d){t(a,d),i=l.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==t&&(i=l.requestAnimationFrame(s),e=!0)},stop:function(){l.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){l=a}}}function v0(l){const e=new WeakMap;return{get:function s(m){return m.isInterleavedBufferAttribute&&(m=m.data),e.get(m)},remove:function a(m){m.isInterleavedBufferAttribute&&(m=m.data);const y=e.get(m);y&&(l.deleteBuffer(y.buffer),e.delete(m))},update:function d(m,y){if(m.isInterleavedBufferAttribute&&(m=m.data),m.isGLBufferAttribute){const M=e.get(m);return void((!M||M.version<m.version)&&e.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}const v=e.get(m);if(void 0===v)e.set(m,function t(m,y){const v=m.array,M=m.usage,b=v.byteLength,E=l.createBuffer();let C;if(l.bindBuffer(y,E),l.bufferData(y,v,M),m.onUploadCallback(),v instanceof Float32Array)C=l.FLOAT;else if(typeof Float16Array<"u"&&v instanceof Float16Array)C=l.HALF_FLOAT;else if(v instanceof Uint16Array)C=m.isFloat16BufferAttribute?l.HALF_FLOAT:l.UNSIGNED_SHORT;else if(v instanceof Int16Array)C=l.SHORT;else if(v instanceof Uint32Array)C=l.UNSIGNED_INT;else if(v instanceof Int32Array)C=l.INT;else if(v instanceof Int8Array)C=l.BYTE;else if(v instanceof Uint8Array)C=l.UNSIGNED_BYTE;else{if(!(v instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+v);C=l.UNSIGNED_BYTE}return{buffer:E,type:C,bytesPerElement:v.BYTES_PER_ELEMENT,version:m.version,size:b}}(m,y));else if(v.version<m.version){if(v.size!==m.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function i(m,y,v){const M=y.array,b=y.updateRanges;if(l.bindBuffer(v,m),0===b.length)l.bufferSubData(v,0,M);else{b.sort((C,D)=>C.start-D.start);let E=0;for(let C=1;C<b.length;C++){const D=b[E],O=b[C];O.start<=D.start+D.count+1?D.count=Math.max(D.count,O.start+O.count-D.start):(++E,b[E]=O)}b.length=E+1;for(let C=0,D=b.length;C<D;C++){const O=b[C];l.bufferSubData(v,O.start*M.BYTES_PER_ELEMENT,M,O.start,O.count)}y.clearUpdateRanges()}y.onUploadCallback()})(v.buffer,m,y),v.version=m.version}}}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:U}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=U);const $n={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Tt={common:{diffuse:{value:new Nt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Rn},alphaMap:{value:null},alphaMapTransform:{value:new Rn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Rn}},envmap:{envMap:{value:null},envMapRotation:{value:new Rn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Rn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Rn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Rn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Rn},normalScale:{value:new Ce(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Rn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Rn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Rn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Rn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Nt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Nt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Rn},alphaTest:{value:0},uvTransform:{value:new Rn}},sprite:{diffuse:{value:new Nt(16777215)},opacity:{value:1},center:{value:new Ce(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Rn},alphaMap:{value:null},alphaMapTransform:{value:new Rn},alphaTest:{value:0}}},oo={basic:{uniforms:Ar([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.fog]),vertexShader:$n.meshbasic_vert,fragmentShader:$n.meshbasic_frag},lambert:{uniforms:Ar([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,Tt.lights,{emissive:{value:new Nt(0)}}]),vertexShader:$n.meshlambert_vert,fragmentShader:$n.meshlambert_frag},phong:{uniforms:Ar([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,Tt.lights,{emissive:{value:new Nt(0)},specular:{value:new Nt(1118481)},shininess:{value:30}}]),vertexShader:$n.meshphong_vert,fragmentShader:$n.meshphong_frag},standard:{uniforms:Ar([Tt.common,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.roughnessmap,Tt.metalnessmap,Tt.fog,Tt.lights,{emissive:{value:new Nt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag},toon:{uniforms:Ar([Tt.common,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.gradientmap,Tt.fog,Tt.lights,{emissive:{value:new Nt(0)}}]),vertexShader:$n.meshtoon_vert,fragmentShader:$n.meshtoon_frag},matcap:{uniforms:Ar([Tt.common,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,{matcap:{value:null}}]),vertexShader:$n.meshmatcap_vert,fragmentShader:$n.meshmatcap_frag},points:{uniforms:Ar([Tt.points,Tt.fog]),vertexShader:$n.points_vert,fragmentShader:$n.points_frag},dashed:{uniforms:Ar([Tt.common,Tt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$n.linedashed_vert,fragmentShader:$n.linedashed_frag},depth:{uniforms:Ar([Tt.common,Tt.displacementmap]),vertexShader:$n.depth_vert,fragmentShader:$n.depth_frag},normal:{uniforms:Ar([Tt.common,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,{opacity:{value:1}}]),vertexShader:$n.meshnormal_vert,fragmentShader:$n.meshnormal_frag},sprite:{uniforms:Ar([Tt.sprite,Tt.fog]),vertexShader:$n.sprite_vert,fragmentShader:$n.sprite_frag},background:{uniforms:{uvTransform:{value:new Rn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:$n.background_vert,fragmentShader:$n.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Rn}},vertexShader:$n.backgroundCube_vert,fragmentShader:$n.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:$n.cube_vert,fragmentShader:$n.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$n.equirect_vert,fragmentShader:$n.equirect_frag},distanceRGBA:{uniforms:Ar([Tt.common,Tt.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$n.distanceRGBA_vert,fragmentShader:$n.distanceRGBA_frag},shadow:{uniforms:Ar([Tt.lights,Tt.fog,{color:{value:new Nt(0)},opacity:{value:1}}]),vertexShader:$n.shadow_vert,fragmentShader:$n.shadow_frag}};oo.physical={uniforms:Ar([oo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Rn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Rn},clearcoatNormalScale:{value:new Ce(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Rn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Rn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Rn},sheen:{value:0},sheenColor:{value:new Nt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Rn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Rn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Rn},transmissionSamplerSize:{value:new Ce},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Rn},attenuationDistance:{value:0},attenuationColor:{value:new Nt(0)},specularColor:{value:new Nt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Rn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Rn},anisotropyVector:{value:new Ce},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Rn}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag};const nm={r:0,b:0,g:0},cd=new Lo,sx=new yn;function ox(l,e,t,i,s,a,d){const m=new Nt(0);let v,M,y=!0===a?0:1,b=null,E=0,C=null;function D(k){let V=!0===k.isScene?k.background:null;return V&&V.isTexture&&(V=(k.backgroundBlurriness>0?t:e).get(V)),V}function A(k,V){k.getRGB(nm,Qh(l)),i.buffers.color.setClear(nm.r,nm.g,nm.b,V,d)}return{getClearColor:function(){return m},setClearColor:function(k,V=1){m.set(k),y=V,A(m,y)},getClearAlpha:function(){return y},setClearAlpha:function(k){y=k,A(m,y)},render:function O(k){let V=!1;const Z=D(k);null===Z?A(m,y):Z&&Z.isColor&&(A(Z,1),V=!0);const q=l.xr.getEnvironmentBlendMode();"additive"===q?i.buffers.color.setClear(0,0,0,1,d):"alpha-blend"===q&&i.buffers.color.setClear(0,0,0,0,d),(l.autoClear||V)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil))},addToRenderList:function N(k,V){const Z=D(V);Z&&(Z.isCubeTexture||Z.mapping===xr)?(void 0===M&&(M=new kr(new Ll(1,1,1),new io({name:"BackgroundCubeMaterial",uniforms:Cc(oo.backgroundCube.uniforms),vertexShader:oo.backgroundCube.vertexShader,fragmentShader:oo.backgroundCube.fragmentShader,side:fn,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),M.geometry.deleteAttribute("normal"),M.geometry.deleteAttribute("uv"),M.onBeforeRender=function(q,ee,ne){this.matrixWorld.copyPosition(ne.matrixWorld)},Object.defineProperty(M.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(M)),cd.copy(V.backgroundRotation),cd.x*=-1,cd.y*=-1,cd.z*=-1,Z.isCubeTexture&&!1===Z.isRenderTargetTexture&&(cd.y*=-1,cd.z*=-1),M.material.uniforms.envMap.value=Z,M.material.uniforms.flipEnvMap.value=Z.isCubeTexture&&!1===Z.isRenderTargetTexture?-1:1,M.material.uniforms.backgroundBlurriness.value=V.backgroundBlurriness,M.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,M.material.uniforms.backgroundRotation.value.setFromMatrix4(sx.makeRotationFromEuler(cd)),M.material.toneMapped=Kn.getTransfer(Z.colorSpace)!==ci,(b!==Z||E!==Z.version||C!==l.toneMapping)&&(M.material.needsUpdate=!0,b=Z,E=Z.version,C=l.toneMapping),M.layers.enableAll(),k.unshift(M,M.geometry,M.material,0,0,null)):Z&&Z.isTexture&&(void 0===v&&(v=new kr(new Qu(2,2),new io({name:"BackgroundMaterial",uniforms:Cc(oo.background.uniforms),vertexShader:oo.background.vertexShader,fragmentShader:oo.background.fragmentShader,side:pt,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),v.geometry.deleteAttribute("normal"),Object.defineProperty(v.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(v)),v.material.uniforms.t2D.value=Z,v.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,v.material.toneMapped=Kn.getTransfer(Z.colorSpace)!==ci,!0===Z.matrixAutoUpdate&&Z.updateMatrix(),v.material.uniforms.uvTransform.value.copy(Z.matrix),(b!==Z||E!==Z.version||C!==l.toneMapping)&&(v.material.needsUpdate=!0,b=Z,E=Z.version,C=l.toneMapping),v.layers.enableAll(),k.unshift(v,v.geometry,v.material,0,0,null))},dispose:function H(){void 0!==M&&(M.geometry.dispose(),M.material.dispose(),M=void 0),void 0!==v&&(v.geometry.dispose(),v.material.dispose(),v=void 0)}}}function ax(l,e){const t=l.getParameter(l.MAX_VERTEX_ATTRIBS),i={},s=E(null);let a=s,d=!1;function v(j){return l.bindVertexArray(j)}function M(j){return l.deleteVertexArray(j)}function E(j){const se=[],me=[],ve=[];for(let we=0;we<t;we++)se[we]=0,me[we]=0,ve[we]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:se,enabledAttributes:me,attributeDivisors:ve,object:j,attributes:{},index:null}}function O(){const j=a.newAttributes;for(let se=0,me=j.length;se<me;se++)j[se]=0}function N(j){A(j,0)}function A(j,se){const ve=a.enabledAttributes,we=a.attributeDivisors;a.newAttributes[j]=1,0===ve[j]&&(l.enableVertexAttribArray(j),ve[j]=1),we[j]!==se&&(l.vertexAttribDivisor(j,se),we[j]=se)}function H(){const j=a.newAttributes,se=a.enabledAttributes;for(let me=0,ve=se.length;me<ve;me++)se[me]!==j[me]&&(l.disableVertexAttribArray(me),se[me]=0)}function k(j,se,me,ve,we,Ne,De){!0===De?l.vertexAttribIPointer(j,se,me,we,Ne):l.vertexAttribPointer(j,se,me,ve,we,Ne)}function ne(){X(),d=!0,a!==s&&(a=s,v(a.object))}function X(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:function m(j,se,me,ve,we){let Ne=!1;const De=function b(j,se,me){const ve=!0===me.wireframe;let we=i[j.id];void 0===we&&(we={},i[j.id]=we);let Ne=we[se.id];void 0===Ne&&(Ne={},we[se.id]=Ne);let De=Ne[ve];return void 0===De&&(De=E(function y(){return l.createVertexArray()}()),Ne[ve]=De),De}(ve,me,se);a!==De&&(a=De,v(a.object)),Ne=function C(j,se,me,ve){const we=a.attributes,Ne=se.attributes;let De=0;const it=me.getAttributes();for(const Ie in it)if(it[Ie].location>=0){const zt=we[Ie];let qt=Ne[Ie];if(void 0===qt&&("instanceMatrix"===Ie&&j.instanceMatrix&&(qt=j.instanceMatrix),"instanceColor"===Ie&&j.instanceColor&&(qt=j.instanceColor)),void 0===zt||zt.attribute!==qt||qt&&zt.data!==qt.data)return!0;De++}return a.attributesNum!==De||a.index!==ve}(j,ve,me,we),Ne&&function D(j,se,me,ve){const we={},Ne=se.attributes;let De=0;const it=me.getAttributes();for(const Ie in it)if(it[Ie].location>=0){let zt=Ne[Ie];void 0===zt&&("instanceMatrix"===Ie&&j.instanceMatrix&&(zt=j.instanceMatrix),"instanceColor"===Ie&&j.instanceColor&&(zt=j.instanceColor));const qt={};qt.attribute=zt,zt&&zt.data&&(qt.data=zt.data),we[Ie]=qt,De++}a.attributes=we,a.attributesNum=De,a.index=ve}(j,ve,me,we),null!==we&&e.update(we,l.ELEMENT_ARRAY_BUFFER),(Ne||d)&&(d=!1,function V(j,se,me,ve){O();const we=ve.attributes,Ne=me.getAttributes(),De=se.defaultAttributeValues;for(const it in Ne){const Ie=Ne[it];if(Ie.location>=0){let At=we[it];if(void 0===At&&("instanceMatrix"===it&&j.instanceMatrix&&(At=j.instanceMatrix),"instanceColor"===it&&j.instanceColor&&(At=j.instanceColor)),void 0!==At){const zt=At.normalized,qt=At.itemSize,Vn=e.get(At);if(void 0===Vn)continue;const ui=Vn.buffer,Ti=Vn.type,di=Vn.bytesPerElement,Ue=Ti===l.INT||Ti===l.UNSIGNED_INT||At.gpuType===Bi;if(At.isInterleavedBufferAttribute){const Ke=At.data,nn=Ke.stride,hn=At.offset;if(Ke.isInstancedInterleavedBuffer){for(let sn=0;sn<Ie.locationSize;sn++)A(Ie.location+sn,Ke.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===ve._maxInstanceCount&&(ve._maxInstanceCount=Ke.meshPerAttribute*Ke.count)}else for(let sn=0;sn<Ie.locationSize;sn++)N(Ie.location+sn);l.bindBuffer(l.ARRAY_BUFFER,ui);for(let sn=0;sn<Ie.locationSize;sn++)k(Ie.location+sn,qt/Ie.locationSize,Ti,zt,nn*di,(hn+qt/Ie.locationSize*sn)*di,Ue)}else{if(At.isInstancedBufferAttribute){for(let Ke=0;Ke<Ie.locationSize;Ke++)A(Ie.location+Ke,At.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===ve._maxInstanceCount&&(ve._maxInstanceCount=At.meshPerAttribute*At.count)}else for(let Ke=0;Ke<Ie.locationSize;Ke++)N(Ie.location+Ke);l.bindBuffer(l.ARRAY_BUFFER,ui);for(let Ke=0;Ke<Ie.locationSize;Ke++)k(Ie.location+Ke,qt/Ie.locationSize,Ti,zt,qt*di,qt/Ie.locationSize*Ke*di,Ue)}}else if(void 0!==De){const zt=De[it];if(void 0!==zt)switch(zt.length){case 2:l.vertexAttrib2fv(Ie.location,zt);break;case 3:l.vertexAttrib3fv(Ie.location,zt);break;case 4:l.vertexAttrib4fv(Ie.location,zt);break;default:l.vertexAttrib1fv(Ie.location,zt)}}}}H()}(j,se,me,ve),null!==we&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,e.get(we).buffer))},reset:ne,resetDefaultState:X,dispose:function Z(){ne();for(const j in i){const se=i[j];for(const me in se){const ve=se[me];for(const we in ve)M(ve[we].object),delete ve[we];delete se[me]}delete i[j]}},releaseStatesOfGeometry:function q(j){if(void 0===i[j.id])return;const se=i[j.id];for(const me in se){const ve=se[me];for(const we in ve)M(ve[we].object),delete ve[we];delete se[me]}delete i[j.id]},releaseStatesOfProgram:function ee(j){for(const se in i){const me=i[se];if(void 0===me[j.id])continue;const ve=me[j.id];for(const we in ve)M(ve[we].object),delete ve[we];delete me[j.id]}},initAttributes:O,enableAttribute:N,disableUnusedAttributes:H}}function lx(l,e,t){let i;function d(v,M,b){0!==b&&(l.drawArraysInstanced(i,v,M,b),t.update(M,i,b))}this.setMode=function s(v){i=v},this.render=function a(v,M){l.drawArrays(i,v,M),t.update(M,i,1)},this.renderInstances=d,this.renderMultiDraw=function m(v,M,b){if(0===b)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,v,0,M,0,b);let C=0;for(let D=0;D<b;D++)C+=M[D];t.update(C,i,1)},this.renderMultiDrawInstances=function y(v,M,b,E){if(0===b)return;const C=e.get("WEBGL_multi_draw");if(null===C)for(let D=0;D<v.length;D++)d(v[D],M[D],E[D]);else{C.multiDrawArraysInstancedWEBGL(i,v,0,M,0,E,0,b);let D=0;for(let O=0;O<b;O++)D+=M[O]*E[O];t.update(D,i,1)}}}function Jy(l,e,t,i){let s;function y(ee){if("highp"===ee){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";ee="mediump"}return"mediump"===ee&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let v=void 0!==t.precision?t.precision:"highp";const M=y(v);M!==v&&(console.warn("THREE.WebGLRenderer:",v,"not supported, using",M,"instead."),v=M);const b=!0===t.logarithmicDepthBuffer,E=!0===t.reversedDepthBuffer&&e.has("EXT_clip_control"),C=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),D=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function a(){if(void 0!==s)return s;if(!0===e.has("EXT_texture_filter_anisotropic")){const ee=e.get("EXT_texture_filter_anisotropic");s=l.getParameter(ee.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s},getMaxPrecision:y,textureFormatReadable:function d(ee){return!(ee!==on&&i.convert(ee)!==l.getParameter(l.IMPLEMENTATION_COLOR_READ_FORMAT))},textureTypeReadable:function m(ee){const ne=ee===Qr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(ee!==We&&i.convert(ee)!==l.getParameter(l.IMPLEMENTATION_COLOR_READ_TYPE)&&ee!==si&&!ne)},precision:v,logarithmicDepthBuffer:b,reversedDepthBuffer:E,maxTextures:C,maxVertexTextures:D,maxTextureSize:l.getParameter(l.MAX_TEXTURE_SIZE),maxCubemapSize:l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:l.getParameter(l.MAX_VERTEX_ATTRIBS),maxVertexUniforms:l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:l.getParameter(l.MAX_VARYING_VECTORS),maxFragmentUniforms:l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:D>0,maxSamples:l.getParameter(l.MAX_SAMPLES)}}function Qy(l){const e=this;let t=null,i=0,s=!1,a=!1;const d=new Vo,m=new Rn,y={value:null,needsUpdate:!1};function M(b,E,C,D){const O=null!==b?b.length:0;let N=null;if(0!==O){if(N=y.value,!0!==D||null===N){const A=C+4*O,H=E.matrixWorldInverse;m.getNormalMatrix(H),(null===N||N.length<A)&&(N=new Float32Array(A));for(let k=0,V=C;k!==O;++k,V+=4)d.copy(b[k]).applyMatrix4(H,m),d.normal.toArray(N,V),N[V+3]=d.constant}y.value=N,y.needsUpdate=!0}return e.numPlanes=O,e.numIntersection=0,N}this.uniform=y,this.numPlanes=0,this.numIntersection=0,this.init=function(b,E){const C=0!==b.length||E||0!==i||s;return s=E,i=b.length,C},this.beginShadows=function(){a=!0,M(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(b,E){t=M(b,E,0)},this.setState=function(b,E,C){const D=b.clippingPlanes,O=b.clipIntersection,N=b.clipShadows,A=l.get(b);if(!s||null===D||0===D.length||a&&!N)a?M(null):function v(){y.value!==t&&(y.value=t,y.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const H=a?0:i,k=4*H;let V=A.clippingState||null;y.value=V,V=M(D,E,k,C);for(let Z=0;Z!==k;++Z)V[Z]=t[Z];A.clippingState=V,this.numIntersection=O?this.numPlanes:0,this.numPlanes+=H}}}function ev(l){let e=new WeakMap;function t(d,m){return m===Fs?d.mapping=Xe:m===qi&&(d.mapping=xt),d}function s(d){const m=d.target;m.removeEventListener("dispose",s);const y=e.get(m);void 0!==y&&(e.delete(m),y.dispose())}return{get:function i(d){if(d&&d.isTexture){const m=d.mapping;if(m===Fs||m===qi){if(e.has(d))return t(e.get(d).texture,d.mapping);{const y=d.image;if(y&&y.height>0){const v=new cp(y.height);return v.fromEquirectangularTexture(l,d),e.set(d,v),d.addEventListener("dispose",s),t(v.texture,d.mapping)}return null}}}return d},dispose:function a(){e=new WeakMap}}}const zg=[.125,.215,.35,.446,.526,.582],im=new cg,Gg=new Nt;let rm=null,sm=0,om=0,oc=!1;const dd=(1+Math.sqrt(5))/2,wh=1/dd,hd=[new K(-dd,wh,0),new K(dd,wh,0),new K(-wh,0,dd),new K(wh,0,dd),new K(0,dd,-wh),new K(0,dd,wh),new K(-1,1,-1),new K(1,1,-1),new K(-1,1,1),new K(1,1,1)],bb=new K;class am{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100,a={}){const{size:d=256,position:m=bb}=a;rm=this._renderer.getRenderTarget(),sm=this._renderer.getActiveCubeFace(),om=this._renderer.getActiveMipmapLevel(),oc=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(d);const y=this._allocateTargets();return y.depthBuffer=!0,this._sceneToCubeUV(e,i,s,y,m),t>0&&this._blur(y,0,0,t),this._applyPMREM(y),this._cleanup(y),y}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=tv(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=bn(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(rm,sm,om),this._renderer.xr.enabled=oc,e.scissorTest=!1,Hf(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Xe||e.mapping===xt?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),rm=this._renderer.getRenderTarget(),sm=this._renderer.getActiveCubeFace(),om=this._renderer.getActiveMipmapLevel(),oc=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:dr,minFilter:dr,generateMipmaps:!1,type:Qr,format:on,colorSpace:As,depthBuffer:!1},s=Wg(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Wg(e,t,i);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Sb(l){const e=[],t=[],i=[];let s=l;const a=l-4+1+zg.length;for(let d=0;d<a;d++){const m=Math.pow(2,s);t.push(m);let y=1/m;d>l-4?y=zg[d-l+4-1]:0===d&&(y=0),i.push(y);const v=1/(m-2),M=-v,b=1+v,E=[M,M,b,M,b,b,M,M,b,b,M,b],C=6,D=6,O=3,N=2,A=1,H=new Float32Array(O*D*C),k=new Float32Array(N*D*C),V=new Float32Array(A*D*C);for(let q=0;q<C;q++){const ee=q%3*2/3-1,ne=q>2?0:-1;H.set([ee,ne,0,ee+2/3,ne,0,ee+2/3,ne+1,0,ee,ne,0,ee+2/3,ne+1,0,ee,ne+1,0],O*D*q),k.set(E,N*D*q),V.set([q,q,q,q,q,q],A*D*q)}const Z=new An;Z.setAttribute("position",new Tr(H,O)),Z.setAttribute("uv",new Tr(k,N)),Z.setAttribute("faceIndex",new Tr(V,A)),e.push(Z),s>4&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(a)),this._blurMaterial=function Eb(l,e,t){const i=new Float32Array(20),s=new K(0,1,0);return new io({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${l}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Qt,depthTest:!1,depthWrite:!1})}(a,e,t)}return s}_compileMaterial(e){const t=new kr(this._lodPlanes[0],e);this._renderer.compile(t,im)}_sceneToCubeUV(e,t,i,s,a){const y=new ss(90,1,t,i),v=[1,-1,1,1,1,1],M=[1,1,1,-1,-1,-1],b=this._renderer,E=b.autoClear,C=b.toneMapping;b.getClearColor(Gg),b.toneMapping=Li,b.autoClear=!1,b.state.buffers.depth.getReversed()&&(b.setRenderTarget(s),b.clearDepth(),b.setRenderTarget(null));const O=new Mo({name:"PMREM.Background",side:fn,depthWrite:!1,depthTest:!1}),N=new kr(new Ll,O);let A=!1;const H=e.background;H?H.isColor&&(O.color.copy(H),e.background=null,A=!0):(O.color.copy(Gg),A=!0);for(let k=0;k<6;k++){const V=k%3;0===V?(y.up.set(0,v[k],0),y.position.set(a.x,a.y,a.z),y.lookAt(a.x+M[k],a.y,a.z)):1===V?(y.up.set(0,0,v[k]),y.position.set(a.x,a.y,a.z),y.lookAt(a.x,a.y+M[k],a.z)):(y.up.set(0,v[k],0),y.position.set(a.x,a.y,a.z),y.lookAt(a.x,a.y,a.z+M[k]));const Z=this._cubeSize;Hf(s,V*Z,k>2?Z:0,Z,Z),b.setRenderTarget(s),A&&b.render(N,y),b.render(e,y)}N.geometry.dispose(),N.material.dispose(),b.toneMapping=C,b.autoClear=E,e.background=H}_textureToCubeUV(e,t){const i=this._renderer,s=e.mapping===Xe||e.mapping===xt;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=tv()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=bn());const a=s?this._cubemapMaterial:this._equirectMaterial,d=new kr(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const y=this._cubeSize;Hf(t,0,0,3*y,2*y),i.setRenderTarget(t),i.render(d,im)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let a=1;a<s;a++){const d=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]);this._blur(e,a-1,a,d,hd[(s-a-1)%hd.length])}t.autoClear=i}_blur(e,t,i,s,a){const d=this._pingPongRenderTarget;this._halfBlur(e,d,t,i,s,"latitudinal",a),this._halfBlur(d,e,i,i,s,"longitudinal",a)}_halfBlur(e,t,i,s,a,d,m){const y=this._renderer,v=this._blurMaterial;"latitudinal"!==d&&"longitudinal"!==d&&console.error("blur direction must be either latitudinal or longitudinal!");const b=new kr(this._lodPlanes[s],v),E=v.uniforms,C=this._sizeLods[i]-1,D=isFinite(a)?Math.PI/(2*C):2*Math.PI/39,O=a/D,N=isFinite(a)?1+Math.floor(3*O):20;N>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${N} samples when the maximum is set to 20`);const A=[];let H=0;for(let ee=0;ee<20;++ee){const ne=ee/O,X=Math.exp(-ne*ne/2);A.push(X),0===ee?H+=X:ee<N&&(H+=2*X)}for(let ee=0;ee<A.length;ee++)A[ee]=A[ee]/H;E.envMap.value=e.texture,E.samples.value=N,E.weights.value=A,E.latitudinal.value="latitudinal"===d,m&&(E.poleAxis.value=m);const{_lodMax:k}=this;E.dTheta.value=D,E.mipInt.value=k-i;const V=this._sizeLods[s];Hf(t,3*V*(s>k-4?s-k+4:0),4*(this._cubeSize-V),3*V,2*V),y.setRenderTarget(t),y.render(b,im)}}function Wg(l,e,t){const i=new _e(l,e,t);return i.texture.mapping=xr,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Hf(l,e,t,i,s){l.viewport.set(e,t,i,s),l.scissor.set(e,t,i,s)}function bn(){return new io({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Qt,depthTest:!1,depthWrite:!1})}function tv(){return new io({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Qt,depthTest:!1,depthWrite:!1})}function cx(l){let e=new WeakMap,t=null;function a(m){const y=m.target;y.removeEventListener("dispose",a);const v=e.get(y);void 0!==v&&(e.delete(y),v.dispose())}return{get:function i(m){if(m&&m.isTexture){const y=m.mapping,v=y===Fs||y===qi,M=y===Xe||y===xt;if(v||M){let b=e.get(m);if(m.isRenderTargetTexture&&m.pmremVersion!==(void 0!==b?b.texture.pmremVersion:0))return null===t&&(t=new am(l)),b=v?t.fromEquirectangular(m,b):t.fromCubemap(m,b),b.texture.pmremVersion=m.pmremVersion,e.set(m,b),b.texture;if(void 0!==b)return b.texture;{const C=m.image;return v&&C&&C.height>0||M&&C&&function s(m){let y=0;for(let M=0;M<6;M++)void 0!==m[M]&&y++;return 6===y}(C)?(null===t&&(t=new am(l)),b=v?t.fromEquirectangular(m):t.fromCubemap(m),b.texture.pmremVersion=m.pmremVersion,e.set(m,b),m.addEventListener("dispose",a),b.texture):null}}}return m},dispose:function d(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Ch(l){const e={};function t(i){if(void 0!==e[i])return e[i];let s;switch(i){case"WEBGL_depth_texture":s=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=l.getExtension(i)}return e[i]=s,s}return{has:function(i){return null!==t(i)},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const s=t(i);return null===s&&bl("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function ux(l,e,t,i){const s={},a=new WeakMap;function d(b){const E=b.target;null!==E.index&&e.remove(E.index);for(const D in E.attributes)e.remove(E.attributes[D]);E.removeEventListener("dispose",d),delete s[E.id];const C=a.get(E);C&&(e.remove(C),a.delete(E)),i.releaseStatesOfGeometry(E),!0===E.isInstancedBufferGeometry&&delete E._maxInstanceCount,t.memory.geometries--}function v(b){const E=[],C=b.index,D=b.attributes.position;let O=0;if(null!==C){const H=C.array;O=C.version;for(let k=0,V=H.length;k<V;k+=3){const Z=H[k+0],q=H[k+1],ee=H[k+2];E.push(Z,q,q,ee,ee,Z)}}else{if(void 0===D)return;O=D.version;for(let k=0,V=D.array.length/3-1;k<V;k+=3){const Z=k+0,q=k+1,ee=k+2;E.push(Z,q,q,ee,ee,Z)}}const N=new(Wh(E)?Kh:Zh)(E,1);N.version=O;const A=a.get(b);A&&e.remove(A),a.set(b,N)}return{get:function m(b,E){return!0===s[E.id]||(E.addEventListener("dispose",d),s[E.id]=!0,t.memory.geometries++),E},update:function y(b){const E=b.attributes;for(const C in E)e.update(E[C],l.ARRAY_BUFFER)},getWireframeAttribute:function M(b){const E=a.get(b);if(E){const C=b.index;null!==C&&E.version<C.version&&v(b)}else v(b);return a.get(b)}}}function lm(l,e,t){let i,a,d;function v(E,C,D){0!==D&&(l.drawElementsInstanced(i,C,a,E*d,D),t.update(C,i,D))}this.setMode=function s(E){i=E},this.setIndex=function m(E){a=E.type,d=E.bytesPerElement},this.render=function y(E,C){l.drawElements(i,C,a,E*d),t.update(C,i,1)},this.renderInstances=v,this.renderMultiDraw=function M(E,C,D){if(0===D)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,C,0,a,E,0,D);let N=0;for(let A=0;A<D;A++)N+=C[A];t.update(N,i,1)},this.renderMultiDrawInstances=function b(E,C,D,O){if(0===D)return;const N=e.get("WEBGL_multi_draw");if(null===N)for(let A=0;A<E.length;A++)v(E[A]/d,C[A],O[A]);else{N.multiDrawElementsInstancedWEBGL(i,C,0,a,E,0,O,0,D);let A=0;for(let H=0;H<D;H++)A+=C[H]*O[H];t.update(A,i,1)}}}function cm(l){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(a,d,m){switch(t.calls++,d){case l.TRIANGLES:t.triangles+=m*(a/3);break;case l.LINES:t.lines+=m*(a/2);break;case l.LINE_STRIP:t.lines+=m*(a-1);break;case l.LINE_LOOP:t.lines+=m*a;break;case l.POINTS:t.points+=m*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function _r(l,e,t){const i=new WeakMap,s=new G;return{update:function a(d,m,y){const v=d.morphTargetInfluences,M=m.morphAttributes.position||m.morphAttributes.normal||m.morphAttributes.color,b=void 0!==M?M.length:0;let E=i.get(m);if(void 0===E||E.count!==b){let X=function(){ee.dispose(),i.delete(m),m.removeEventListener("dispose",X)};void 0!==E&&E.texture.dispose();const C=void 0!==m.morphAttributes.position,D=void 0!==m.morphAttributes.normal,O=void 0!==m.morphAttributes.color,N=m.morphAttributes.position||[],A=m.morphAttributes.normal||[],H=m.morphAttributes.color||[];let k=0;!0===C&&(k=1),!0===D&&(k=2),!0===O&&(k=3);let V=m.attributes.position.count*k,Z=1;V>e.maxTextureSize&&(Z=Math.ceil(V/e.maxTextureSize),V=e.maxTextureSize);const q=new Float32Array(V*Z*4*b),ee=new Ae(q,V,Z,b);ee.type=si,ee.needsUpdate=!0;const ne=4*k;for(let j=0;j<b;j++){const se=N[j],me=A[j],ve=H[j],we=V*Z*4*j;for(let Ne=0;Ne<se.count;Ne++){const De=Ne*ne;!0===C&&(s.fromBufferAttribute(se,Ne),q[we+De+0]=s.x,q[we+De+1]=s.y,q[we+De+2]=s.z,q[we+De+3]=0),!0===D&&(s.fromBufferAttribute(me,Ne),q[we+De+4]=s.x,q[we+De+5]=s.y,q[we+De+6]=s.z,q[we+De+7]=0),!0===O&&(s.fromBufferAttribute(ve,Ne),q[we+De+8]=s.x,q[we+De+9]=s.y,q[we+De+10]=s.z,q[we+De+11]=4===ve.itemSize?s.w:1)}}E={count:b,texture:ee,size:new Ce(V,Z)},i.set(m,E),m.addEventListener("dispose",X)}if(!0===d.isInstancedMesh&&null!==d.morphTexture)y.getUniforms().setValue(l,"morphTexture",d.morphTexture,t);else{let C=0;for(let O=0;O<v.length;O++)C+=v[O];const D=m.morphTargetsRelative?1:1-C;y.getUniforms().setValue(l,"morphTargetBaseInfluence",D),y.getUniforms().setValue(l,"morphTargetInfluences",v)}y.getUniforms().setValue(l,"morphTargetsTexture",E.texture,t),y.getUniforms().setValue(l,"morphTargetsTextureSize",E.size)}}}function wb(l,e,t,i){let s=new WeakMap;function m(y){const v=y.target;v.removeEventListener("dispose",m),t.remove(v.instanceMatrix),null!==v.instanceColor&&t.remove(v.instanceColor)}return{update:function a(y){const v=i.render.frame,b=e.get(y,y.geometry);if(s.get(b)!==v&&(e.update(b),s.set(b,v)),y.isInstancedMesh&&(!1===y.hasEventListener("dispose",m)&&y.addEventListener("dispose",m),s.get(y)!==v&&(t.update(y.instanceMatrix,l.ARRAY_BUFFER),null!==y.instanceColor&&t.update(y.instanceColor,l.ARRAY_BUFFER),s.set(y,v))),y.isSkinnedMesh){const E=y.skeleton;s.get(E)!==v&&(E.update(),s.set(E,v))}return b},dispose:function d(){s=new WeakMap}}}const jg=new P,Xg=new Jd(1,1),nv=new Ae,Yg=new Qn,qg=new tf,Zg=[],Kg=[],iv=new Float32Array(16),rv=new Float32Array(9),sv=new Float32Array(4);function sl(l,e,t){const i=l[0];if(i<=0||i>0)return l;const s=e*t;let a=Zg[s];if(void 0===a&&(a=new Float32Array(s),Zg[s]=a),0!==e){i.toArray(a,0);for(let d=1,m=0;d!==e;++d)m+=t,l[d].toArray(a,m)}return a}function qr(l,e){if(l.length!==e.length)return!1;for(let t=0,i=l.length;t<i;t++)if(l[t]!==e[t])return!1;return!0}function Zr(l,e){for(let t=0,i=e.length;t<i;t++)l[t]=e[t]}function um(l,e){let t=Kg[e];void 0===t&&(t=new Int32Array(e),Kg[e]=t);for(let i=0;i!==e;++i)t[i]=l.allocateTextureUnit();return t}function dm(l,e){const t=this.cache;t[0]!==e&&(l.uniform1f(this.addr,e),t[0]=e)}function ov(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(qr(t,e))return;l.uniform2fv(this.addr,e),Zr(t,e)}}function av(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(l.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(qr(t,e))return;l.uniform3fv(this.addr,e),Zr(t,e)}}function lv(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(qr(t,e))return;l.uniform4fv(this.addr,e),Zr(t,e)}}function dx(l,e){const t=this.cache,i=e.elements;if(void 0===i){if(qr(t,e))return;l.uniformMatrix2fv(this.addr,!1,e),Zr(t,e)}else{if(qr(t,i))return;sv.set(i),l.uniformMatrix2fv(this.addr,!1,sv),Zr(t,i)}}function zf(l,e){const t=this.cache,i=e.elements;if(void 0===i){if(qr(t,e))return;l.uniformMatrix3fv(this.addr,!1,e),Zr(t,e)}else{if(qr(t,i))return;rv.set(i),l.uniformMatrix3fv(this.addr,!1,rv),Zr(t,i)}}function Gf(l,e){const t=this.cache,i=e.elements;if(void 0===i){if(qr(t,e))return;l.uniformMatrix4fv(this.addr,!1,e),Zr(t,e)}else{if(qr(t,i))return;iv.set(i),l.uniformMatrix4fv(this.addr,!1,iv),Zr(t,i)}}function hx(l,e){const t=this.cache;t[0]!==e&&(l.uniform1i(this.addr,e),t[0]=e)}function fx(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(qr(t,e))return;l.uniform2iv(this.addr,e),Zr(t,e)}}function px(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(qr(t,e))return;l.uniform3iv(this.addr,e),Zr(t,e)}}function cv(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(qr(t,e))return;l.uniform4iv(this.addr,e),Zr(t,e)}}function uv(l,e){const t=this.cache;t[0]!==e&&(l.uniform1ui(this.addr,e),t[0]=e)}function dv(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(qr(t,e))return;l.uniform2uiv(this.addr,e),Zr(t,e)}}function mx(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(qr(t,e))return;l.uniform3uiv(this.addr,e),Zr(t,e)}}function hv(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(qr(t,e))return;l.uniform4uiv(this.addr,e),Zr(t,e)}}function gx(l,e,t){const i=this.cache,s=t.allocateTextureUnit();let a;i[0]!==s&&(l.uniform1i(this.addr,s),i[0]=s),this.type===l.SAMPLER_2D_SHADOW?(Xg.compareFunction=ua,a=Xg):a=jg,t.setTexture2D(e||a,s)}function _x(l,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(l.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||Yg,s)}function Cb(l,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(l.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||qg,s)}function Tb(l,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(l.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||nv,s)}function Db(l,e){l.uniform1fv(this.addr,e)}function fv(l,e){const t=sl(e,this.size,2);l.uniform2fv(this.addr,t)}function hm(l,e){const t=sl(e,this.size,3);l.uniform3fv(this.addr,t)}function yx(l,e){const t=sl(e,this.size,4);l.uniform4fv(this.addr,t)}function vx(l,e){const t=sl(e,this.size,4);l.uniformMatrix2fv(this.addr,!1,t)}function pv(l,e){const t=sl(e,this.size,9);l.uniformMatrix3fv(this.addr,!1,t)}function Wf(l,e){const t=sl(e,this.size,16);l.uniformMatrix4fv(this.addr,!1,t)}function xx(l,e){l.uniform1iv(this.addr,e)}function Mx(l,e){l.uniform2iv(this.addr,e)}function bx(l,e){l.uniform3iv(this.addr,e)}function Sx(l,e){l.uniform4iv(this.addr,e)}function Ib(l,e){l.uniform1uiv(this.addr,e)}function Ex(l,e){l.uniform2uiv(this.addr,e)}function mv(l,e){l.uniform3uiv(this.addr,e)}function wx(l,e){l.uniform4uiv(this.addr,e)}function Cx(l,e,t){const i=this.cache,s=e.length,a=um(t,s);qr(i,a)||(l.uniform1iv(this.addr,a),Zr(i,a));for(let d=0;d!==s;++d)t.setTexture2D(e[d]||jg,a[d])}function $f(l,e,t){const i=this.cache,s=e.length,a=um(t,s);qr(i,a)||(l.uniform1iv(this.addr,a),Zr(i,a));for(let d=0;d!==s;++d)t.setTexture3D(e[d]||Yg,a[d])}function Tx(l,e,t){const i=this.cache,s=e.length,a=um(t,s);qr(i,a)||(l.uniform1iv(this.addr,a),Zr(i,a));for(let d=0;d!==s;++d)t.setTextureCube(e[d]||qg,a[d])}function gv(l,e,t){const i=this.cache,s=e.length,a=um(t,s);qr(i,a)||(l.uniform1iv(this.addr,a),Zr(i,a));for(let d=0;d!==s;++d)t.setTexture2DArray(e[d]||nv,a[d])}class _v{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function Ab(l){switch(l){case 5126:return dm;case 35664:return ov;case 35665:return av;case 35666:return lv;case 35674:return dx;case 35675:return zf;case 35676:return Gf;case 5124:case 35670:return hx;case 35667:case 35671:return fx;case 35668:case 35672:return px;case 35669:case 35673:return cv;case 5125:return uv;case 36294:return dv;case 36295:return mx;case 36296:return hv;case 35678:case 36198:case 36298:case 36306:case 35682:return gx;case 35679:case 36299:case 36307:return _x;case 35680:case 36300:case 36308:case 36293:return Cb;case 36289:case 36303:case 36311:case 36292:return Tb}}(t.type)}}class Dx{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function Ax(l){switch(l){case 5126:return Db;case 35664:return fv;case 35665:return hm;case 35666:return yx;case 35674:return vx;case 35675:return pv;case 35676:return Wf;case 5124:case 35670:return xx;case 35667:case 35671:return Mx;case 35668:case 35672:return bx;case 35669:case 35673:return Sx;case 5125:return Ib;case 36294:return Ex;case 36295:return mv;case 36296:return wx;case 35678:case 36198:case 36298:case 36306:case 35682:return Cx;case 35679:case 36299:case 36307:return $f;case 35680:case 36300:case 36308:case 36293:return Tx;case 36289:case 36303:case 36311:case 36292:return gv}}(t.type)}}class yv{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const s=this.seq;for(let a=0,d=s.length;a!==d;++a){const m=s[a];m.setValue(e,t[m.id],i)}}}const Jg=/(\w+)(\])?(\[|\.)?/g;function fm(l,e){l.seq.push(e),l.map[e.id]=e}function Ix(l,e,t){const i=l.name,s=i.length;for(Jg.lastIndex=0;;){const a=Jg.exec(i);let m=a[1];const v=a[3];if("]"===a[2]&&(m|=0),void 0===v||"["===v&&Jg.lastIndex+2===s){fm(t,void 0===v?new _v(m,l,e):new Dx(m,l,e));break}{let b=t.map[m];void 0===b&&(b=new yv(m),fm(t,b)),t=b}}}class jf{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const a=e.getActiveUniform(t,s);Ix(a,e.getUniformLocation(t,a.name),this)}}setValue(e,t,i,s){const a=this.map[t];void 0!==a&&a.setValue(e,i,s)}setOptional(e,t,i){const s=t[i];void 0!==s&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let a=0,d=t.length;a!==d;++a){const m=t[a],y=i[m.id];!1!==y.needsUpdate&&m.setValue(e,y.value,s)}}static seqWithValue(e,t){const i=[];for(let s=0,a=e.length;s!==a;++s){const d=e[s];d.id in t&&i.push(d)}return i}}function Qg(l,e,t){const i=l.createShader(e);return l.shaderSource(i,t),l.compileShader(i),i}const Rx=37297;let Px=0;const pm=new Rn;function e_(l,e,t){const i=l.getShaderParameter(e,l.COMPILE_STATUS),a=(l.getShaderInfoLog(e)||"").trim();if(i&&""===a)return"";const d=/ERROR: 0:(\d+)/.exec(a);if(d){const m=parseInt(d[1]);return t.toUpperCase()+"\n\n"+a+"\n\n"+function Nx(l,e){const t=l.split("\n"),i=[],s=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let d=s;d<a;d++){const m=d+1;i.push(`${m===e?">":" "} ${m}: ${t[d]}`)}return i.join("\n")}(l.getShaderSource(e),m)}return a}function Ox(l,e){const t=function Lx(l){Kn._getMatrix(pm,Kn.workingColorSpace,l);const e=`mat3( ${pm.elements.map(t=>t.toFixed(4))} )`;switch(Kn.getTransfer(l)){case po:return[e,"LinearTransferOETF"];case ci:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",l),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${l}( vec4 value ) {`,`\treturn ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join("\n")}function Fx(l,e){let t;switch(e){case vr:t="Linear";break;case pi:t="Reinhard";break;case Lr:t="Cineon";break;case ll:t="ACESFilmic";break;case lu:t="AgX";break;case Qo:t="Neutral";break;case uc:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+l+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const mm=new K;function Xf(l){return""!==l}function t_(l,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return l.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function n_(l,e){return l.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Hx=/^[ \t]*#include +<([\w\d./]+)>/gm;function i_(l){return l.replace(Hx,zx)}const vv=new Map;function zx(l,e){let t=$n[e];if(void 0===t){const i=vv.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=$n[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return i_(t)}const Gx=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xv(l){return l.replace(Gx,r_)}function r_(l,e,t,i){let s="";for(let a=parseInt(e);a<parseInt(t);a++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function gm(l){let e=`precision ${l.precision} float;\n\tprecision ${l.precision} int;\n\tprecision ${l.precision} sampler2D;\n\tprecision ${l.precision} samplerCube;\n\tprecision ${l.precision} sampler3D;\n\tprecision ${l.precision} sampler2DArray;\n\tprecision ${l.precision} sampler2DShadow;\n\tprecision ${l.precision} samplerCubeShadow;\n\tprecision ${l.precision} sampler2DArrayShadow;\n\tprecision ${l.precision} isampler2D;\n\tprecision ${l.precision} isampler3D;\n\tprecision ${l.precision} isamplerCube;\n\tprecision ${l.precision} isampler2DArray;\n\tprecision ${l.precision} usampler2D;\n\tprecision ${l.precision} usampler3D;\n\tprecision ${l.precision} usamplerCube;\n\tprecision ${l.precision} usampler2DArray;\n\t`;return"highp"===l.precision?e+="\n#define HIGH_PRECISION":"mediump"===l.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===l.precision&&(e+="\n#define LOW_PRECISION"),e}function jx(l,e,t,i){const s=l.getContext(),a=t.defines;let d=t.vertexShader,m=t.fragmentShader;const y=function Mv(l){let e="SHADOWMAP_TYPE_BASIC";return l.shadowMapType===It?e="SHADOWMAP_TYPE_PCF":l.shadowMapType===Ve?e="SHADOWMAP_TYPE_PCF_SOFT":l.shadowMapType===Le&&(e="SHADOWMAP_TYPE_VSM"),e}(t),v=function s_(l){let e="ENVMAP_TYPE_CUBE";if(l.envMap)switch(l.envMapMode){case Xe:case xt:e="ENVMAP_TYPE_CUBE";break;case xr:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),M=function Wx(l){let e="ENVMAP_MODE_REFLECTION";return l.envMap&&l.envMapMode===xt&&(e="ENVMAP_MODE_REFRACTION"),e}(t),b=function $x(l){let e="ENVMAP_BLENDING_NONE";if(l.envMap)switch(l.combine){case Ui:e="ENVMAP_BLENDING_MULTIPLY";break;case ho:e="ENVMAP_BLENDING_MIX";break;case In:e="ENVMAP_BLENDING_ADD"}return e}(t),E=function o_(l){const e=l.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),C=function Bx(l){return[l.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",l.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Xf).join("\n")}(t),D=function kx(l){const e=[];for(const t in l){const i=l[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(a),O=s.createProgram();let N,A,H=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(N=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(Xf).join("\n"),N.length>0&&(N+="\n"),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(Xf).join("\n"),A.length>0&&(A+="\n")):(N=[gm(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+M:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+y:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Xf).join("\n"),A=[gm(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.envMap?"#define "+M:"",t.envMap?"#define "+b:"",E?"#define CUBEUV_TEXEL_WIDTH "+E.texelWidth:"",E?"#define CUBEUV_TEXEL_HEIGHT "+E.texelHeight:"",E?"#define CUBEUV_MAX_MIP "+E.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+y:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Li?"#define TONE_MAPPING":"",t.toneMapping!==Li?$n.tonemapping_pars_fragment:"",t.toneMapping!==Li?Fx("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",$n.colorspace_pars_fragment,Ox("linearToOutputTexel",t.outputColorSpace),(Kn.getLuminanceCoefficients(mm),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${mm.x.toFixed(4)}, ${mm.y.toFixed(4)}, ${mm.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Xf).join("\n")),d=i_(d),d=t_(d,t),d=n_(d,t),m=i_(m),m=t_(m,t),m=n_(m,t),d=xv(d),m=xv(m),!0!==t.isRawShaderMaterial&&(H="#version 300 es\n",N=[C,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+N,A=["#define varying in",t.glslVersion===gs?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===gs?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+A);const V=H+A+m,Z=Qg(s,s.VERTEX_SHADER,H+N+d),q=Qg(s,s.FRAGMENT_SHADER,V);function ee(se){if(l.debug.checkShaderErrors){const me=s.getProgramInfoLog(O)||"",ve=s.getShaderInfoLog(Z)||"",we=s.getShaderInfoLog(q)||"",Ne=me.trim(),De=ve.trim(),it=we.trim();let Ie=!0,At=!0;if(!1===s.getProgramParameter(O,s.LINK_STATUS))if(Ie=!1,"function"==typeof l.debug.onShaderError)l.debug.onShaderError(s,O,Z,q);else{const zt=e_(s,Z,"vertex"),qt=e_(s,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(O,s.VALIDATE_STATUS)+"\n\nMaterial Name: "+se.name+"\nMaterial Type: "+se.type+"\n\nProgram Info Log: "+Ne+"\n"+zt+"\n"+qt)}else""!==Ne?console.warn("THREE.WebGLProgram: Program Info Log:",Ne):(""===De||""===it)&&(At=!1);At&&(se.diagnostics={runnable:Ie,programLog:Ne,vertexShader:{log:De,prefix:N},fragmentShader:{log:it,prefix:A}})}s.deleteShader(Z),s.deleteShader(q),ne=new jf(s,O),X=function Vx(l,e){const t={},i=l.getProgramParameter(e,l.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const a=l.getActiveAttrib(e,s),d=a.name;let m=1;a.type===l.FLOAT_MAT2&&(m=2),a.type===l.FLOAT_MAT3&&(m=3),a.type===l.FLOAT_MAT4&&(m=4),t[d]={type:a.type,location:l.getAttribLocation(e,d),locationSize:m}}return t}(s,O)}let ne,X;s.attachShader(O,Z),s.attachShader(O,q),void 0!==t.index0AttributeName?s.bindAttribLocation(O,0,t.index0AttributeName):!0===t.morphTargets&&s.bindAttribLocation(O,0,"position"),s.linkProgram(O),this.getUniforms=function(){return void 0===ne&&ee(this),ne},this.getAttributes=function(){return void 0===X&&ee(this),X};let j=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===j&&(j=s.getProgramParameter(O,Rx)),j},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(O),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Px++,this.cacheKey=e,this.usedTimes=1,this.program=O,this.vertexShader=Z,this.fragmentShader=q,this}let bv=0;class Th{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,s=this._getShaderStage(e.vertexShader),a=this._getShaderStage(i),d=this._getShaderCacheForMaterial(e);return!1===d.has(s)&&(d.add(s),s.usedTimes++),!1===d.has(a)&&(d.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new Sv(e),t.set(e,i)),i}}class Sv{constructor(e){this.id=bv++,this.code=e,this.usedTimes=0}}function Xx(l,e,t,i,s,a,d){const m=new Al,y=new Th,v=new Set,M=[],b=s.logarithmicDepthBuffer,E=s.vertexTextures;let C=s.precision;const D={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function O(X){return v.add(X),0===X?"uv":`uv${X}`}return{getParameters:function N(X,j,se,me,ve){const we=me.fog,Ne=ve.geometry,it=(X.isMeshStandardMaterial?t:e).get(X.envMap||(X.isMeshStandardMaterial?me.environment:null)),Ie=it&&it.mapping===xr?it.image.height:null,At=D[X.type];null!==X.precision&&(C=s.getMaxPrecision(X.precision),C!==X.precision&&console.warn("THREE.WebGLProgram.getParameters:",X.precision,"not supported, using",C,"instead."));const zt=Ne.morphAttributes.position||Ne.morphAttributes.normal||Ne.morphAttributes.color,qt=void 0!==zt?zt.length:0;let ui,Ti,di,Ue,Vn=0;if(void 0!==Ne.morphAttributes.position&&(Vn=1),void 0!==Ne.morphAttributes.normal&&(Vn=2),void 0!==Ne.morphAttributes.color&&(Vn=3),At){const Ai=oo[At];ui=Ai.vertexShader,Ti=Ai.fragmentShader}else ui=X.vertexShader,Ti=X.fragmentShader,y.update(X),di=y.getVertexShaderID(X),Ue=y.getFragmentShaderID(X);const Ke=l.getRenderTarget(),nn=l.state.buffers.depth.getReversed(),hn=!0===ve.isInstancedMesh,sn=!0===ve.isBatchedMesh,Jn=!!X.map,re=!!it,Qe=!!X.aoMap,$e=!!X.lightMap,Be=!!X.bumpMap,ke=!!X.normalMap,Et=!!X.displacementMap,ct=!!X.emissiveMap,bt=!!X.metalnessMap,Hn=!!X.roughnessMap,On=X.anisotropy>0,Q=X.clearcoat>0,ge=X.iridescence>0,Te=X.sheen>0,tt=X.transmission>0,Re=On&&!!X.anisotropyMap,en=Q&&!!X.clearcoatMap,yt=Q&&!!X.clearcoatNormalMap,rn=Q&&!!X.clearcoatRoughnessMap,Zt=ge&&!!X.iridescenceMap,lt=ge&&!!X.iridescenceThicknessMap,Vt=Te&&!!X.sheenColorMap,Dn=Te&&!!X.sheenRoughnessMap,an=!!X.specularMap,Ot=!!X.specularColorMap,Gn=!!X.specularIntensityMap,ue=tt&&!!X.transmissionMap,ft=tt&&!!X.thicknessMap,Kt=!!X.alphaMap,ln=!!X.extensions;let zn=Li;X.toneMapped&&(null===Ke||!0===Ke.isXRRenderTarget)&&(zn=l.toneMapping);const Yi={shaderID:At,shaderType:X.type,shaderName:X.name,vertexShader:ui,fragmentShader:Ti,defines:X.defines,customVertexShaderID:di,customFragmentShaderID:Ue,isRawShaderMaterial:!0===X.isRawShaderMaterial,glslVersion:X.glslVersion,precision:C,batching:sn,batchingColor:sn&&null!==ve._colorsTexture,instancing:hn,instancingColor:hn&&null!==ve.instanceColor,instancingMorph:hn&&null!==ve.morphTexture,supportsVertexTextures:E,outputColorSpace:null===Ke?l.outputColorSpace:!0===Ke.isXRRenderTarget?Ke.texture.colorSpace:As,alphaToCoverage:!!X.alphaToCoverage,map:Jn,matcap:!!X.matcap,envMap:re,envMapMode:re&&it.mapping,envMapCubeUVHeight:Ie,aoMap:Qe,lightMap:$e,bumpMap:Be,normalMap:ke,displacementMap:E&&Et,emissiveMap:ct,normalMapObjectSpace:ke&&X.normalMapType===Fa,normalMapTangentSpace:ke&&X.normalMapType===Ts,metalnessMap:bt,roughnessMap:Hn,anisotropy:On,anisotropyMap:Re,clearcoat:Q,clearcoatMap:en,clearcoatNormalMap:yt,clearcoatRoughnessMap:rn,dispersion:X.dispersion>0,iridescence:ge,iridescenceMap:Zt,iridescenceThicknessMap:lt,sheen:Te,sheenColorMap:Vt,sheenRoughnessMap:Dn,specularMap:an,specularColorMap:Ot,specularIntensityMap:Gn,transmission:tt,transmissionMap:ue,thicknessMap:ft,gradientMap:!!X.gradientMap,opaque:!1===X.transparent&&X.blending===Xt&&!1===X.alphaToCoverage,alphaMap:Kt,alphaTest:X.alphaTest>0,alphaHash:!!X.alphaHash,combine:X.combine,mapUv:Jn&&O(X.map.channel),aoMapUv:Qe&&O(X.aoMap.channel),lightMapUv:$e&&O(X.lightMap.channel),bumpMapUv:Be&&O(X.bumpMap.channel),normalMapUv:ke&&O(X.normalMap.channel),displacementMapUv:Et&&O(X.displacementMap.channel),emissiveMapUv:ct&&O(X.emissiveMap.channel),metalnessMapUv:bt&&O(X.metalnessMap.channel),roughnessMapUv:Hn&&O(X.roughnessMap.channel),anisotropyMapUv:Re&&O(X.anisotropyMap.channel),clearcoatMapUv:en&&O(X.clearcoatMap.channel),clearcoatNormalMapUv:yt&&O(X.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:rn&&O(X.clearcoatRoughnessMap.channel),iridescenceMapUv:Zt&&O(X.iridescenceMap.channel),iridescenceThicknessMapUv:lt&&O(X.iridescenceThicknessMap.channel),sheenColorMapUv:Vt&&O(X.sheenColorMap.channel),sheenRoughnessMapUv:Dn&&O(X.sheenRoughnessMap.channel),specularMapUv:an&&O(X.specularMap.channel),specularColorMapUv:Ot&&O(X.specularColorMap.channel),specularIntensityMapUv:Gn&&O(X.specularIntensityMap.channel),transmissionMapUv:ue&&O(X.transmissionMap.channel),thicknessMapUv:ft&&O(X.thicknessMap.channel),alphaMapUv:Kt&&O(X.alphaMap.channel),vertexTangents:!!Ne.attributes.tangent&&(ke||On),vertexColors:X.vertexColors,vertexAlphas:!0===X.vertexColors&&!!Ne.attributes.color&&4===Ne.attributes.color.itemSize,pointsUvs:!0===ve.isPoints&&!!Ne.attributes.uv&&(Jn||Kt),fog:!!we,useFog:!0===X.fog,fogExp2:!!we&&we.isFogExp2,flatShading:!0===X.flatShading&&!1===X.wireframe,sizeAttenuation:!0===X.sizeAttenuation,logarithmicDepthBuffer:b,reversedDepthBuffer:nn,skinning:!0===ve.isSkinnedMesh,morphTargets:void 0!==Ne.morphAttributes.position,morphNormals:void 0!==Ne.morphAttributes.normal,morphColors:void 0!==Ne.morphAttributes.color,morphTargetsCount:qt,morphTextureStride:Vn,numDirLights:j.directional.length,numPointLights:j.point.length,numSpotLights:j.spot.length,numSpotLightMaps:j.spotLightMap.length,numRectAreaLights:j.rectArea.length,numHemiLights:j.hemi.length,numDirLightShadows:j.directionalShadowMap.length,numPointLightShadows:j.pointShadowMap.length,numSpotLightShadows:j.spotShadowMap.length,numSpotLightShadowsWithMaps:j.numSpotLightShadowsWithMaps,numLightProbes:j.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:X.dithering,shadowMapEnabled:l.shadowMap.enabled&&se.length>0,shadowMapType:l.shadowMap.type,toneMapping:zn,decodeVideoTexture:Jn&&!0===X.map.isVideoTexture&&Kn.getTransfer(X.map.colorSpace)===ci,decodeVideoTextureEmissive:ct&&!0===X.emissiveMap.isVideoTexture&&Kn.getTransfer(X.emissiveMap.colorSpace)===ci,premultipliedAlpha:X.premultipliedAlpha,doubleSided:X.side===nt,flipSided:X.side===fn,useDepthPacking:X.depthPacking>=0,depthPacking:X.depthPacking||0,index0AttributeName:X.index0AttributeName,extensionClipCullDistance:ln&&!0===X.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ln&&!0===X.extensions.multiDraw||sn)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:X.customProgramCacheKey()};return Yi.vertexUv1s=v.has(1),Yi.vertexUv2s=v.has(2),Yi.vertexUv3s=v.has(3),v.clear(),Yi},getProgramCacheKey:function A(X){const j=[];if(X.shaderID?j.push(X.shaderID):(j.push(X.customVertexShaderID),j.push(X.customFragmentShaderID)),void 0!==X.defines)for(const se in X.defines)j.push(se),j.push(X.defines[se]);return!1===X.isRawShaderMaterial&&(function H(X,j){X.push(j.precision),X.push(j.outputColorSpace),X.push(j.envMapMode),X.push(j.envMapCubeUVHeight),X.push(j.mapUv),X.push(j.alphaMapUv),X.push(j.lightMapUv),X.push(j.aoMapUv),X.push(j.bumpMapUv),X.push(j.normalMapUv),X.push(j.displacementMapUv),X.push(j.emissiveMapUv),X.push(j.metalnessMapUv),X.push(j.roughnessMapUv),X.push(j.anisotropyMapUv),X.push(j.clearcoatMapUv),X.push(j.clearcoatNormalMapUv),X.push(j.clearcoatRoughnessMapUv),X.push(j.iridescenceMapUv),X.push(j.iridescenceThicknessMapUv),X.push(j.sheenColorMapUv),X.push(j.sheenRoughnessMapUv),X.push(j.specularMapUv),X.push(j.specularColorMapUv),X.push(j.specularIntensityMapUv),X.push(j.transmissionMapUv),X.push(j.thicknessMapUv),X.push(j.combine),X.push(j.fogExp2),X.push(j.sizeAttenuation),X.push(j.morphTargetsCount),X.push(j.morphAttributeCount),X.push(j.numDirLights),X.push(j.numPointLights),X.push(j.numSpotLights),X.push(j.numSpotLightMaps),X.push(j.numHemiLights),X.push(j.numRectAreaLights),X.push(j.numDirLightShadows),X.push(j.numPointLightShadows),X.push(j.numSpotLightShadows),X.push(j.numSpotLightShadowsWithMaps),X.push(j.numLightProbes),X.push(j.shadowMapType),X.push(j.toneMapping),X.push(j.numClippingPlanes),X.push(j.numClipIntersection),X.push(j.depthPacking)}(j,X),function k(X,j){m.disableAll(),j.supportsVertexTextures&&m.enable(0),j.instancing&&m.enable(1),j.instancingColor&&m.enable(2),j.instancingMorph&&m.enable(3),j.matcap&&m.enable(4),j.envMap&&m.enable(5),j.normalMapObjectSpace&&m.enable(6),j.normalMapTangentSpace&&m.enable(7),j.clearcoat&&m.enable(8),j.iridescence&&m.enable(9),j.alphaTest&&m.enable(10),j.vertexColors&&m.enable(11),j.vertexAlphas&&m.enable(12),j.vertexUv1s&&m.enable(13),j.vertexUv2s&&m.enable(14),j.vertexUv3s&&m.enable(15),j.vertexTangents&&m.enable(16),j.anisotropy&&m.enable(17),j.alphaHash&&m.enable(18),j.batching&&m.enable(19),j.dispersion&&m.enable(20),j.batchingColor&&m.enable(21),j.gradientMap&&m.enable(22),X.push(m.mask),m.disableAll(),j.fog&&m.enable(0),j.useFog&&m.enable(1),j.flatShading&&m.enable(2),j.logarithmicDepthBuffer&&m.enable(3),j.reversedDepthBuffer&&m.enable(4),j.skinning&&m.enable(5),j.morphTargets&&m.enable(6),j.morphNormals&&m.enable(7),j.morphColors&&m.enable(8),j.premultipliedAlpha&&m.enable(9),j.shadowMapEnabled&&m.enable(10),j.doubleSided&&m.enable(11),j.flipSided&&m.enable(12),j.useDepthPacking&&m.enable(13),j.dithering&&m.enable(14),j.transmission&&m.enable(15),j.sheen&&m.enable(16),j.opaque&&m.enable(17),j.pointsUvs&&m.enable(18),j.decodeVideoTexture&&m.enable(19),j.decodeVideoTextureEmissive&&m.enable(20),j.alphaToCoverage&&m.enable(21),X.push(m.mask)}(j,X),j.push(l.outputColorSpace)),j.push(X.customProgramCacheKey),j.join()},getUniforms:function V(X){const j=D[X.type];let se;return se=j?Od.clone(oo[j].uniforms):X.uniforms,se},acquireProgram:function Z(X,j){let se;for(let me=0,ve=M.length;me<ve;me++){const we=M[me];if(we.cacheKey===j){se=we,++se.usedTimes;break}}return void 0===se&&(se=new jx(l,j,X,a),M.push(se)),se},releaseProgram:function q(X){if(0==--X.usedTimes){const j=M.indexOf(X);M[j]=M[M.length-1],M.pop(),X.destroy()}},releaseShaderCache:function ee(X){y.remove(X)},programs:M,dispose:function ne(){y.dispose()}}}function Rb(){let l=new WeakMap;return{has:function e(d){return l.has(d)},get:function t(d){let m=l.get(d);return void 0===m&&(m={},l.set(d,m)),m},remove:function i(d){l.delete(d)},update:function s(d,m,y){l.get(d)[m]=y},dispose:function a(){l=new WeakMap}}}function Ev(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.material.id!==e.material.id?l.material.id-e.material.id:l.z!==e.z?l.z-e.z:l.id-e.id}function _m(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.z!==e.z?e.z-l.z:l.id-e.id}function wv(){const l=[];let e=0;const t=[],i=[],s=[];function d(b,E,C,D,O,N){let A=l[e];return void 0===A?(A={id:b.id,object:b,geometry:E,material:C,groupOrder:D,renderOrder:b.renderOrder,z:O,group:N},l[e]=A):(A.id=b.id,A.object=b,A.geometry=E,A.material=C,A.groupOrder=D,A.renderOrder=b.renderOrder,A.z=O,A.group=N),e++,A}return{opaque:t,transmissive:i,transparent:s,init:function a(){e=0,t.length=0,i.length=0,s.length=0},push:function m(b,E,C,D,O,N){const A=d(b,E,C,D,O,N);C.transmission>0?i.push(A):!0===C.transparent?s.push(A):t.push(A)},unshift:function y(b,E,C,D,O,N){const A=d(b,E,C,D,O,N);C.transmission>0?i.unshift(A):!0===C.transparent?s.unshift(A):t.unshift(A)},finish:function M(){for(let b=e,E=l.length;b<E;b++){const C=l[b];if(null===C.id)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}},sort:function v(b,E){t.length>1&&t.sort(b||Ev),i.length>1&&i.sort(E||_m),s.length>1&&s.sort(E||_m)}}}function a_(){let l=new WeakMap;return{get:function e(i,s){const a=l.get(i);let d;return void 0===a?(d=new wv,l.set(i,[d])):s>=a.length?(d=new wv,a.push(d)):d=a[s],d},dispose:function t(){l=new WeakMap}}}function Yx(){const l={};return{get:function(e){if(void 0!==l[e.id])return l[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new K,color:new Nt};break;case"SpotLight":t={position:new K,direction:new K,color:new Nt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new K,color:new Nt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new K,skyColor:new Nt,groundColor:new Nt};break;case"RectAreaLight":t={color:new Nt,position:new K,halfWidth:new K,halfHeight:new K}}return l[e.id]=t,t}}}let l_=0;function Tv(l,e){return(e.castShadow?2:0)-(l.castShadow?2:0)+(e.map?1:0)-(l.map?1:0)}function Av(l){const e=new Yx,t=function Cv(){const l={};return{get:function(e){if(void 0!==l[e.id])return l[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ce};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ce,shadowCameraNear:1,shadowCameraFar:1e3}}return l[e.id]=t,t}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let v=0;v<9;v++)i.probe.push(new K);const s=new K,a=new yn,d=new yn;return{setup:function m(v){let M=0,b=0,E=0;for(let X=0;X<9;X++)i.probe[X].set(0,0,0);let C=0,D=0,O=0,N=0,A=0,H=0,k=0,V=0,Z=0,q=0,ee=0;v.sort(Tv);for(let X=0,j=v.length;X<j;X++){const se=v[X],me=se.color,ve=se.intensity,we=se.distance,Ne=se.shadow&&se.shadow.map?se.shadow.map.texture:null;if(se.isAmbientLight)M+=me.r*ve,b+=me.g*ve,E+=me.b*ve;else if(se.isLightProbe){for(let De=0;De<9;De++)i.probe[De].addScaledVector(se.sh.coefficients[De],ve);ee++}else if(se.isDirectionalLight){const De=e.get(se);if(De.color.copy(se.color).multiplyScalar(se.intensity),se.castShadow){const it=se.shadow,Ie=t.get(se);Ie.shadowIntensity=it.intensity,Ie.shadowBias=it.bias,Ie.shadowNormalBias=it.normalBias,Ie.shadowRadius=it.radius,Ie.shadowMapSize=it.mapSize,i.directionalShadow[C]=Ie,i.directionalShadowMap[C]=Ne,i.directionalShadowMatrix[C]=se.shadow.matrix,H++}i.directional[C]=De,C++}else if(se.isSpotLight){const De=e.get(se);De.position.setFromMatrixPosition(se.matrixWorld),De.color.copy(me).multiplyScalar(ve),De.distance=we,De.coneCos=Math.cos(se.angle),De.penumbraCos=Math.cos(se.angle*(1-se.penumbra)),De.decay=se.decay,i.spot[O]=De;const it=se.shadow;if(se.map&&(i.spotLightMap[Z]=se.map,Z++,it.updateMatrices(se),se.castShadow&&q++),i.spotLightMatrix[O]=it.matrix,se.castShadow){const Ie=t.get(se);Ie.shadowIntensity=it.intensity,Ie.shadowBias=it.bias,Ie.shadowNormalBias=it.normalBias,Ie.shadowRadius=it.radius,Ie.shadowMapSize=it.mapSize,i.spotShadow[O]=Ie,i.spotShadowMap[O]=Ne,V++}O++}else if(se.isRectAreaLight){const De=e.get(se);De.color.copy(me).multiplyScalar(ve),De.halfWidth.set(.5*se.width,0,0),De.halfHeight.set(0,.5*se.height,0),i.rectArea[N]=De,N++}else if(se.isPointLight){const De=e.get(se);if(De.color.copy(se.color).multiplyScalar(se.intensity),De.distance=se.distance,De.decay=se.decay,se.castShadow){const it=se.shadow,Ie=t.get(se);Ie.shadowIntensity=it.intensity,Ie.shadowBias=it.bias,Ie.shadowNormalBias=it.normalBias,Ie.shadowRadius=it.radius,Ie.shadowMapSize=it.mapSize,Ie.shadowCameraNear=it.camera.near,Ie.shadowCameraFar=it.camera.far,i.pointShadow[D]=Ie,i.pointShadowMap[D]=Ne,i.pointShadowMatrix[D]=se.shadow.matrix,k++}i.point[D]=De,D++}else if(se.isHemisphereLight){const De=e.get(se);De.skyColor.copy(se.color).multiplyScalar(ve),De.groundColor.copy(se.groundColor).multiplyScalar(ve),i.hemi[A]=De,A++}}N>0&&(!0===l.has("OES_texture_float_linear")?(i.rectAreaLTC1=Tt.LTC_FLOAT_1,i.rectAreaLTC2=Tt.LTC_FLOAT_2):(i.rectAreaLTC1=Tt.LTC_HALF_1,i.rectAreaLTC2=Tt.LTC_HALF_2)),i.ambient[0]=M,i.ambient[1]=b,i.ambient[2]=E;const ne=i.hash;(ne.directionalLength!==C||ne.pointLength!==D||ne.spotLength!==O||ne.rectAreaLength!==N||ne.hemiLength!==A||ne.numDirectionalShadows!==H||ne.numPointShadows!==k||ne.numSpotShadows!==V||ne.numSpotMaps!==Z||ne.numLightProbes!==ee)&&(i.directional.length=C,i.spot.length=O,i.rectArea.length=N,i.point.length=D,i.hemi.length=A,i.directionalShadow.length=H,i.directionalShadowMap.length=H,i.pointShadow.length=k,i.pointShadowMap.length=k,i.spotShadow.length=V,i.spotShadowMap.length=V,i.directionalShadowMatrix.length=H,i.pointShadowMatrix.length=k,i.spotLightMatrix.length=V+Z-q,i.spotLightMap.length=Z,i.numSpotLightShadowsWithMaps=q,i.numLightProbes=ee,ne.directionalLength=C,ne.pointLength=D,ne.spotLength=O,ne.rectAreaLength=N,ne.hemiLength=A,ne.numDirectionalShadows=H,ne.numPointShadows=k,ne.numSpotShadows=V,ne.numSpotMaps=Z,ne.numLightProbes=ee,i.version=l_++)},setupView:function y(v,M){let b=0,E=0,C=0,D=0,O=0;const N=M.matrixWorldInverse;for(let A=0,H=v.length;A<H;A++){const k=v[A];if(k.isDirectionalLight){const V=i.directional[b];V.direction.setFromMatrixPosition(k.matrixWorld),s.setFromMatrixPosition(k.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(N),b++}else if(k.isSpotLight){const V=i.spot[C];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(N),V.direction.setFromMatrixPosition(k.matrixWorld),s.setFromMatrixPosition(k.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(N),C++}else if(k.isRectAreaLight){const V=i.rectArea[D];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(N),d.identity(),a.copy(k.matrixWorld),a.premultiply(N),d.extractRotation(a),V.halfWidth.set(.5*k.width,0,0),V.halfHeight.set(0,.5*k.height,0),V.halfWidth.applyMatrix4(d),V.halfHeight.applyMatrix4(d),D++}else if(k.isPointLight){const V=i.point[E];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(N),E++}else if(k.isHemisphereLight){const V=i.hemi[O];V.direction.setFromMatrixPosition(k.matrixWorld),V.direction.transformDirection(N),O++}}},state:i}}function c_(l){const e=new Av(l),t=[],i=[],v={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function s(M){v.camera=M,t.length=0,i.length=0},state:v,setupLights:function m(){e.setup(t)},setupLightsView:function y(M){e.setupView(t,M)},pushLight:function a(M){t.push(M)},pushShadow:function d(M){i.push(M)}}}function Dv(l){let e=new WeakMap;return{get:function t(s,a=0){const d=e.get(s);let m;return void 0===d?(m=new c_(l),e.set(s,[m])):a>=d.length?(m=new c_(l),d.push(m)):m=d[a],m},dispose:function i(){e=new WeakMap}}}const qx="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",Zx="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function Kx(l,e,t){let i=new kl;const s=new Ce,a=new Ce,d=new G,m=new Np({depthPacking:ms}),y=new Rf,v={},M=t.maxTextureSize,b={[pt]:fn,[fn]:pt,[nt]:nt},E=new io({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ce},radius:{value:4}},vertexShader:qx,fragmentShader:Zx}),C=E.clone();C.defines.HORIZONTAL_PASS=1;const D=new An;D.setAttribute("position",new Tr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const O=new kr(D,E),N=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=It;let A=this.type;function H(q,ee){const ne=e.update(O);E.defines.VSM_SAMPLES!==q.blurSamples&&(E.defines.VSM_SAMPLES=q.blurSamples,C.defines.VSM_SAMPLES=q.blurSamples,E.needsUpdate=!0,C.needsUpdate=!0),null===q.mapPass&&(q.mapPass=new _e(s.x,s.y)),E.uniforms.shadow_pass.value=q.map.texture,E.uniforms.resolution.value=q.mapSize,E.uniforms.radius.value=q.radius,l.setRenderTarget(q.mapPass),l.clear(),l.renderBufferDirect(ee,null,ne,E,O,null),C.uniforms.shadow_pass.value=q.mapPass.texture,C.uniforms.resolution.value=q.mapSize,C.uniforms.radius.value=q.radius,l.setRenderTarget(q.map),l.clear(),l.renderBufferDirect(ee,null,ne,C,O,null)}function k(q,ee,ne,X){let j=null;const se=!0===ne.isPointLight?q.customDistanceMaterial:q.customDepthMaterial;if(void 0!==se)j=se;else if(j=!0===ne.isPointLight?y:m,l.localClippingEnabled&&!0===ee.clipShadows&&Array.isArray(ee.clippingPlanes)&&0!==ee.clippingPlanes.length||ee.displacementMap&&0!==ee.displacementScale||ee.alphaMap&&ee.alphaTest>0||ee.map&&ee.alphaTest>0||!0===ee.alphaToCoverage){const me=j.uuid,ve=ee.uuid;let we=v[me];void 0===we&&(we={},v[me]=we);let Ne=we[ve];void 0===Ne&&(Ne=j.clone(),we[ve]=Ne,ee.addEventListener("dispose",Z)),j=Ne}return j.visible=ee.visible,j.wireframe=ee.wireframe,j.side=X===Le?null!==ee.shadowSide?ee.shadowSide:ee.side:null!==ee.shadowSide?ee.shadowSide:b[ee.side],j.alphaMap=ee.alphaMap,j.alphaTest=!0===ee.alphaToCoverage?.5:ee.alphaTest,j.map=ee.map,j.clipShadows=ee.clipShadows,j.clippingPlanes=ee.clippingPlanes,j.clipIntersection=ee.clipIntersection,j.displacementMap=ee.displacementMap,j.displacementScale=ee.displacementScale,j.displacementBias=ee.displacementBias,j.wireframeLinewidth=ee.wireframeLinewidth,j.linewidth=ee.linewidth,!0===ne.isPointLight&&!0===j.isMeshDistanceMaterial&&(l.properties.get(j).light=ne),j}function V(q,ee,ne,X,j){if(!1===q.visible)return;if(q.layers.test(ee.layers)&&(q.isMesh||q.isLine||q.isPoints)&&(q.castShadow||q.receiveShadow&&j===Le)&&(!q.frustumCulled||i.intersectsObject(q))){q.modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,q.matrixWorld);const ve=e.update(q),we=q.material;if(Array.isArray(we)){const Ne=ve.groups;for(let De=0,it=Ne.length;De<it;De++){const Ie=Ne[De],At=we[Ie.materialIndex];if(At&&At.visible){const zt=k(q,At,X,j);q.onBeforeShadow(l,q,ee,ne,ve,zt,Ie),l.renderBufferDirect(ne,null,ve,zt,q,Ie),q.onAfterShadow(l,q,ee,ne,ve,zt,Ie)}}}else if(we.visible){const Ne=k(q,we,X,j);q.onBeforeShadow(l,q,ee,ne,ve,Ne,null),l.renderBufferDirect(ne,null,ve,Ne,q,null),q.onAfterShadow(l,q,ee,ne,ve,Ne,null)}}const me=q.children;for(let ve=0,we=me.length;ve<we;ve++)V(me[ve],ee,ne,X,j)}function Z(q){q.target.removeEventListener("dispose",Z);for(const ne in v){const X=v[ne],j=q.target.uuid;j in X&&(X[j].dispose(),delete X[j])}}this.render=function(q,ee,ne){if(!1===N.enabled||!1===N.autoUpdate&&!1===N.needsUpdate||0===q.length)return;const X=l.getRenderTarget(),j=l.getActiveCubeFace(),se=l.getActiveMipmapLevel(),me=l.state;me.setBlending(Qt),!0===me.buffers.depth.getReversed()?me.buffers.color.setClear(0,0,0,0):me.buffers.color.setClear(1,1,1,1),me.buffers.depth.setTest(!0),me.setScissorTest(!1);const ve=A!==Le&&this.type===Le,we=A===Le&&this.type!==Le;for(let Ne=0,De=q.length;Ne<De;Ne++){const it=q[Ne],Ie=it.shadow;if(void 0===Ie){console.warn("THREE.WebGLShadowMap:",it,"has no shadow.");continue}if(!1===Ie.autoUpdate&&!1===Ie.needsUpdate)continue;s.copy(Ie.mapSize);const At=Ie.getFrameExtents();if(s.multiply(At),a.copy(Ie.mapSize),(s.x>M||s.y>M)&&(s.x>M&&(a.x=Math.floor(M/At.x),s.x=a.x*At.x,Ie.mapSize.x=a.x),s.y>M&&(a.y=Math.floor(M/At.y),s.y=a.y*At.y,Ie.mapSize.y=a.y)),null===Ie.map||!0===ve||!0===we){const qt=this.type!==Le?{minFilter:qn,magFilter:qn}:{};null!==Ie.map&&Ie.map.dispose(),Ie.map=new _e(s.x,s.y,qt),Ie.map.texture.name=it.name+".shadowMap",Ie.camera.updateProjectionMatrix()}l.setRenderTarget(Ie.map),l.clear();const zt=Ie.getViewportCount();for(let qt=0;qt<zt;qt++){const Vn=Ie.getViewport(qt);d.set(a.x*Vn.x,a.y*Vn.y,a.x*Vn.z,a.y*Vn.w),me.viewport(d),Ie.updateMatrices(it,qt),i=Ie.getFrustum(),V(ee,ne,Ie.camera,it,this.type)}!0!==Ie.isPointLightShadow&&this.type===Le&&H(Ie,ne),Ie.needsUpdate=!1}A=this.type,N.needsUpdate=!1,l.setRenderTarget(X,j,se)}}const Jx={[Ee]:et,[je]:Mt,[hi]:Ii,[Wt]:fi,[et]:Ee,[Mt]:je,[Ii]:hi,[fi]:Wt};function Iv(l,e){const a=new function t(){let ue=!1;const ft=new G;let Dt=null;const Kt=new G(0,0,0,0);return{setMask:function(ot){Dt!==ot&&!ue&&(l.colorMask(ot,ot,ot,ot),Dt=ot)},setLocked:function(ot){ue=ot},setClear:function(ot,Ye,ln,zn,Yi){!0===Yi&&(ot*=zn,Ye*=zn,ln*=zn),ft.set(ot,Ye,ln,zn),!1===Kt.equals(ft)&&(l.clearColor(ot,Ye,ln,zn),Kt.copy(ft))},reset:function(){ue=!1,Dt=null,Kt.set(-1,0,0,0)}}},d=new function i(){let ue=!1,ft=!1,Dt=null,Kt=null,ot=null;return{setReversed:function(Ye){if(ft!==Ye){const ln=e.get("EXT_clip_control");ln.clipControlEXT(ln.LOWER_LEFT_EXT,Ye?ln.ZERO_TO_ONE_EXT:ln.NEGATIVE_ONE_TO_ONE_EXT),ft=Ye;const zn=ot;ot=null,this.setClear(zn)}},getReversed:function(){return ft},setTest:function(Ye){Ye?Ke(l.DEPTH_TEST):nn(l.DEPTH_TEST)},setMask:function(Ye){Dt!==Ye&&!ue&&(l.depthMask(Ye),Dt=Ye)},setFunc:function(Ye){if(ft&&(Ye=Jx[Ye]),Kt!==Ye){switch(Ye){case Ee:l.depthFunc(l.NEVER);break;case et:l.depthFunc(l.ALWAYS);break;case je:l.depthFunc(l.LESS);break;case Wt:l.depthFunc(l.LEQUAL);break;case hi:l.depthFunc(l.EQUAL);break;case fi:l.depthFunc(l.GEQUAL);break;case Mt:l.depthFunc(l.GREATER);break;case Ii:l.depthFunc(l.NOTEQUAL);break;default:l.depthFunc(l.LEQUAL)}Kt=Ye}},setLocked:function(Ye){ue=Ye},setClear:function(Ye){ot!==Ye&&(ft&&(Ye=1-Ye),l.clearDepth(Ye),ot=Ye)},reset:function(){ue=!1,Dt=null,Kt=null,ot=null,ft=!1}}},m=new function s(){let ue=!1,ft=null,Dt=null,Kt=null,ot=null,Ye=null,ln=null,zn=null,Yi=null;return{setTest:function(Ai){ue||(Ai?Ke(l.STENCIL_TEST):nn(l.STENCIL_TEST))},setMask:function(Ai){ft!==Ai&&!ue&&(l.stencilMask(Ai),ft=Ai)},setFunc:function(Ai,lc,al){(Dt!==Ai||Kt!==lc||ot!==al)&&(l.stencilFunc(Ai,lc,al),Dt=Ai,Kt=lc,ot=al)},setOp:function(Ai,lc,al){(Ye!==Ai||ln!==lc||zn!==al)&&(l.stencilOp(Ai,lc,al),Ye=Ai,ln=lc,zn=al)},setLocked:function(Ai){ue=Ai},setClear:function(Ai){Yi!==Ai&&(l.clearStencil(Ai),Yi=Ai)},reset:function(){ue=!1,ft=null,Dt=null,Kt=null,ot=null,Ye=null,ln=null,zn=null,Yi=null}}},y=new WeakMap,v=new WeakMap;let M={},b={},E=new WeakMap,C=[],D=null,O=!1,N=null,A=null,H=null,k=null,V=null,Z=null,q=null,ee=new Nt(0,0,0),ne=0,X=!1,j=null,se=null,me=null,ve=null,we=null;const Ne=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let De=!1,it=0;const Ie=l.getParameter(l.VERSION);-1!==Ie.indexOf("WebGL")?(it=parseFloat(/^WebGL (\d)/.exec(Ie)[1]),De=it>=1):-1!==Ie.indexOf("OpenGL ES")&&(it=parseFloat(/^OpenGL ES (\d)/.exec(Ie)[1]),De=it>=2);let At=null,zt={};const qt=l.getParameter(l.SCISSOR_BOX),Vn=l.getParameter(l.VIEWPORT),ui=(new G).fromArray(qt),Ti=(new G).fromArray(Vn);function di(ue,ft,Dt,Kt){const ot=new Uint8Array(4),Ye=l.createTexture();l.bindTexture(ue,Ye),l.texParameteri(ue,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(ue,l.TEXTURE_MAG_FILTER,l.NEAREST);for(let ln=0;ln<Dt;ln++)ue===l.TEXTURE_3D||ue===l.TEXTURE_2D_ARRAY?l.texImage3D(ft,0,l.RGBA,1,1,Kt,0,l.RGBA,l.UNSIGNED_BYTE,ot):l.texImage2D(ft+ln,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,ot);return Ye}const Ue={};function Ke(ue){!0!==M[ue]&&(l.enable(ue),M[ue]=!0)}function nn(ue){!1!==M[ue]&&(l.disable(ue),M[ue]=!1)}Ue[l.TEXTURE_2D]=di(l.TEXTURE_2D,l.TEXTURE_2D,1),Ue[l.TEXTURE_CUBE_MAP]=di(l.TEXTURE_CUBE_MAP,l.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ue[l.TEXTURE_2D_ARRAY]=di(l.TEXTURE_2D_ARRAY,l.TEXTURE_2D_ARRAY,1,1),Ue[l.TEXTURE_3D]=di(l.TEXTURE_3D,l.TEXTURE_3D,1,1),a.setClear(0,0,0,1),d.setClear(1),m.setClear(0),Ke(l.DEPTH_TEST),d.setFunc(Wt),Be(!1),ke(qe),Ke(l.CULL_FACE),Qe(Qt);const Fi={[wt]:l.FUNC_ADD,[dt]:l.FUNC_SUBTRACT,[pn]:l.FUNC_REVERSE_SUBTRACT};Fi[ti]=l.MIN,Fi[He]=l.MAX;const re={[St]:l.ZERO,[Fe]:l.ONE,[gt]:l.SRC_COLOR,[jn]:l.SRC_ALPHA,[cc]:l.SRC_ALPHA_SATURATE,[Da]:l.DST_COLOR,[Os]:l.DST_ALPHA,[un]:l.ONE_MINUS_SRC_COLOR,[$t]:l.ONE_MINUS_SRC_ALPHA,[Ia]:l.ONE_MINUS_DST_COLOR,[ur]:l.ONE_MINUS_DST_ALPHA,[cs]:l.CONSTANT_COLOR,[ye]:l.ONE_MINUS_CONSTANT_COLOR,[be]:l.CONSTANT_ALPHA,[Se]:l.ONE_MINUS_CONSTANT_ALPHA};function Qe(ue,ft,Dt,Kt,ot,Ye,ln,zn,Yi,Ai){if(ue!==Qt){if(!1===O&&(Ke(l.BLEND),O=!0),ue===kt)ot=ot||ft,Ye=Ye||Dt,ln=ln||Kt,(ft!==A||ot!==V)&&(l.blendEquationSeparate(Fi[ft],Fi[ot]),A=ft,V=ot),(Dt!==H||Kt!==k||Ye!==Z||ln!==q)&&(l.blendFuncSeparate(re[Dt],re[Kt],re[Ye],re[ln]),H=Dt,k=Kt,Z=Ye,q=ln),(!1===zn.equals(ee)||Yi!==ne)&&(l.blendColor(zn.r,zn.g,zn.b,Yi),ee.copy(zn),ne=Yi),N=ue,X=!1;else if(ue!==N||Ai!==X){if((A!==wt||V!==wt)&&(l.blendEquation(l.FUNC_ADD),A=wt,V=wt),Ai)switch(ue){case Xt:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case Nn:l.blendFunc(l.ONE,l.ONE);break;case Pn:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case Di:l.blendFuncSeparate(l.DST_COLOR,l.ONE_MINUS_SRC_ALPHA,l.ZERO,l.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue)}else switch(ue){case Xt:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case Nn:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE,l.ONE,l.ONE);break;case Pn:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Di:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",ue)}H=null,k=null,Z=null,q=null,ee.set(0,0,0),ne=0,N=ue,X=Ai}}else!0===O&&(nn(l.BLEND),O=!1)}function Be(ue){j!==ue&&(l.frontFace(ue?l.CW:l.CCW),j=ue)}function ke(ue){ue!==at?(Ke(l.CULL_FACE),ue!==se&&l.cullFace(ue===qe?l.BACK:ue===Ft?l.FRONT:l.FRONT_AND_BACK)):nn(l.CULL_FACE),se=ue}function ct(ue,ft,Dt){ue?(Ke(l.POLYGON_OFFSET_FILL),(ve!==ft||we!==Dt)&&(l.polygonOffset(ft,Dt),ve=ft,we=Dt)):nn(l.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:d,stencil:m},enable:Ke,disable:nn,bindFramebuffer:function hn(ue,ft){return b[ue]!==ft&&(l.bindFramebuffer(ue,ft),b[ue]=ft,ue===l.DRAW_FRAMEBUFFER&&(b[l.FRAMEBUFFER]=ft),ue===l.FRAMEBUFFER&&(b[l.DRAW_FRAMEBUFFER]=ft),!0)},drawBuffers:function sn(ue,ft){let Dt=C,Kt=!1;if(ue){Dt=E.get(ft),void 0===Dt&&(Dt=[],E.set(ft,Dt));const ot=ue.textures;if(Dt.length!==ot.length||Dt[0]!==l.COLOR_ATTACHMENT0){for(let Ye=0,ln=ot.length;Ye<ln;Ye++)Dt[Ye]=l.COLOR_ATTACHMENT0+Ye;Dt.length=ot.length,Kt=!0}}else Dt[0]!==l.BACK&&(Dt[0]=l.BACK,Kt=!0);Kt&&l.drawBuffers(Dt)},useProgram:function Jn(ue){return D!==ue&&(l.useProgram(ue),D=ue,!0)},setBlending:Qe,setMaterial:function $e(ue,ft){ue.side===nt?nn(l.CULL_FACE):Ke(l.CULL_FACE);let Dt=ue.side===fn;ft&&(Dt=!Dt),Be(Dt),ue.blending===Xt&&!1===ue.transparent?Qe(Qt):Qe(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.blendColor,ue.blendAlpha,ue.premultipliedAlpha),d.setFunc(ue.depthFunc),d.setTest(ue.depthTest),d.setMask(ue.depthWrite),a.setMask(ue.colorWrite);const Kt=ue.stencilWrite;m.setTest(Kt),Kt&&(m.setMask(ue.stencilWriteMask),m.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),m.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),ct(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits),!0===ue.alphaToCoverage?Ke(l.SAMPLE_ALPHA_TO_COVERAGE):nn(l.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Be,setCullFace:ke,setLineWidth:function Et(ue){ue!==me&&(De&&l.lineWidth(ue),me=ue)},setPolygonOffset:ct,setScissorTest:function bt(ue){ue?Ke(l.SCISSOR_TEST):nn(l.SCISSOR_TEST)},activeTexture:function Hn(ue){void 0===ue&&(ue=l.TEXTURE0+Ne-1),At!==ue&&(l.activeTexture(ue),At=ue)},bindTexture:function On(ue,ft,Dt){void 0===Dt&&(Dt=null===At?l.TEXTURE0+Ne-1:At);let Kt=zt[Dt];void 0===Kt&&(Kt={type:void 0,texture:void 0},zt[Dt]=Kt),(Kt.type!==ue||Kt.texture!==ft)&&(At!==Dt&&(l.activeTexture(Dt),At=Dt),l.bindTexture(ue,ft||Ue[ue]),Kt.type=ue,Kt.texture=ft)},unbindTexture:function Q(){const ue=zt[At];void 0!==ue&&void 0!==ue.type&&(l.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)},compressedTexImage2D:function $(){try{l.compressedTexImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},compressedTexImage3D:function ge(){try{l.compressedTexImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texImage2D:function Zt(){try{l.texImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texImage3D:function lt(){try{l.texImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},updateUBOMapping:function an(ue,ft){let Dt=v.get(ft);void 0===Dt&&(Dt=new WeakMap,v.set(ft,Dt));let Kt=Dt.get(ue);void 0===Kt&&(Kt=l.getUniformBlockIndex(ft,ue.name),Dt.set(ue,Kt))},uniformBlockBinding:function Ot(ue,ft){const Kt=v.get(ft).get(ue);y.get(ft)!==Kt&&(l.uniformBlockBinding(ft,Kt,ue.__bindingPointIndex),y.set(ft,Kt))},texStorage2D:function yt(){try{l.texStorage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texStorage3D:function rn(){try{l.texStorage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texSubImage2D:function Te(){try{l.texSubImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texSubImage3D:function tt(){try{l.texSubImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},compressedTexSubImage2D:function Re(){try{l.compressedTexSubImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},compressedTexSubImage3D:function en(){try{l.compressedTexSubImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},scissor:function Vt(ue){!1===ui.equals(ue)&&(l.scissor(ue.x,ue.y,ue.z,ue.w),ui.copy(ue))},viewport:function Dn(ue){!1===Ti.equals(ue)&&(l.viewport(ue.x,ue.y,ue.z,ue.w),Ti.copy(ue))},reset:function Gn(){l.disable(l.BLEND),l.disable(l.CULL_FACE),l.disable(l.DEPTH_TEST),l.disable(l.POLYGON_OFFSET_FILL),l.disable(l.SCISSOR_TEST),l.disable(l.STENCIL_TEST),l.disable(l.SAMPLE_ALPHA_TO_COVERAGE),l.blendEquation(l.FUNC_ADD),l.blendFunc(l.ONE,l.ZERO),l.blendFuncSeparate(l.ONE,l.ZERO,l.ONE,l.ZERO),l.blendColor(0,0,0,0),l.colorMask(!0,!0,!0,!0),l.clearColor(0,0,0,0),l.depthMask(!0),l.depthFunc(l.LESS),d.setReversed(!1),l.clearDepth(1),l.stencilMask(4294967295),l.stencilFunc(l.ALWAYS,0,4294967295),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.clearStencil(0),l.cullFace(l.BACK),l.frontFace(l.CCW),l.polygonOffset(0,0),l.activeTexture(l.TEXTURE0),l.bindFramebuffer(l.FRAMEBUFFER,null),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.useProgram(null),l.lineWidth(1),l.scissor(0,0,l.canvas.width,l.canvas.height),l.viewport(0,0,l.canvas.width,l.canvas.height),M={},At=null,zt={},b={},E=new WeakMap,C=[],D=null,O=!1,N=null,A=null,H=null,k=null,V=null,Z=null,q=null,ee=new Nt(0,0,0),ne=0,X=!1,j=null,se=null,me=null,ve=null,we=null,ui.set(0,0,l.canvas.width,l.canvas.height),Ti.set(0,0,l.canvas.width,l.canvas.height),a.reset(),d.reset(),m.reset()}}}function Pb(l,e,t,i,s,a,d){const m=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,y=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),v=new Ce,M=new WeakMap;let b;const E=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function D(Q,$){return C?new OffscreenCanvas(Q,$):Ml("canvas")}function O(Q,$,ge){let Te=1;const tt=On(Q);if((tt.width>ge||tt.height>ge)&&(Te=ge/Math.max(tt.width,tt.height)),Te<1){if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap||typeof VideoFrame<"u"&&Q instanceof VideoFrame){const Re=Math.floor(Te*tt.width),en=Math.floor(Te*tt.height);void 0===b&&(b=D(Re,en));const yt=$?D(Re,en):b;return yt.width=Re,yt.height=en,yt.getContext("2d").drawImage(Q,0,0,Re,en),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+tt.width+"x"+tt.height+") to ("+Re+"x"+en+")."),yt}return"data"in Q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+tt.width+"x"+tt.height+")."),Q}return Q}function N(Q){return Q.generateMipmaps}function A(Q){l.generateMipmap(Q)}function H(Q){return Q.isWebGLCubeRenderTarget?l.TEXTURE_CUBE_MAP:Q.isWebGL3DRenderTarget?l.TEXTURE_3D:Q.isWebGLArrayRenderTarget||Q.isCompressedArrayTexture?l.TEXTURE_2D_ARRAY:l.TEXTURE_2D}function k(Q,$,ge,Te,tt=!1){if(null!==Q){if(void 0!==l[Q])return l[Q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let Re=$;if($===l.RED&&(ge===l.FLOAT&&(Re=l.R32F),ge===l.HALF_FLOAT&&(Re=l.R16F),ge===l.UNSIGNED_BYTE&&(Re=l.R8)),$===l.RED_INTEGER&&(ge===l.UNSIGNED_BYTE&&(Re=l.R8UI),ge===l.UNSIGNED_SHORT&&(Re=l.R16UI),ge===l.UNSIGNED_INT&&(Re=l.R32UI),ge===l.BYTE&&(Re=l.R8I),ge===l.SHORT&&(Re=l.R16I),ge===l.INT&&(Re=l.R32I)),$===l.RG&&(ge===l.FLOAT&&(Re=l.RG32F),ge===l.HALF_FLOAT&&(Re=l.RG16F),ge===l.UNSIGNED_BYTE&&(Re=l.RG8)),$===l.RG_INTEGER&&(ge===l.UNSIGNED_BYTE&&(Re=l.RG8UI),ge===l.UNSIGNED_SHORT&&(Re=l.RG16UI),ge===l.UNSIGNED_INT&&(Re=l.RG32UI),ge===l.BYTE&&(Re=l.RG8I),ge===l.SHORT&&(Re=l.RG16I),ge===l.INT&&(Re=l.RG32I)),$===l.RGB_INTEGER&&(ge===l.UNSIGNED_BYTE&&(Re=l.RGB8UI),ge===l.UNSIGNED_SHORT&&(Re=l.RGB16UI),ge===l.UNSIGNED_INT&&(Re=l.RGB32UI),ge===l.BYTE&&(Re=l.RGB8I),ge===l.SHORT&&(Re=l.RGB16I),ge===l.INT&&(Re=l.RGB32I)),$===l.RGBA_INTEGER&&(ge===l.UNSIGNED_BYTE&&(Re=l.RGBA8UI),ge===l.UNSIGNED_SHORT&&(Re=l.RGBA16UI),ge===l.UNSIGNED_INT&&(Re=l.RGBA32UI),ge===l.BYTE&&(Re=l.RGBA8I),ge===l.SHORT&&(Re=l.RGBA16I),ge===l.INT&&(Re=l.RGBA32I)),$===l.RGB&&(ge===l.UNSIGNED_INT_5_9_9_9_REV&&(Re=l.RGB9_E5),ge===l.UNSIGNED_INT_10F_11F_11F_REV&&(Re=l.R11F_G11F_B10F)),$===l.RGBA){const en=tt?po:Kn.getTransfer(Te);ge===l.FLOAT&&(Re=l.RGBA32F),ge===l.HALF_FLOAT&&(Re=l.RGBA16F),ge===l.UNSIGNED_BYTE&&(Re=en===ci?l.SRGB8_ALPHA8:l.RGBA8),ge===l.UNSIGNED_SHORT_4_4_4_4&&(Re=l.RGBA4),ge===l.UNSIGNED_SHORT_5_5_5_1&&(Re=l.RGB5_A1)}return(Re===l.R16F||Re===l.R32F||Re===l.RG16F||Re===l.RG32F||Re===l.RGBA16F||Re===l.RGBA32F)&&e.get("EXT_color_buffer_float"),Re}function V(Q,$){let ge;return Q?null===$||$===Cn||$===_t?ge=l.DEPTH24_STENCIL8:$===si?ge=l.DEPTH32F_STENCIL8:$===ni&&(ge=l.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===$||$===Cn||$===_t?ge=l.DEPTH_COMPONENT24:$===si?ge=l.DEPTH_COMPONENT32F:$===ni&&(ge=l.DEPTH_COMPONENT16),ge}function Z(Q,$){return!0===N(Q)||Q.isFramebufferTexture&&Q.minFilter!==qn&&Q.minFilter!==dr?Math.log2(Math.max($.width,$.height))+1:void 0!==Q.mipmaps&&Q.mipmaps.length>0?Q.mipmaps.length:Q.isCompressedTexture&&Array.isArray(Q.image)?$.mipmaps.length:1}function q(Q){const $=Q.target;$.removeEventListener("dispose",q),function ne(Q){const $=i.get(Q);if(void 0===$.__webglInit)return;const ge=Q.source,Te=E.get(ge);if(Te){const tt=Te[$.__cacheKey];tt.usedTimes--,0===tt.usedTimes&&X(Q),0===Object.keys(Te).length&&E.delete(ge)}i.remove(Q)}($),$.isVideoTexture&&M.delete($)}function ee(Q){const $=Q.target;$.removeEventListener("dispose",ee),function j(Q){const $=i.get(Q);if(Q.depthTexture&&(Q.depthTexture.dispose(),i.remove(Q.depthTexture)),Q.isWebGLCubeRenderTarget)for(let Te=0;Te<6;Te++){if(Array.isArray($.__webglFramebuffer[Te]))for(let tt=0;tt<$.__webglFramebuffer[Te].length;tt++)l.deleteFramebuffer($.__webglFramebuffer[Te][tt]);else l.deleteFramebuffer($.__webglFramebuffer[Te]);$.__webglDepthbuffer&&l.deleteRenderbuffer($.__webglDepthbuffer[Te])}else{if(Array.isArray($.__webglFramebuffer))for(let Te=0;Te<$.__webglFramebuffer.length;Te++)l.deleteFramebuffer($.__webglFramebuffer[Te]);else l.deleteFramebuffer($.__webglFramebuffer);if($.__webglDepthbuffer&&l.deleteRenderbuffer($.__webglDepthbuffer),$.__webglMultisampledFramebuffer&&l.deleteFramebuffer($.__webglMultisampledFramebuffer),$.__webglColorRenderbuffer)for(let Te=0;Te<$.__webglColorRenderbuffer.length;Te++)$.__webglColorRenderbuffer[Te]&&l.deleteRenderbuffer($.__webglColorRenderbuffer[Te]);$.__webglDepthRenderbuffer&&l.deleteRenderbuffer($.__webglDepthRenderbuffer)}const ge=Q.textures;for(let Te=0,tt=ge.length;Te<tt;Te++){const Re=i.get(ge[Te]);Re.__webglTexture&&(l.deleteTexture(Re.__webglTexture),d.memory.textures--),i.remove(ge[Te])}i.remove(Q)}($)}function X(Q){const $=i.get(Q);l.deleteTexture($.__webglTexture),delete E.get(Q.source)[$.__cacheKey],d.memory.textures--}let se=0;function Ne(Q,$){const ge=i.get(Q);if(Q.isVideoTexture&&function bt(Q){const $=d.render.frame;M.get(Q)!==$&&(M.set(Q,$),Q.update())}(Q),!1===Q.isRenderTargetTexture&&!0!==Q.isExternalTexture&&Q.version>0&&ge.__version!==Q.version){const Te=Q.image;if(null===Te)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Te.complete)return void Ue(ge,Q,$);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}else Q.isExternalTexture&&(ge.__webglTexture=Q.sourceTexture?Q.sourceTexture:null);t.bindTexture(l.TEXTURE_2D,ge.__webglTexture,l.TEXTURE0+$)}const At={[Ks]:l.REPEAT,[Ln]:l.CLAMP_TO_EDGE,[cu]:l.MIRRORED_REPEAT},zt={[qn]:l.NEAREST,[md]:l.NEAREST_MIPMAP_NEAREST,[ea]:l.NEAREST_MIPMAP_LINEAR,[dr]:l.LINEAR,[na]:l.LINEAR_MIPMAP_NEAREST,[oe]:l.LINEAR_MIPMAP_LINEAR},qt={[Tm]:l.NEVER,[yl]:l.ALWAYS,[Js]:l.LESS,[ua]:l.LEQUAL,[mc]:l.EQUAL,[pu]:l.GEQUAL,[gc]:l.GREATER,[Fh]:l.NOTEQUAL};function Vn(Q,$){if($.type===si&&!1===e.has("OES_texture_float_linear")&&($.magFilter===dr||$.magFilter===na||$.magFilter===ea||$.magFilter===oe||$.minFilter===dr||$.minFilter===na||$.minFilter===ea||$.minFilter===oe)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),l.texParameteri(Q,l.TEXTURE_WRAP_S,At[$.wrapS]),l.texParameteri(Q,l.TEXTURE_WRAP_T,At[$.wrapT]),(Q===l.TEXTURE_3D||Q===l.TEXTURE_2D_ARRAY)&&l.texParameteri(Q,l.TEXTURE_WRAP_R,At[$.wrapR]),l.texParameteri(Q,l.TEXTURE_MAG_FILTER,zt[$.magFilter]),l.texParameteri(Q,l.TEXTURE_MIN_FILTER,zt[$.minFilter]),$.compareFunction&&(l.texParameteri(Q,l.TEXTURE_COMPARE_MODE,l.COMPARE_REF_TO_TEXTURE),l.texParameteri(Q,l.TEXTURE_COMPARE_FUNC,qt[$.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if($.magFilter===qn||$.minFilter!==ea&&$.minFilter!==oe||$.type===si&&!1===e.has("OES_texture_float_linear"))return;if($.anisotropy>1||i.get($).__currentAnisotropy){const ge=e.get("EXT_texture_filter_anisotropic");l.texParameterf(Q,ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min($.anisotropy,s.getMaxAnisotropy())),i.get($).__currentAnisotropy=$.anisotropy}}}function ui(Q,$){let ge=!1;void 0===Q.__webglInit&&(Q.__webglInit=!0,$.addEventListener("dispose",q));const Te=$.source;let tt=E.get(Te);void 0===tt&&(tt={},E.set(Te,tt));const Re=function we(Q){const $=[];return $.push(Q.wrapS),$.push(Q.wrapT),$.push(Q.wrapR||0),$.push(Q.magFilter),$.push(Q.minFilter),$.push(Q.anisotropy),$.push(Q.internalFormat),$.push(Q.format),$.push(Q.type),$.push(Q.generateMipmaps),$.push(Q.premultiplyAlpha),$.push(Q.flipY),$.push(Q.unpackAlignment),$.push(Q.colorSpace),$.join()}($);if(Re!==Q.__cacheKey){void 0===tt[Re]&&(tt[Re]={texture:l.createTexture(),usedTimes:0},d.memory.textures++,ge=!0),tt[Re].usedTimes++;const en=tt[Q.__cacheKey];void 0!==en&&(tt[Q.__cacheKey].usedTimes--,0===en.usedTimes&&X($)),Q.__cacheKey=Re,Q.__webglTexture=tt[Re].texture}return ge}function Ti(Q,$,ge){return Math.floor(Math.floor(Q/ge)/$)}function Ue(Q,$,ge){let Te=l.TEXTURE_2D;($.isDataArrayTexture||$.isCompressedArrayTexture)&&(Te=l.TEXTURE_2D_ARRAY),$.isData3DTexture&&(Te=l.TEXTURE_3D);const tt=ui(Q,$),Re=$.source;t.bindTexture(Te,Q.__webglTexture,l.TEXTURE0+ge);const en=i.get(Re);if(Re.version!==en.__version||!0===tt){t.activeTexture(l.TEXTURE0+ge);const yt=Kn.getPrimaries(Kn.workingColorSpace),rn=$.colorSpace===Sr?null:Kn.getPrimaries($.colorSpace),Zt=$.colorSpace===Sr||yt===rn?l.NONE:l.BROWSER_DEFAULT_WEBGL;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,$.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,$.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,Zt);let lt=O($.image,!1,s.maxTextureSize);lt=Hn($,lt);const Vt=a.convert($.format,$.colorSpace),Dn=a.convert($.type);let Ot,an=k($.internalFormat,Vt,Dn,$.colorSpace,$.isVideoTexture);Vn(Te,$);const Gn=$.mipmaps,ue=!0!==$.isVideoTexture,ft=void 0===en.__version||!0===tt,Dt=Re.dataReady,Kt=Z($,lt);if($.isDepthTexture)an=V($.format===fo,$.type),ft&&(ue?t.texStorage2D(l.TEXTURE_2D,1,an,lt.width,lt.height):t.texImage2D(l.TEXTURE_2D,0,an,lt.width,lt.height,0,Vt,Dn,null));else if($.isDataTexture)if(Gn.length>0){ue&&ft&&t.texStorage2D(l.TEXTURE_2D,Kt,an,Gn[0].width,Gn[0].height);for(let ot=0,Ye=Gn.length;ot<Ye;ot++)Ot=Gn[ot],ue?Dt&&t.texSubImage2D(l.TEXTURE_2D,ot,0,0,Ot.width,Ot.height,Vt,Dn,Ot.data):t.texImage2D(l.TEXTURE_2D,ot,an,Ot.width,Ot.height,0,Vt,Dn,Ot.data);$.generateMipmaps=!1}else ue?(ft&&t.texStorage2D(l.TEXTURE_2D,Kt,an,lt.width,lt.height),Dt&&function di(Q,$,ge,Te){const Re=Q.updateRanges;if(0===Re.length)t.texSubImage2D(l.TEXTURE_2D,0,0,0,$.width,$.height,ge,Te,$.data);else{Re.sort((lt,Vt)=>lt.start-Vt.start);let en=0;for(let lt=1;lt<Re.length;lt++){const Vt=Re[en],Dn=Re[lt],an=Vt.start+Vt.count,Ot=Ti(Dn.start,$.width,4),Gn=Ti(Vt.start,$.width,4);Dn.start<=an+1&&Ot===Gn&&Ti(Dn.start+Dn.count-1,$.width,4)===Ot?Vt.count=Math.max(Vt.count,Dn.start+Dn.count-Vt.start):(++en,Re[en]=Dn)}Re.length=en+1;const yt=l.getParameter(l.UNPACK_ROW_LENGTH),rn=l.getParameter(l.UNPACK_SKIP_PIXELS),Zt=l.getParameter(l.UNPACK_SKIP_ROWS);l.pixelStorei(l.UNPACK_ROW_LENGTH,$.width);for(let lt=0,Vt=Re.length;lt<Vt;lt++){const Dn=Re[lt],an=Math.floor(Dn.start/4),Ot=Math.ceil(Dn.count/4),Gn=an%$.width,ue=Math.floor(an/$.width),ft=Ot,Dt=1;l.pixelStorei(l.UNPACK_SKIP_PIXELS,Gn),l.pixelStorei(l.UNPACK_SKIP_ROWS,ue),t.texSubImage2D(l.TEXTURE_2D,0,Gn,ue,ft,Dt,ge,Te,$.data)}Q.clearUpdateRanges(),l.pixelStorei(l.UNPACK_ROW_LENGTH,yt),l.pixelStorei(l.UNPACK_SKIP_PIXELS,rn),l.pixelStorei(l.UNPACK_SKIP_ROWS,Zt)}}($,lt,Vt,Dn)):t.texImage2D(l.TEXTURE_2D,0,an,lt.width,lt.height,0,Vt,Dn,lt.data);else if($.isCompressedTexture)if($.isCompressedArrayTexture){ue&&ft&&t.texStorage3D(l.TEXTURE_2D_ARRAY,Kt,an,Gn[0].width,Gn[0].height,lt.depth);for(let ot=0,Ye=Gn.length;ot<Ye;ot++)if(Ot=Gn[ot],$.format!==on)if(null!==Vt)if(ue){if(Dt)if($.layerUpdates.size>0){const ln=Eg(Ot.width,Ot.height,$.format,$.type);for(const zn of $.layerUpdates){const Yi=Ot.data.subarray(zn*ln/Ot.data.BYTES_PER_ELEMENT,(zn+1)*ln/Ot.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(l.TEXTURE_2D_ARRAY,ot,0,0,zn,Ot.width,Ot.height,1,Vt,Yi)}$.clearLayerUpdates()}else t.compressedTexSubImage3D(l.TEXTURE_2D_ARRAY,ot,0,0,0,Ot.width,Ot.height,lt.depth,Vt,Ot.data)}else t.compressedTexImage3D(l.TEXTURE_2D_ARRAY,ot,an,Ot.width,Ot.height,lt.depth,0,Ot.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ue?Dt&&t.texSubImage3D(l.TEXTURE_2D_ARRAY,ot,0,0,0,Ot.width,Ot.height,lt.depth,Vt,Dn,Ot.data):t.texImage3D(l.TEXTURE_2D_ARRAY,ot,an,Ot.width,Ot.height,lt.depth,0,Vt,Dn,Ot.data)}else{ue&&ft&&t.texStorage2D(l.TEXTURE_2D,Kt,an,Gn[0].width,Gn[0].height);for(let ot=0,Ye=Gn.length;ot<Ye;ot++)Ot=Gn[ot],$.format!==on?null!==Vt?ue?Dt&&t.compressedTexSubImage2D(l.TEXTURE_2D,ot,0,0,Ot.width,Ot.height,Vt,Ot.data):t.compressedTexImage2D(l.TEXTURE_2D,ot,an,Ot.width,Ot.height,0,Ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ue?Dt&&t.texSubImage2D(l.TEXTURE_2D,ot,0,0,Ot.width,Ot.height,Vt,Dn,Ot.data):t.texImage2D(l.TEXTURE_2D,ot,an,Ot.width,Ot.height,0,Vt,Dn,Ot.data)}else if($.isDataArrayTexture)if(ue){if(ft&&t.texStorage3D(l.TEXTURE_2D_ARRAY,Kt,an,lt.width,lt.height,lt.depth),Dt)if($.layerUpdates.size>0){const ot=Eg(lt.width,lt.height,$.format,$.type);for(const Ye of $.layerUpdates){const ln=lt.data.subarray(Ye*ot/lt.data.BYTES_PER_ELEMENT,(Ye+1)*ot/lt.data.BYTES_PER_ELEMENT);t.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,Ye,lt.width,lt.height,1,Vt,Dn,ln)}$.clearLayerUpdates()}else t.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,0,lt.width,lt.height,lt.depth,Vt,Dn,lt.data)}else t.texImage3D(l.TEXTURE_2D_ARRAY,0,an,lt.width,lt.height,lt.depth,0,Vt,Dn,lt.data);else if($.isData3DTexture)ue?(ft&&t.texStorage3D(l.TEXTURE_3D,Kt,an,lt.width,lt.height,lt.depth),Dt&&t.texSubImage3D(l.TEXTURE_3D,0,0,0,0,lt.width,lt.height,lt.depth,Vt,Dn,lt.data)):t.texImage3D(l.TEXTURE_3D,0,an,lt.width,lt.height,lt.depth,0,Vt,Dn,lt.data);else if($.isFramebufferTexture){if(ft)if(ue)t.texStorage2D(l.TEXTURE_2D,Kt,an,lt.width,lt.height);else{let ot=lt.width,Ye=lt.height;for(let ln=0;ln<Kt;ln++)t.texImage2D(l.TEXTURE_2D,ln,an,ot,Ye,0,Vt,Dn,null),ot>>=1,Ye>>=1}}else if(Gn.length>0){if(ue&&ft){const ot=On(Gn[0]);t.texStorage2D(l.TEXTURE_2D,Kt,an,ot.width,ot.height)}for(let ot=0,Ye=Gn.length;ot<Ye;ot++)Ot=Gn[ot],ue?Dt&&t.texSubImage2D(l.TEXTURE_2D,ot,0,0,Vt,Dn,Ot):t.texImage2D(l.TEXTURE_2D,ot,an,Vt,Dn,Ot);$.generateMipmaps=!1}else if(ue){if(ft){const ot=On(lt);t.texStorage2D(l.TEXTURE_2D,Kt,an,ot.width,ot.height)}Dt&&t.texSubImage2D(l.TEXTURE_2D,0,0,0,Vt,Dn,lt)}else t.texImage2D(l.TEXTURE_2D,0,an,Vt,Dn,lt);N($)&&A(Te),en.__version=Re.version,$.onUpdate&&$.onUpdate($)}Q.__version=$.version}function nn(Q,$,ge,Te,tt,Re){const en=a.convert(ge.format,ge.colorSpace),yt=a.convert(ge.type),rn=k(ge.internalFormat,en,yt,ge.colorSpace),Zt=i.get($),lt=i.get(ge);if(lt.__renderTarget=$,!Zt.__hasExternalTextures){const Vt=Math.max(1,$.width>>Re),Dn=Math.max(1,$.height>>Re);tt===l.TEXTURE_3D||tt===l.TEXTURE_2D_ARRAY?t.texImage3D(tt,Re,rn,Vt,Dn,$.depth,0,en,yt,null):t.texImage2D(tt,Re,rn,Vt,Dn,0,en,yt,null)}t.bindFramebuffer(l.FRAMEBUFFER,Q),ct($)?m.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,Te,tt,lt.__webglTexture,0,Et($)):(tt===l.TEXTURE_2D||tt>=l.TEXTURE_CUBE_MAP_POSITIVE_X&&tt<=l.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&l.framebufferTexture2D(l.FRAMEBUFFER,Te,tt,lt.__webglTexture,Re),t.bindFramebuffer(l.FRAMEBUFFER,null)}function hn(Q,$,ge){if(l.bindRenderbuffer(l.RENDERBUFFER,Q),$.depthBuffer){const Te=$.depthTexture,Re=V($.stencilBuffer,Te&&Te.isDepthTexture?Te.type:null),en=$.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,yt=Et($);ct($)?m.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,yt,Re,$.width,$.height):ge?l.renderbufferStorageMultisample(l.RENDERBUFFER,yt,Re,$.width,$.height):l.renderbufferStorage(l.RENDERBUFFER,Re,$.width,$.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,en,l.RENDERBUFFER,Q)}else{const Te=$.textures;for(let tt=0;tt<Te.length;tt++){const Re=Te[tt],en=a.convert(Re.format,Re.colorSpace),yt=a.convert(Re.type),rn=k(Re.internalFormat,en,yt,Re.colorSpace),Zt=Et($);ge&&!1===ct($)?l.renderbufferStorageMultisample(l.RENDERBUFFER,Zt,rn,$.width,$.height):ct($)?m.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,Zt,rn,$.width,$.height):l.renderbufferStorage(l.RENDERBUFFER,rn,$.width,$.height)}}l.bindRenderbuffer(l.RENDERBUFFER,null)}function Jn(Q){const $=i.get(Q),ge=!0===Q.isWebGLCubeRenderTarget;if($.__boundDepthTexture!==Q.depthTexture){const Te=Q.depthTexture;if($.__depthDisposeCallback&&$.__depthDisposeCallback(),Te){const tt=()=>{delete $.__boundDepthTexture,delete $.__depthDisposeCallback,Te.removeEventListener("dispose",tt)};Te.addEventListener("dispose",tt),$.__depthDisposeCallback=tt}$.__boundDepthTexture=Te}if(Q.depthTexture&&!$.__autoAllocateDepthBuffer){if(ge)throw new Error("target.depthTexture not supported in Cube render targets");const Te=Q.texture.mipmaps;!function sn(Q,$){if($&&$.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(l.FRAMEBUFFER,Q),!$.depthTexture||!$.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Te=i.get($.depthTexture);Te.__renderTarget=$,(!Te.__webglTexture||$.depthTexture.image.width!==$.width||$.depthTexture.image.height!==$.height)&&($.depthTexture.image.width=$.width,$.depthTexture.image.height=$.height,$.depthTexture.needsUpdate=!0),Ne($.depthTexture,0);const tt=Te.__webglTexture,Re=Et($);if($.depthTexture.format===Us)ct($)?m.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,tt,0,Re):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,tt,0);else{if($.depthTexture.format!==fo)throw new Error("Unknown depthTexture format");ct($)?m.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,tt,0,Re):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,tt,0)}}(Te&&Te.length>0?$.__webglFramebuffer[0]:$.__webglFramebuffer,Q)}else if(ge){$.__webglDepthbuffer=[];for(let Te=0;Te<6;Te++)if(t.bindFramebuffer(l.FRAMEBUFFER,$.__webglFramebuffer[Te]),void 0===$.__webglDepthbuffer[Te])$.__webglDepthbuffer[Te]=l.createRenderbuffer(),hn($.__webglDepthbuffer[Te],Q,!1);else{const tt=Q.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,Re=$.__webglDepthbuffer[Te];l.bindRenderbuffer(l.RENDERBUFFER,Re),l.framebufferRenderbuffer(l.FRAMEBUFFER,tt,l.RENDERBUFFER,Re)}}else{const Te=Q.texture.mipmaps;if(t.bindFramebuffer(l.FRAMEBUFFER,Te&&Te.length>0?$.__webglFramebuffer[0]:$.__webglFramebuffer),void 0===$.__webglDepthbuffer)$.__webglDepthbuffer=l.createRenderbuffer(),hn($.__webglDepthbuffer,Q,!1);else{const tt=Q.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,Re=$.__webglDepthbuffer;l.bindRenderbuffer(l.RENDERBUFFER,Re),l.framebufferRenderbuffer(l.FRAMEBUFFER,tt,l.RENDERBUFFER,Re)}}t.bindFramebuffer(l.FRAMEBUFFER,null)}const $e=[],Be=[];function Et(Q){return Math.min(s.maxSamples,Q.samples)}function ct(Q){const $=i.get(Q);return Q.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==$.__useRenderToTexture}function Hn(Q,$){const ge=Q.colorSpace,Te=Q.format,tt=Q.type;return!0===Q.isCompressedTexture||!0===Q.isVideoTexture||ge!==As&&ge!==Sr&&(Kn.getTransfer(ge)===ci?(Te!==on||tt!==We)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ge)),$}function On(Q){return typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement?(v.width=Q.naturalWidth||Q.width,v.height=Q.naturalHeight||Q.height):typeof VideoFrame<"u"&&Q instanceof VideoFrame?(v.width=Q.displayWidth,v.height=Q.displayHeight):(v.width=Q.width,v.height=Q.height),v}this.allocateTextureUnit=function ve(){const Q=se;return Q>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+s.maxTextures),se+=1,Q},this.resetTextureUnits=function me(){se=0},this.setTexture2D=Ne,this.setTexture2DArray=function De(Q,$){const ge=i.get(Q);!1===Q.isRenderTargetTexture&&Q.version>0&&ge.__version!==Q.version?Ue(ge,Q,$):t.bindTexture(l.TEXTURE_2D_ARRAY,ge.__webglTexture,l.TEXTURE0+$)},this.setTexture3D=function it(Q,$){const ge=i.get(Q);!1===Q.isRenderTargetTexture&&Q.version>0&&ge.__version!==Q.version?Ue(ge,Q,$):t.bindTexture(l.TEXTURE_3D,ge.__webglTexture,l.TEXTURE0+$)},this.setTextureCube=function Ie(Q,$){const ge=i.get(Q);Q.version>0&&ge.__version!==Q.version?function Ke(Q,$,ge){if(6!==$.image.length)return;const Te=ui(Q,$),tt=$.source;t.bindTexture(l.TEXTURE_CUBE_MAP,Q.__webglTexture,l.TEXTURE0+ge);const Re=i.get(tt);if(tt.version!==Re.__version||!0===Te){t.activeTexture(l.TEXTURE0+ge);const en=Kn.getPrimaries(Kn.workingColorSpace),yt=$.colorSpace===Sr?null:Kn.getPrimaries($.colorSpace),rn=$.colorSpace===Sr||en===yt?l.NONE:l.BROWSER_DEFAULT_WEBGL;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,$.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,$.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,rn);const Zt=$.isCompressedTexture||$.image[0].isCompressedTexture,lt=$.image[0]&&$.image[0].isDataTexture,Vt=[];for(let Ye=0;Ye<6;Ye++)Vt[Ye]=Zt||lt?lt?$.image[Ye].image:$.image[Ye]:O($.image[Ye],!0,s.maxCubemapSize),Vt[Ye]=Hn($,Vt[Ye]);const Dn=Vt[0],an=a.convert($.format,$.colorSpace),Ot=a.convert($.type),Gn=k($.internalFormat,an,Ot,$.colorSpace),ue=!0!==$.isVideoTexture,ft=void 0===Re.__version||!0===Te,Dt=tt.dataReady;let ot,Kt=Z($,Dn);if(Vn(l.TEXTURE_CUBE_MAP,$),Zt){ue&&ft&&t.texStorage2D(l.TEXTURE_CUBE_MAP,Kt,Gn,Dn.width,Dn.height);for(let Ye=0;Ye<6;Ye++){ot=Vt[Ye].mipmaps;for(let ln=0;ln<ot.length;ln++){const zn=ot[ln];$.format!==on?null!==an?ue?Dt&&t.compressedTexSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln,0,0,zn.width,zn.height,an,zn.data):t.compressedTexImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln,Gn,zn.width,zn.height,0,zn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ue?Dt&&t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln,0,0,zn.width,zn.height,an,Ot,zn.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln,Gn,zn.width,zn.height,0,an,Ot,zn.data)}}}else{if(ot=$.mipmaps,ue&&ft){ot.length>0&&Kt++;const Ye=On(Vt[0]);t.texStorage2D(l.TEXTURE_CUBE_MAP,Kt,Gn,Ye.width,Ye.height)}for(let Ye=0;Ye<6;Ye++)if(lt){ue?Dt&&t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,0,0,Vt[Ye].width,Vt[Ye].height,an,Ot,Vt[Ye].data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,Gn,Vt[Ye].width,Vt[Ye].height,0,an,Ot,Vt[Ye].data);for(let ln=0;ln<ot.length;ln++){const Yi=ot[ln].image[Ye].image;ue?Dt&&t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln+1,0,0,Yi.width,Yi.height,an,Ot,Yi.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln+1,Gn,Yi.width,Yi.height,0,an,Ot,Yi.data)}}else{ue?Dt&&t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,0,0,an,Ot,Vt[Ye]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,Gn,an,Ot,Vt[Ye]);for(let ln=0;ln<ot.length;ln++){const zn=ot[ln];ue?Dt&&t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln+1,0,0,an,Ot,zn.image[Ye]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,ln+1,Gn,an,Ot,zn.image[Ye])}}}N($)&&A(l.TEXTURE_CUBE_MAP),Re.__version=tt.version,$.onUpdate&&$.onUpdate($)}Q.__version=$.version}(ge,Q,$):t.bindTexture(l.TEXTURE_CUBE_MAP,ge.__webglTexture,l.TEXTURE0+$)},this.rebindTextures=function Fi(Q,$,ge){const Te=i.get(Q);void 0!==$&&nn(Te.__webglFramebuffer,Q,Q.texture,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,0),void 0!==ge&&Jn(Q)},this.setupRenderTarget=function re(Q){const $=Q.texture,ge=i.get(Q),Te=i.get($);Q.addEventListener("dispose",ee);const tt=Q.textures,Re=!0===Q.isWebGLCubeRenderTarget,en=tt.length>1;if(en||(void 0===Te.__webglTexture&&(Te.__webglTexture=l.createTexture()),Te.__version=$.version,d.memory.textures++),Re){ge.__webglFramebuffer=[];for(let yt=0;yt<6;yt++)if($.mipmaps&&$.mipmaps.length>0){ge.__webglFramebuffer[yt]=[];for(let rn=0;rn<$.mipmaps.length;rn++)ge.__webglFramebuffer[yt][rn]=l.createFramebuffer()}else ge.__webglFramebuffer[yt]=l.createFramebuffer()}else{if($.mipmaps&&$.mipmaps.length>0){ge.__webglFramebuffer=[];for(let yt=0;yt<$.mipmaps.length;yt++)ge.__webglFramebuffer[yt]=l.createFramebuffer()}else ge.__webglFramebuffer=l.createFramebuffer();if(en)for(let yt=0,rn=tt.length;yt<rn;yt++){const Zt=i.get(tt[yt]);void 0===Zt.__webglTexture&&(Zt.__webglTexture=l.createTexture(),d.memory.textures++)}if(Q.samples>0&&!1===ct(Q)){ge.__webglMultisampledFramebuffer=l.createFramebuffer(),ge.__webglColorRenderbuffer=[],t.bindFramebuffer(l.FRAMEBUFFER,ge.__webglMultisampledFramebuffer);for(let yt=0;yt<tt.length;yt++){const rn=tt[yt];ge.__webglColorRenderbuffer[yt]=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,ge.__webglColorRenderbuffer[yt]);const Zt=a.convert(rn.format,rn.colorSpace),lt=a.convert(rn.type),Vt=k(rn.internalFormat,Zt,lt,rn.colorSpace,!0===Q.isXRRenderTarget),Dn=Et(Q);l.renderbufferStorageMultisample(l.RENDERBUFFER,Dn,Vt,Q.width,Q.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+yt,l.RENDERBUFFER,ge.__webglColorRenderbuffer[yt])}l.bindRenderbuffer(l.RENDERBUFFER,null),Q.depthBuffer&&(ge.__webglDepthRenderbuffer=l.createRenderbuffer(),hn(ge.__webglDepthRenderbuffer,Q,!0)),t.bindFramebuffer(l.FRAMEBUFFER,null)}}if(Re){t.bindTexture(l.TEXTURE_CUBE_MAP,Te.__webglTexture),Vn(l.TEXTURE_CUBE_MAP,$);for(let yt=0;yt<6;yt++)if($.mipmaps&&$.mipmaps.length>0)for(let rn=0;rn<$.mipmaps.length;rn++)nn(ge.__webglFramebuffer[yt][rn],Q,$,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+yt,rn);else nn(ge.__webglFramebuffer[yt],Q,$,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+yt,0);N($)&&A(l.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(en){for(let yt=0,rn=tt.length;yt<rn;yt++){const Zt=tt[yt],lt=i.get(Zt);let Vt=l.TEXTURE_2D;(Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(Vt=Q.isWebGL3DRenderTarget?l.TEXTURE_3D:l.TEXTURE_2D_ARRAY),t.bindTexture(Vt,lt.__webglTexture),Vn(Vt,Zt),nn(ge.__webglFramebuffer,Q,Zt,l.COLOR_ATTACHMENT0+yt,Vt,0),N(Zt)&&A(Vt)}t.unbindTexture()}else{let yt=l.TEXTURE_2D;if((Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(yt=Q.isWebGL3DRenderTarget?l.TEXTURE_3D:l.TEXTURE_2D_ARRAY),t.bindTexture(yt,Te.__webglTexture),Vn(yt,$),$.mipmaps&&$.mipmaps.length>0)for(let rn=0;rn<$.mipmaps.length;rn++)nn(ge.__webglFramebuffer[rn],Q,$,l.COLOR_ATTACHMENT0,yt,rn);else nn(ge.__webglFramebuffer,Q,$,l.COLOR_ATTACHMENT0,yt,0);N($)&&A(yt),t.unbindTexture()}Q.depthBuffer&&Jn(Q)},this.updateRenderTargetMipmap=function Qe(Q){const $=Q.textures;for(let ge=0,Te=$.length;ge<Te;ge++){const tt=$[ge];if(N(tt)){const Re=H(Q),en=i.get(tt).__webglTexture;t.bindTexture(Re,en),A(Re),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function ke(Q){if(Q.samples>0)if(!1===ct(Q)){const $=Q.textures,ge=Q.width,Te=Q.height;let tt=l.COLOR_BUFFER_BIT;const Re=Q.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,en=i.get(Q),yt=$.length>1;if(yt)for(let Zt=0;Zt<$.length;Zt++)t.bindFramebuffer(l.FRAMEBUFFER,en.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+Zt,l.RENDERBUFFER,null),t.bindFramebuffer(l.FRAMEBUFFER,en.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+Zt,l.TEXTURE_2D,null,0);t.bindFramebuffer(l.READ_FRAMEBUFFER,en.__webglMultisampledFramebuffer);const rn=Q.texture.mipmaps;t.bindFramebuffer(l.DRAW_FRAMEBUFFER,rn&&rn.length>0?en.__webglFramebuffer[0]:en.__webglFramebuffer);for(let Zt=0;Zt<$.length;Zt++){if(Q.resolveDepthBuffer&&(Q.depthBuffer&&(tt|=l.DEPTH_BUFFER_BIT),Q.stencilBuffer&&Q.resolveStencilBuffer&&(tt|=l.STENCIL_BUFFER_BIT)),yt){l.framebufferRenderbuffer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,en.__webglColorRenderbuffer[Zt]);const lt=i.get($[Zt]).__webglTexture;l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,lt,0)}l.blitFramebuffer(0,0,ge,Te,0,0,ge,Te,tt,l.NEAREST),!0===y&&($e.length=0,Be.length=0,$e.push(l.COLOR_ATTACHMENT0+Zt),Q.depthBuffer&&!1===Q.resolveDepthBuffer&&($e.push(Re),Be.push(Re),l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,Be)),l.invalidateFramebuffer(l.READ_FRAMEBUFFER,$e))}if(t.bindFramebuffer(l.READ_FRAMEBUFFER,null),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),yt)for(let Zt=0;Zt<$.length;Zt++){t.bindFramebuffer(l.FRAMEBUFFER,en.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+Zt,l.RENDERBUFFER,en.__webglColorRenderbuffer[Zt]);const lt=i.get($[Zt]).__webglTexture;t.bindFramebuffer(l.FRAMEBUFFER,en.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+Zt,l.TEXTURE_2D,lt,0)}t.bindFramebuffer(l.DRAW_FRAMEBUFFER,en.__webglMultisampledFramebuffer)}else Q.depthBuffer&&!1===Q.resolveDepthBuffer&&y&&l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,[Q.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT])},this.setupDepthRenderbuffer=Jn,this.setupFrameBufferTexture=nn,this.useMultisampledRTT=ct}function Rv(l,e){return{convert:function t(i,s=Sr){let a;const d=Kn.getTransfer(s);if(i===We)return l.UNSIGNED_BYTE;if(i===ws)return l.UNSIGNED_SHORT_4_4_4_4;if(i===ii)return l.UNSIGNED_SHORT_5_5_5_1;if(i===Un)return l.UNSIGNED_INT_5_9_9_9_REV;if(i===ri)return l.UNSIGNED_INT_10F_11F_11F_REV;if(i===ze)return l.BYTE;if(i===Ut)return l.SHORT;if(i===ni)return l.UNSIGNED_SHORT;if(i===Bi)return l.INT;if(i===Cn)return l.UNSIGNED_INT;if(i===si)return l.FLOAT;if(i===Qr)return l.HALF_FLOAT;if(i===us)return l.ALPHA;if(i===vi)return l.RGB;if(i===on)return l.RGBA;if(i===Us)return l.DEPTH_COMPONENT;if(i===fo)return l.DEPTH_STENCIL;if(i===ia)return l.RED;if(i===cl)return l.RED_INTEGER;if(i===Bs)return l.RG;if(i===ra)return l.RG_INTEGER;if(i===kn)return l.RGBA_INTEGER;if(i===hc||i===fc||i===sa||i===Cs)if(d===ci){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(i===hc)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===fc)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===sa)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Cs)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(i===hc)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===fc)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===sa)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Cs)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===ul||i===Mr||i===uu||i===dl){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(i===ul)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Mr)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===uu)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===dl)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===Zn||i===Zi||i===Ki){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(i===Zn||i===Zi)return d===ci?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===Ki)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(i===Ao||i===hr||i===Do||i===hl||i===Pa||i===ds||i===Rt||i===mn||i===Ri||i===Ci||i===hs||i===Wi||i===br||i===xi){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(i===Ao)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===hr)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Do)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===hl)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Pa)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===ds)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===Rt)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===mn)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===Ri)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===Ci)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===hs)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===Wi)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===br)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===xi)return d===ci?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===fl||i===es||i===dn){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(i===fl)return d===ci?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===es)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===dn)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(i===oa||i===aa||i===du||i===Pi){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(i===oa)return a.COMPRESSED_RED_RGTC1_EXT;if(i===aa)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===du)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Pi)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===_t?l.UNSIGNED_INT_24_8:void 0!==l[i]?l[i]:null}}}class Nb{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const i=new Hc(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,i=new io({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new kr(new Qu(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class tM extends _o{constructor(e,t){super();const i=this;let s=null,a=1,d=null,m="local-floor",y=1,v=null,M=null,b=null,E=null,C=null,D=null;const O=typeof XRWebGLBinding<"u",N=new Nb,A={},H=t.getContextAttributes();let k=null,V=null;const Z=[],q=[],ee=new Ce;let ne=null;const X=new ss;X.viewport=new G;const j=new ss;j.viewport=new G;const se=[X,j],me=new r0;let ve=null,we=null;function Ne(Ue){const Ke=q.indexOf(Ue.inputSource);if(-1===Ke)return;const nn=Z[Ke];void 0!==nn&&(nn.update(Ue.inputSource,Ue.frame,v||d),nn.dispatchEvent({type:Ue.type,data:Ue.inputSource}))}function De(){s.removeEventListener("select",Ne),s.removeEventListener("selectstart",Ne),s.removeEventListener("selectend",Ne),s.removeEventListener("squeeze",Ne),s.removeEventListener("squeezestart",Ne),s.removeEventListener("squeezeend",Ne),s.removeEventListener("end",De),s.removeEventListener("inputsourceschange",it);for(let Ue=0;Ue<Z.length;Ue++){const Ke=q[Ue];null!==Ke&&(q[Ue]=null,Z[Ue].disconnect(Ke))}ve=null,we=null,N.reset();for(const Ue in A)delete A[Ue];e.setRenderTarget(k),C=null,E=null,b=null,s=null,V=null,di.stop(),i.isPresenting=!1,e.setPixelRatio(ne),e.setSize(ee.width,ee.height,!1),i.dispatchEvent({type:"sessionend"})}function it(Ue){for(let Ke=0;Ke<Ue.removed.length;Ke++){const nn=Ue.removed[Ke],hn=q.indexOf(nn);hn>=0&&(q[hn]=null,Z[hn].disconnect(nn))}for(let Ke=0;Ke<Ue.added.length;Ke++){const nn=Ue.added[Ke];let hn=q.indexOf(nn);if(-1===hn){for(let Jn=0;Jn<Z.length;Jn++){if(Jn>=q.length){q.push(nn),hn=Jn;break}if(null===q[Jn]){q[Jn]=nn,hn=Jn;break}}if(-1===hn)break}const sn=Z[hn];sn&&sn.connect(nn)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ue){let Ke=Z[Ue];return void 0===Ke&&(Ke=new os,Z[Ue]=Ke),Ke.getTargetRaySpace()},this.getControllerGrip=function(Ue){let Ke=Z[Ue];return void 0===Ke&&(Ke=new os,Z[Ue]=Ke),Ke.getGripSpace()},this.getHand=function(Ue){let Ke=Z[Ue];return void 0===Ke&&(Ke=new os,Z[Ue]=Ke),Ke.getHandSpace()},this.setFramebufferScaleFactor=function(Ue){a=Ue,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ue){m=Ue,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return v||d},this.setReferenceSpace=function(Ue){v=Ue},this.getBaseLayer=function(){return null!==E?E:C},this.getBinding=function(){return null===b&&O&&(b=new XRWebGLBinding(s,t)),b},this.getFrame=function(){return D},this.getSession=function(){return s},this.setSession=function(){var Ue=kf(function*(Ke){if(s=Ke,null!==s){if(k=e.getRenderTarget(),s.addEventListener("select",Ne),s.addEventListener("selectstart",Ne),s.addEventListener("selectend",Ne),s.addEventListener("squeeze",Ne),s.addEventListener("squeezestart",Ne),s.addEventListener("squeezeend",Ne),s.addEventListener("end",De),s.addEventListener("inputsourceschange",it),!0!==H.xrCompatible&&(yield t.makeXRCompatible()),ne=e.getPixelRatio(),e.getSize(ee),O&&"createProjectionLayer"in XRWebGLBinding.prototype){let hn=null,sn=null,Jn=null;H.depth&&(Jn=H.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,hn=H.stencil?fo:Us,sn=H.stencil?_t:Cn);const Fi={colorFormat:t.RGBA8,depthFormat:Jn,scaleFactor:a};b=this.getBinding(),E=b.createProjectionLayer(Fi),s.updateRenderState({layers:[E]}),e.setPixelRatio(1),e.setSize(E.textureWidth,E.textureHeight,!1),V=new _e(E.textureWidth,E.textureHeight,{format:on,type:We,depthTexture:new Jd(E.textureWidth,E.textureHeight,sn,void 0,void 0,void 0,void 0,void 0,void 0,hn),stencilBuffer:H.stencil,colorSpace:e.outputColorSpace,samples:H.antialias?4:0,resolveDepthBuffer:!1===E.ignoreDepthValues,resolveStencilBuffer:!1===E.ignoreDepthValues})}else C=new XRWebGLLayer(s,t,{antialias:H.antialias,alpha:!0,depth:H.depth,stencil:H.stencil,framebufferScaleFactor:a}),s.updateRenderState({baseLayer:C}),e.setPixelRatio(1),e.setSize(C.framebufferWidth,C.framebufferHeight,!1),V=new _e(C.framebufferWidth,C.framebufferHeight,{format:on,type:We,colorSpace:e.outputColorSpace,stencilBuffer:H.stencil,resolveDepthBuffer:!1===C.ignoreDepthValues,resolveStencilBuffer:!1===C.ignoreDepthValues});V.isXRRenderTarget=!0,this.setFoveation(y),v=null,d=yield s.requestReferenceSpace(m),di.setContext(s),di.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Ke){return Ue.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==s)return s.environmentBlendMode},this.getDepthTexture=function(){return N.getDepthTexture()};const Ie=new K,At=new K;function qt(Ue,Ke){null===Ke?Ue.matrixWorld.copy(Ue.matrix):Ue.matrixWorld.multiplyMatrices(Ke.matrixWorld,Ue.matrix),Ue.matrixWorldInverse.copy(Ue.matrixWorld).invert()}this.updateCamera=function(Ue){if(null===s)return;let Ke=Ue.near,nn=Ue.far;null!==N.texture&&(N.depthNear>0&&(Ke=N.depthNear),N.depthFar>0&&(nn=N.depthFar)),me.near=j.near=X.near=Ke,me.far=j.far=X.far=nn,(ve!==me.near||we!==me.far)&&(s.updateRenderState({depthNear:me.near,depthFar:me.far}),ve=me.near,we=me.far),me.layers.mask=6|Ue.layers.mask,X.layers.mask=3&me.layers.mask,j.layers.mask=5&me.layers.mask;const hn=Ue.parent,sn=me.cameras;qt(me,hn);for(let Jn=0;Jn<sn.length;Jn++)qt(sn[Jn],hn);2===sn.length?function zt(Ue,Ke,nn){Ie.setFromMatrixPosition(Ke.matrixWorld),At.setFromMatrixPosition(nn.matrixWorld);const hn=Ie.distanceTo(At),sn=Ke.projectionMatrix.elements,Jn=nn.projectionMatrix.elements,Fi=sn[14]/(sn[10]-1),re=sn[14]/(sn[10]+1),Qe=(sn[9]+1)/sn[5],$e=(sn[9]-1)/sn[5],Be=(sn[8]-1)/sn[0],ke=(Jn[8]+1)/Jn[0],Et=Fi*Be,ct=Fi*ke,bt=hn/(-Be+ke),Hn=bt*-Be;if(Ke.matrixWorld.decompose(Ue.position,Ue.quaternion,Ue.scale),Ue.translateX(Hn),Ue.translateZ(bt),Ue.matrixWorld.compose(Ue.position,Ue.quaternion,Ue.scale),Ue.matrixWorldInverse.copy(Ue.matrixWorld).invert(),-1===sn[10])Ue.projectionMatrix.copy(Ke.projectionMatrix),Ue.projectionMatrixInverse.copy(Ke.projectionMatrixInverse);else{const On=Fi+bt,Q=re+bt;Ue.projectionMatrix.makePerspective(Et-Hn,ct+(hn-Hn),Qe*re/Q*On,$e*re/Q*On,On,Q),Ue.projectionMatrixInverse.copy(Ue.projectionMatrix).invert()}}(me,X,j):me.projectionMatrix.copy(X.projectionMatrix),function Vn(Ue,Ke,nn){null===nn?Ue.matrix.copy(Ke.matrixWorld):(Ue.matrix.copy(nn.matrixWorld),Ue.matrix.invert(),Ue.matrix.multiply(Ke.matrixWorld)),Ue.matrix.decompose(Ue.position,Ue.quaternion,Ue.scale),Ue.updateMatrixWorld(!0),Ue.projectionMatrix.copy(Ke.projectionMatrix),Ue.projectionMatrixInverse.copy(Ke.projectionMatrixInverse),Ue.isPerspectiveCamera&&(Ue.fov=2*Vs*Math.atan(1/Ue.projectionMatrix.elements[5]),Ue.zoom=1)}(Ue,me,hn)},this.getCamera=function(){return me},this.getFoveation=function(){if(null!==E||null!==C)return y},this.setFoveation=function(Ue){y=Ue,null!==E&&(E.fixedFoveation=Ue),null!==C&&void 0!==C.fixedFoveation&&(C.fixedFoveation=Ue)},this.hasDepthSensing=function(){return null!==N.texture},this.getDepthSensingMesh=function(){return N.getMesh(me)},this.getCameraTexture=function(Ue){return A[Ue]};let ui=null;const di=new hy;di.setAnimationLoop(function Ti(Ue,Ke){if(M=Ke.getViewerPose(v||d),D=Ke,null!==M){const nn=M.views;null!==C&&(e.setRenderTargetFramebuffer(V,C.framebuffer),e.setRenderTarget(V));let hn=!1;nn.length!==me.cameras.length&&(me.cameras.length=0,hn=!0);for(let re=0;re<nn.length;re++){const Qe=nn[re];let $e=null;if(null!==C)$e=C.getViewport(Qe);else{const ke=b.getViewSubImage(E,Qe);$e=ke.viewport,0===re&&(e.setRenderTargetTextures(V,ke.colorTexture,ke.depthStencilTexture),e.setRenderTarget(V))}let Be=se[re];void 0===Be&&(Be=new ss,Be.layers.enable(re),Be.viewport=new G,se[re]=Be),Be.matrix.fromArray(Qe.transform.matrix),Be.matrix.decompose(Be.position,Be.quaternion,Be.scale),Be.projectionMatrix.fromArray(Qe.projectionMatrix),Be.projectionMatrixInverse.copy(Be.projectionMatrix).invert(),Be.viewport.set($e.x,$e.y,$e.width,$e.height),0===re&&(me.matrix.copy(Be.matrix),me.matrix.decompose(me.position,me.quaternion,me.scale)),!0===hn&&me.cameras.push(Be)}const sn=s.enabledFeatures;if(sn&&sn.includes("depth-sensing")&&"gpu-optimized"==s.depthUsage&&O){b=i.getBinding();const re=b.getDepthInformation(nn[0]);re&&re.isValid&&re.texture&&N.init(re,s.renderState)}if(sn&&sn.includes("camera-access")&&O){e.state.unbindTexture(),b=i.getBinding();for(let re=0;re<nn.length;re++){const Qe=nn[re].camera;if(Qe){let $e=A[Qe];$e||($e=new Hc,A[Qe]=$e);const Be=b.getCameraImage(Qe);$e.sourceTexture=Be}}}}for(let nn=0;nn<Z.length;nn++){const hn=q[nn],sn=Z[nn];null!==hn&&void 0!==sn&&sn.update(hn,Ke,v||d)}ui&&ui(Ue,Ke),Ke.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Ke}),D=null}),this.setAnimationLoop=function(Ue){ui=Ue},this.dispose=function(){}}}const fd=new Lo,nM=new yn;function iM(l,e){function t(N,A){!0===N.matrixAutoUpdate&&N.updateMatrix(),A.value.copy(N.matrix)}function a(N,A){N.opacity.value=A.opacity,A.color&&N.diffuse.value.copy(A.color),A.emissive&&N.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(N.map.value=A.map,t(A.map,N.mapTransform)),A.alphaMap&&(N.alphaMap.value=A.alphaMap,t(A.alphaMap,N.alphaMapTransform)),A.bumpMap&&(N.bumpMap.value=A.bumpMap,t(A.bumpMap,N.bumpMapTransform),N.bumpScale.value=A.bumpScale,A.side===fn&&(N.bumpScale.value*=-1)),A.normalMap&&(N.normalMap.value=A.normalMap,t(A.normalMap,N.normalMapTransform),N.normalScale.value.copy(A.normalScale),A.side===fn&&N.normalScale.value.negate()),A.displacementMap&&(N.displacementMap.value=A.displacementMap,t(A.displacementMap,N.displacementMapTransform),N.displacementScale.value=A.displacementScale,N.displacementBias.value=A.displacementBias),A.emissiveMap&&(N.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,N.emissiveMapTransform)),A.specularMap&&(N.specularMap.value=A.specularMap,t(A.specularMap,N.specularMapTransform)),A.alphaTest>0&&(N.alphaTest.value=A.alphaTest);const H=e.get(A),k=H.envMap,V=H.envMapRotation;k&&(N.envMap.value=k,fd.copy(V),fd.x*=-1,fd.y*=-1,fd.z*=-1,k.isCubeTexture&&!1===k.isRenderTargetTexture&&(fd.y*=-1,fd.z*=-1),N.envMapRotation.value.setFromMatrix4(nM.makeRotationFromEuler(fd)),N.flipEnvMap.value=k.isCubeTexture&&!1===k.isRenderTargetTexture?-1:1,N.reflectivity.value=A.reflectivity,N.ior.value=A.ior,N.refractionRatio.value=A.refractionRatio),A.lightMap&&(N.lightMap.value=A.lightMap,N.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,N.lightMapTransform)),A.aoMap&&(N.aoMap.value=A.aoMap,N.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,N.aoMapTransform))}return{refreshFogUniforms:function i(N,A){A.color.getRGB(N.fogColor.value,Qh(l)),A.isFog?(N.fogNear.value=A.near,N.fogFar.value=A.far):A.isFogExp2&&(N.fogDensity.value=A.density)},refreshMaterialUniforms:function s(N,A,H,k,V){A.isMeshBasicMaterial||A.isMeshLambertMaterial?a(N,A):A.isMeshToonMaterial?(a(N,A),function b(N,A){A.gradientMap&&(N.gradientMap.value=A.gradientMap)}(N,A)):A.isMeshPhongMaterial?(a(N,A),function M(N,A){N.specular.value.copy(A.specular),N.shininess.value=Math.max(A.shininess,1e-4)}(N,A)):A.isMeshStandardMaterial?(a(N,A),function E(N,A){N.metalness.value=A.metalness,A.metalnessMap&&(N.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,N.metalnessMapTransform)),N.roughness.value=A.roughness,A.roughnessMap&&(N.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,N.roughnessMapTransform)),A.envMap&&(N.envMapIntensity.value=A.envMapIntensity)}(N,A),A.isMeshPhysicalMaterial&&function C(N,A,H){N.ior.value=A.ior,A.sheen>0&&(N.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),N.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(N.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,N.sheenColorMapTransform)),A.sheenRoughnessMap&&(N.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,N.sheenRoughnessMapTransform))),A.clearcoat>0&&(N.clearcoat.value=A.clearcoat,N.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(N.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,N.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(N.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,N.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(N.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,N.clearcoatNormalMapTransform),N.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===fn&&N.clearcoatNormalScale.value.negate())),A.dispersion>0&&(N.dispersion.value=A.dispersion),A.iridescence>0&&(N.iridescence.value=A.iridescence,N.iridescenceIOR.value=A.iridescenceIOR,N.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],N.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(N.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,N.iridescenceMapTransform)),A.iridescenceThicknessMap&&(N.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,N.iridescenceThicknessMapTransform))),A.transmission>0&&(N.transmission.value=A.transmission,N.transmissionSamplerMap.value=H.texture,N.transmissionSamplerSize.value.set(H.width,H.height),A.transmissionMap&&(N.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,N.transmissionMapTransform)),N.thickness.value=A.thickness,A.thicknessMap&&(N.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,N.thicknessMapTransform)),N.attenuationDistance.value=A.attenuationDistance,N.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(N.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(N.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,N.anisotropyMapTransform))),N.specularIntensity.value=A.specularIntensity,N.specularColor.value.copy(A.specularColor),A.specularColorMap&&(N.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,N.specularColorMapTransform)),A.specularIntensityMap&&(N.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,N.specularIntensityMapTransform))}(N,A,V)):A.isMeshMatcapMaterial?(a(N,A),function D(N,A){A.matcap&&(N.matcap.value=A.matcap)}(N,A)):A.isMeshDepthMaterial?a(N,A):A.isMeshDistanceMaterial?(a(N,A),function O(N,A){const H=e.get(A).light;N.referencePosition.value.setFromMatrixPosition(H.matrixWorld),N.nearDistance.value=H.shadow.camera.near,N.farDistance.value=H.shadow.camera.far}(N,A)):A.isMeshNormalMaterial?a(N,A):A.isLineBasicMaterial?(function d(N,A){N.diffuse.value.copy(A.color),N.opacity.value=A.opacity,A.map&&(N.map.value=A.map,t(A.map,N.mapTransform))}(N,A),A.isLineDashedMaterial&&function m(N,A){N.dashSize.value=A.dashSize,N.totalSize.value=A.dashSize+A.gapSize,N.scale.value=A.scale}(N,A)):A.isPointsMaterial?function y(N,A,H,k){N.diffuse.value.copy(A.color),N.opacity.value=A.opacity,N.size.value=A.size*H,N.scale.value=.5*k,A.map&&(N.map.value=A.map,t(A.map,N.uvTransform)),A.alphaMap&&(N.alphaMap.value=A.alphaMap,t(A.alphaMap,N.alphaMapTransform)),A.alphaTest>0&&(N.alphaTest.value=A.alphaTest)}(N,A,H,k):A.isSpriteMaterial?function v(N,A){N.diffuse.value.copy(A.color),N.opacity.value=A.opacity,N.rotation.value=A.rotation,A.map&&(N.map.value=A.map,t(A.map,N.mapTransform)),A.alphaMap&&(N.alphaMap.value=A.alphaMap,t(A.alphaMap,N.alphaMapTransform)),A.alphaTest>0&&(N.alphaTest.value=A.alphaTest)}(N,A):A.isShadowMaterial?(N.color.value.copy(A.color),N.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}}}function rM(l,e,t,i){let s={},a={},d=[];const m=l.getParameter(l.MAX_UNIFORM_BUFFER_BINDINGS);function C(H,k,V,Z){const q=H.value,ee=k+"_"+V;if(void 0===Z[ee])return Z[ee]="number"==typeof q||"boolean"==typeof q?q:q.clone(),!0;{const ne=Z[ee];if("number"==typeof q||"boolean"==typeof q){if(ne!==q)return Z[ee]=q,!0}else if(!1===ne.equals(q))return ne.copy(q),!0}return!1}function O(H){const k={boundary:0,storage:0};return"number"==typeof H||"boolean"==typeof H?(k.boundary=4,k.storage=4):H.isVector2?(k.boundary=8,k.storage=8):H.isVector3||H.isColor?(k.boundary=16,k.storage=12):H.isVector4?(k.boundary=16,k.storage=16):H.isMatrix3?(k.boundary=48,k.storage=48):H.isMatrix4?(k.boundary=64,k.storage=64):H.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",H),k}function N(H){const k=H.target;k.removeEventListener("dispose",N);const V=d.indexOf(k.__bindingPointIndex);d.splice(V,1),l.deleteBuffer(s[k.id]),delete s[k.id],delete a[k.id]}return{bind:function y(H,k){i.uniformBlockBinding(H,k.program)},update:function v(H,k){let V=s[H.id];void 0===V&&(function D(H){const k=H.uniforms;let V=0;for(let ee=0,ne=k.length;ee<ne;ee++){const X=Array.isArray(k[ee])?k[ee]:[k[ee]];for(let j=0,se=X.length;j<se;j++){const me=X[j],ve=Array.isArray(me.value)?me.value:[me.value];for(let we=0,Ne=ve.length;we<Ne;we++){const it=O(ve[we]),Ie=V%16,At=Ie%it.boundary,zt=Ie+At;V+=At,0!==zt&&16-zt<it.storage&&(V+=16-zt),me.__data=new Float32Array(it.storage/Float32Array.BYTES_PER_ELEMENT),me.__offset=V,V+=it.storage}}}const q=V%16;q>0&&(V+=16-q),H.__size=V,H.__cache={}}(H),V=function M(H){const k=function b(){for(let H=0;H<m;H++)if(-1===d.indexOf(H))return d.push(H),H;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();H.__bindingPointIndex=k;const V=l.createBuffer(),Z=H.__size,q=H.usage;return l.bindBuffer(l.UNIFORM_BUFFER,V),l.bufferData(l.UNIFORM_BUFFER,Z,q),l.bindBuffer(l.UNIFORM_BUFFER,null),l.bindBufferBase(l.UNIFORM_BUFFER,k,V),V}(H),s[H.id]=V,H.addEventListener("dispose",N)),i.updateUBOMapping(H,k.program);const q=e.render.frame;a[H.id]!==q&&(function E(H){const V=H.uniforms,Z=H.__cache;l.bindBuffer(l.UNIFORM_BUFFER,s[H.id]);for(let q=0,ee=V.length;q<ee;q++){const ne=Array.isArray(V[q])?V[q]:[V[q]];for(let X=0,j=ne.length;X<j;X++){const se=ne[X];if(!0===C(se,q,X,Z)){const me=se.__offset,ve=Array.isArray(se.value)?se.value:[se.value];let we=0;for(let Ne=0;Ne<ve.length;Ne++){const De=ve[Ne],it=O(De);"number"==typeof De||"boolean"==typeof De?(se.__data[0]=De,l.bufferSubData(l.UNIFORM_BUFFER,me+we,se.__data)):De.isMatrix3?(se.__data[0]=De.elements[0],se.__data[1]=De.elements[1],se.__data[2]=De.elements[2],se.__data[3]=0,se.__data[4]=De.elements[3],se.__data[5]=De.elements[4],se.__data[6]=De.elements[5],se.__data[7]=0,se.__data[8]=De.elements[6],se.__data[9]=De.elements[7],se.__data[10]=De.elements[8],se.__data[11]=0):(De.toArray(se.__data,we),we+=it.storage/Float32Array.BYTES_PER_ELEMENT)}l.bufferSubData(l.UNIFORM_BUFFER,me,se.__data)}}}l.bindBuffer(l.UNIFORM_BUFFER,null)}(H),a[H.id]=q)},dispose:function A(){for(const H in s)l.deleteBuffer(s[H]);d=[],s={},a={}}}}class sM{constructor(e={}){const{canvas:t=bd(),context:i=null,depth:s=!0,stencil:a=!1,alpha:d=!1,antialias:m=!1,premultipliedAlpha:y=!0,preserveDrawingBuffer:v=!1,powerPreference:M="default",failIfMajorPerformanceCaveat:b=!1,reversedDepthBuffer:E=!1}=e;let C;if(this.isWebGLRenderer=!0,null!==i){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");C=i.getContextAttributes().alpha}else C=d;const D=new Uint32Array(4),O=new Int32Array(4);let N=null,A=null;const H=[],k=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Li,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const V=this;let Z=!1;this._outputColorSpace=gi;let q=0,ee=0,ne=null,X=-1,j=null;const se=new G,me=new G;let ve=null;const we=new Nt(0);let Ne=0,De=t.width,it=t.height,Ie=1,At=null,zt=null;const qt=new G(0,0,De,it),Vn=new G(0,0,De,it);let ui=!1;const Ti=new kl;let di=!1,Ue=!1;const Ke=new yn,nn=new K,hn=new G,sn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Jn=!1;function Fi(){return null===ne?Ie:1}let $e,Be,ke,Et,ct,bt,Hn,On,Q,$,ge,Te,tt,Re,en,yt,rn,Zt,lt,Vt,Dn,an,Ot,Gn,re=i;function Qe(Y,de){return t.getContext(Y,de)}try{const Y={alpha:!0,depth:s,stencil:a,antialias:m,premultipliedAlpha:y,preserveDrawingBuffer:v,powerPreference:M,failIfMajorPerformanceCaveat:b};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${U}`),t.addEventListener("webglcontextlost",Dt,!1),t.addEventListener("webglcontextrestored",Kt,!1),t.addEventListener("webglcontextcreationerror",ot,!1),null===re){const de="webgl2";if(re=Qe(de,Y),null===re)throw Qe(de)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Y){throw console.error("THREE.WebGLRenderer: "+Y.message),Y}function ue(){$e=new Ch(re),$e.init(),an=new Rv(re,$e),Be=new Jy(re,$e,e,an),ke=new Iv(re,$e),Be.reversedDepthBuffer&&E&&ke.buffers.depth.setReversed(!0),Et=new cm(re),ct=new Rb,bt=new Pb(re,$e,ke,ct,Be,an,Et),Hn=new ev(V),On=new cx(V),Q=new v0(re),Ot=new ax(re,Q),$=new ux(re,Q,Et,Ot),ge=new wb(re,$,Q,Et),lt=new _r(re,Be,bt),yt=new Qy(ct),Te=new Xx(V,Hn,On,$e,Be,Ot,yt),tt=new iM(V,ct),Re=new a_,en=new Dv($e),Zt=new ox(V,Hn,On,ke,ge,C,y),rn=new Kx(V,ge,Be),Gn=new rM(re,Et,Be,ke),Vt=new lx(re,$e,Et),Dn=new lm(re,$e,Et),Et.programs=Te.programs,V.capabilities=Be,V.extensions=$e,V.properties=ct,V.renderLists=Re,V.shadowMap=rn,V.state=ke,V.info=Et}ue();const ft=new tM(V,re);function Dt(Y){Y.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Z=!0}function Kt(){console.log("THREE.WebGLRenderer: Context Restored."),Z=!1;const Y=Et.autoReset,de=rn.enabled,xe=rn.autoUpdate,Me=rn.needsUpdate,fe=rn.type;ue(),Et.autoReset=Y,rn.enabled=de,rn.autoUpdate=xe,rn.needsUpdate=Me,rn.type=fe}function ot(Y){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Y.statusMessage)}function Ye(Y){const de=Y.target;de.removeEventListener("dispose",Ye),function ln(Y){(function zn(Y){const de=ct.get(Y).programs;void 0!==de&&(de.forEach(function(xe){Te.releaseProgram(xe)}),Y.isShaderMaterial&&Te.releaseShaderCache(Y))})(Y),ct.remove(Y)}(de)}function Yi(Y,de,xe){!0===Y.transparent&&Y.side===nt&&!1===Y.forceSinglePass?(Y.side=fn,Y.needsUpdate=!0,Ph(Y,de,xe),Y.side=pt,Y.needsUpdate=!0,Ph(Y,de,xe),Y.side=nt):Ph(Y,de,xe)}this.xr=ft,this.getContext=function(){return re},this.getContextAttributes=function(){return re.getContextAttributes()},this.forceContextLoss=function(){const Y=$e.get("WEBGL_lose_context");Y&&Y.loseContext()},this.forceContextRestore=function(){const Y=$e.get("WEBGL_lose_context");Y&&Y.restoreContext()},this.getPixelRatio=function(){return Ie},this.setPixelRatio=function(Y){void 0!==Y&&(Ie=Y,this.setSize(De,it,!1))},this.getSize=function(Y){return Y.set(De,it)},this.setSize=function(Y,de,xe=!0){ft.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(De=Y,it=de,t.width=Math.floor(Y*Ie),t.height=Math.floor(de*Ie),!0===xe&&(t.style.width=Y+"px",t.style.height=de+"px"),this.setViewport(0,0,Y,de))},this.getDrawingBufferSize=function(Y){return Y.set(De*Ie,it*Ie).floor()},this.setDrawingBufferSize=function(Y,de,xe){De=Y,it=de,Ie=xe,t.width=Math.floor(Y*xe),t.height=Math.floor(de*xe),this.setViewport(0,0,Y,de)},this.getCurrentViewport=function(Y){return Y.copy(se)},this.getViewport=function(Y){return Y.copy(qt)},this.setViewport=function(Y,de,xe,Me){Y.isVector4?qt.set(Y.x,Y.y,Y.z,Y.w):qt.set(Y,de,xe,Me),ke.viewport(se.copy(qt).multiplyScalar(Ie).round())},this.getScissor=function(Y){return Y.copy(Vn)},this.setScissor=function(Y,de,xe,Me){Y.isVector4?Vn.set(Y.x,Y.y,Y.z,Y.w):Vn.set(Y,de,xe,Me),ke.scissor(me.copy(Vn).multiplyScalar(Ie).round())},this.getScissorTest=function(){return ui},this.setScissorTest=function(Y){ke.setScissorTest(ui=Y)},this.setOpaqueSort=function(Y){At=Y},this.setTransparentSort=function(Y){zt=Y},this.getClearColor=function(Y){return Y.copy(Zt.getClearColor())},this.setClearColor=function(){Zt.setClearColor(...arguments)},this.getClearAlpha=function(){return Zt.getClearAlpha()},this.setClearAlpha=function(){Zt.setClearAlpha(...arguments)},this.clear=function(Y=!0,de=!0,xe=!0){let Me=0;if(Y){let fe=!1;if(null!==ne){const ut=ne.texture.format;fe=ut===kn||ut===ra||ut===cl}if(fe){const ut=ne.texture.type,Lt=ut===We||ut===Cn||ut===ni||ut===_t||ut===ws||ut===ii,tn=Zt.getClearColor(),jt=Zt.getClearAlpha(),cn=tn.r,vn=tn.g,xn=tn.b;Lt?(D[0]=cn,D[1]=vn,D[2]=xn,D[3]=jt,re.clearBufferuiv(re.COLOR,0,D)):(O[0]=cn,O[1]=vn,O[2]=xn,O[3]=jt,re.clearBufferiv(re.COLOR,0,O))}else Me|=re.COLOR_BUFFER_BIT}de&&(Me|=re.DEPTH_BUFFER_BIT),xe&&(Me|=re.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),re.clear(Me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Dt,!1),t.removeEventListener("webglcontextrestored",Kt,!1),t.removeEventListener("webglcontextcreationerror",ot,!1),Zt.dispose(),Re.dispose(),en.dispose(),ct.dispose(),Hn.dispose(),On.dispose(),ge.dispose(),Ot.dispose(),Gn.dispose(),Te.dispose(),ft.dispose(),ft.removeEventListener("sessionstart",al),ft.removeEventListener("sessionend",vM),pd.stop()},this.renderBufferDirect=function(Y,de,xe,Me,fe,ut){null===de&&(de=sn);const Lt=fe.isMesh&&fe.matrixWorld.determinant()<0,tn=function Jo(Y,de,xe,Me,fe){!0!==de.isScene&&(de=sn),bt.resetTextureUnits();const ut=de.fog,tn=null===ne?V.outputColorSpace:!0===ne.isXRRenderTarget?ne.texture.colorSpace:As,jt=(Me.isMeshStandardMaterial?On:Hn).get(Me.envMap||(Me.isMeshStandardMaterial?de.environment:null)),cn=!0===Me.vertexColors&&!!xe.attributes.color&&4===xe.attributes.color.itemSize,vn=!!xe.attributes.tangent&&(!!Me.normalMap||Me.anisotropy>0),xn=!!xe.morphAttributes.position,ei=!!xe.morphAttributes.normal,wi=!!xe.morphAttributes.color;let Nr=Li;Me.toneMapped&&(null===ne||!0===ne.isXRRenderTarget)&&(Nr=V.toneMapping);const Hi=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,zi=void 0!==Hi?Hi.length:0,En=ct.get(Me),cr=A.state.lights;!0!==di||!0!==Ue&&Y===j||yt.setState(Me,Y,Y===j&&Me.id===X);let bi=!1;Me.version===En.__version?(En.needsLights&&En.lightsStateVersion!==cr.state.version||En.outputColorSpace!==tn||fe.isBatchedMesh&&!1===En.batching||!fe.isBatchedMesh&&!0===En.batching||fe.isBatchedMesh&&!0===En.batchingColor&&null===fe.colorTexture||fe.isBatchedMesh&&!1===En.batchingColor&&null!==fe.colorTexture||fe.isInstancedMesh&&!1===En.instancing||!fe.isInstancedMesh&&!0===En.instancing||fe.isSkinnedMesh&&!1===En.skinning||!fe.isSkinnedMesh&&!0===En.skinning||fe.isInstancedMesh&&!0===En.instancingColor&&null===fe.instanceColor||fe.isInstancedMesh&&!1===En.instancingColor&&null!==fe.instanceColor||fe.isInstancedMesh&&!0===En.instancingMorph&&null===fe.morphTexture||fe.isInstancedMesh&&!1===En.instancingMorph&&null!==fe.morphTexture||En.envMap!==jt||!0===Me.fog&&En.fog!==ut||void 0!==En.numClippingPlanes&&(En.numClippingPlanes!==yt.numPlanes||En.numIntersection!==yt.numIntersection)||En.vertexAlphas!==cn||En.vertexTangents!==vn||En.morphTargets!==xn||En.morphNormals!==ei||En.morphColors!==wi||En.toneMapping!==Nr||En.morphTargetsCount!==zi)&&(bi=!0):(bi=!0,En.__version=Me.version);let lo=En.currentProgram;!0===bi&&(lo=Ph(Me,de,fe));let Zf=!1,co=!1,Kf=!1;const nr=lo.getUniforms(),Aa=En.uniforms;if(ke.useProgram(lo.program)&&(Zf=!0,co=!0,Kf=!0),Me.id!==X&&(X=Me.id,co=!0),Zf||j!==Y){ke.buffers.depth.getReversed()&&!0!==Y.reversedDepth&&(Y._reversedDepth=!0,Y.updateProjectionMatrix()),nr.setValue(re,"projectionMatrix",Y.projectionMatrix),nr.setValue(re,"viewMatrix",Y.matrixWorldInverse);const qs=nr.map.cameraPosition;void 0!==qs&&qs.setValue(re,nn.setFromMatrixPosition(Y.matrixWorld)),Be.logarithmicDepthBuffer&&nr.setValue(re,"logDepthBufFC",2/(Math.log(Y.far+1)/Math.LN2)),(Me.isMeshPhongMaterial||Me.isMeshToonMaterial||Me.isMeshLambertMaterial||Me.isMeshBasicMaterial||Me.isMeshStandardMaterial||Me.isShaderMaterial)&&nr.setValue(re,"isOrthographic",!0===Y.isOrthographicCamera),j!==Y&&(j=Y,co=!0,Kf=!0)}if(fe.isSkinnedMesh){nr.setOptional(re,fe,"bindMatrix"),nr.setOptional(re,fe,"bindMatrixInverse");const Ls=fe.skeleton;Ls&&(null===Ls.boneTexture&&Ls.computeBoneTexture(),nr.setValue(re,"boneTexture",Ls.boneTexture,bt))}fe.isBatchedMesh&&(nr.setOptional(re,fe,"batchingTexture"),nr.setValue(re,"batchingTexture",fe._matricesTexture,bt),nr.setOptional(re,fe,"batchingIdTexture"),nr.setValue(re,"batchingIdTexture",fe._indirectTexture,bt),nr.setOptional(re,fe,"batchingColorTexture"),null!==fe._colorsTexture&&nr.setValue(re,"batchingColorTexture",fe._colorsTexture,bt));const uo=xe.morphAttributes;if((void 0!==uo.position||void 0!==uo.normal||void 0!==uo.color)&&lt.update(fe,xe,lo),(co||En.receiveShadow!==fe.receiveShadow)&&(En.receiveShadow=fe.receiveShadow,nr.setValue(re,"receiveShadow",fe.receiveShadow)),Me.isMeshGouraudMaterial&&null!==Me.envMap&&(Aa.envMap.value=jt,Aa.flipEnvMap.value=jt.isCubeTexture&&!1===jt.isRenderTargetTexture?-1:1),Me.isMeshStandardMaterial&&null===Me.envMap&&null!==de.environment&&(Aa.envMapIntensity.value=de.environmentIntensity),co&&(nr.setValue(re,"toneMappingExposure",V.toneMappingExposure),En.needsLights&&function bM(Y,de){Y.ambientLightColor.needsUpdate=de,Y.lightProbe.needsUpdate=de,Y.directionalLights.needsUpdate=de,Y.directionalLightShadows.needsUpdate=de,Y.pointLights.needsUpdate=de,Y.pointLightShadows.needsUpdate=de,Y.spotLights.needsUpdate=de,Y.spotLightShadows.needsUpdate=de,Y.rectAreaLights.needsUpdate=de,Y.hemisphereLights.needsUpdate=de}(Aa,Kf),ut&&!0===Me.fog&&tt.refreshFogUniforms(Aa,ut),tt.refreshMaterialUniforms(Aa,Me,Ie,it,A.state.transmissionRenderTarget[Y.id]),jf.upload(re,jv(En),Aa,bt)),Me.isShaderMaterial&&!0===Me.uniformsNeedUpdate&&(jf.upload(re,jv(En),Aa,bt),Me.uniformsNeedUpdate=!1),Me.isSpriteMaterial&&nr.setValue(re,"center",fe.center),nr.setValue(re,"modelViewMatrix",fe.modelViewMatrix),nr.setValue(re,"normalMatrix",fe.normalMatrix),nr.setValue(re,"modelMatrix",fe.matrixWorld),Me.isShaderMaterial||Me.isRawShaderMaterial){const Ls=Me.uniformsGroups;for(let qs=0,Sm=Ls.length;qs<Sm;qs++){const au=Ls[qs];Gn.update(au,lo),Gn.bind(au,lo)}}return lo}(Y,de,xe,Me,fe);ke.setMaterial(Me,Lt);let jt=xe.index,cn=1;if(!0===Me.wireframe){if(jt=$.getWireframeAttribute(xe),void 0===jt)return;cn=2}const vn=xe.drawRange,xn=xe.attributes.position;let ei=vn.start*cn,wi=(vn.start+vn.count)*cn;null!==ut&&(ei=Math.max(ei,ut.start*cn),wi=Math.min(wi,(ut.start+ut.count)*cn)),null!==jt?(ei=Math.max(ei,0),wi=Math.min(wi,jt.count)):null!=xn&&(ei=Math.max(ei,0),wi=Math.min(wi,xn.count));const Nr=wi-ei;if(Nr<0||Nr===1/0)return;Ot.setup(fe,Me,tn,xe,jt);let Hi,zi=Vt;if(null!==jt&&(Hi=Q.get(jt),zi=Dn,zi.setIndex(Hi)),fe.isMesh)!0===Me.wireframe?(ke.setLineWidth(Me.wireframeLinewidth*Fi()),zi.setMode(re.LINES)):zi.setMode(re.TRIANGLES);else if(fe.isLine){let En=Me.linewidth;void 0===En&&(En=1),ke.setLineWidth(En*Fi()),zi.setMode(fe.isLineSegments?re.LINES:fe.isLineLoop?re.LINE_LOOP:re.LINE_STRIP)}else fe.isPoints?zi.setMode(re.POINTS):fe.isSprite&&zi.setMode(re.TRIANGLES);if(fe.isBatchedMesh)if(null!==fe._multiDrawInstances)bl("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),zi.renderMultiDrawInstances(fe._multiDrawStarts,fe._multiDrawCounts,fe._multiDrawCount,fe._multiDrawInstances);else if($e.get("WEBGL_multi_draw"))zi.renderMultiDraw(fe._multiDrawStarts,fe._multiDrawCounts,fe._multiDrawCount);else{const En=fe._multiDrawStarts,cr=fe._multiDrawCounts,bi=fe._multiDrawCount,lo=jt?Q.get(jt).bytesPerElement:1,Zf=ct.get(Me).currentProgram.getUniforms();for(let co=0;co<bi;co++)Zf.setValue(re,"_gl_DrawID",co),zi.render(En[co]/lo,cr[co])}else if(fe.isInstancedMesh)zi.renderInstances(ei,Nr,fe.count);else if(xe.isInstancedBufferGeometry){const cr=Math.min(xe.instanceCount,void 0!==xe._maxInstanceCount?xe._maxInstanceCount:1/0);zi.renderInstances(ei,Nr,cr)}else zi.render(ei,Nr)},this.compile=function(Y,de,xe=null){null===xe&&(xe=Y),A=en.get(xe),A.init(de),k.push(A),xe.traverseVisible(function(fe){fe.isLight&&fe.layers.test(de.layers)&&(A.pushLight(fe),fe.castShadow&&A.pushShadow(fe))}),Y!==xe&&Y.traverseVisible(function(fe){fe.isLight&&fe.layers.test(de.layers)&&(A.pushLight(fe),fe.castShadow&&A.pushShadow(fe))}),A.setupLights();const Me=new Set;return Y.traverse(function(fe){if(!(fe.isMesh||fe.isPoints||fe.isLine||fe.isSprite))return;const ut=fe.material;if(ut)if(Array.isArray(ut))for(let Lt=0;Lt<ut.length;Lt++){const tn=ut[Lt];Yi(tn,xe,fe),Me.add(tn)}else Yi(ut,xe,fe),Me.add(ut)}),A=k.pop(),Me},this.compileAsync=function(Y,de,xe=null){const Me=this.compile(Y,de,xe);return new Promise(fe=>{function ut(){Me.forEach(function(Lt){ct.get(Lt).currentProgram.isReady()&&Me.delete(Lt)}),0!==Me.size?setTimeout(ut,10):fe(Y)}null!==$e.get("KHR_parallel_shader_compile")?ut():setTimeout(ut,10)})};let Ai=null;function al(){pd.stop()}function vM(){pd.start()}const pd=new hy;function bm(Y,de,xe,Me){if(!1===Y.visible)return;if(Y.layers.test(de.layers))if(Y.isGroup)xe=Y.renderOrder;else if(Y.isLOD)!0===Y.autoUpdate&&Y.update(de);else if(Y.isLight)A.pushLight(Y),Y.castShadow&&A.pushShadow(Y);else if(Y.isSprite){if(!Y.frustumCulled||Ti.intersectsSprite(Y)){Me&&hn.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(Ke);const Lt=ge.update(Y),tn=Y.material;tn.visible&&N.push(Y,Lt,tn,xe,hn.z,null)}}else if((Y.isMesh||Y.isLine||Y.isPoints)&&(!Y.frustumCulled||Ti.intersectsObject(Y))){const Lt=ge.update(Y),tn=Y.material;if(Me&&(void 0!==Y.boundingSphere?(null===Y.boundingSphere&&Y.computeBoundingSphere(),hn.copy(Y.boundingSphere.center)):(null===Lt.boundingSphere&&Lt.computeBoundingSphere(),hn.copy(Lt.boundingSphere.center)),hn.applyMatrix4(Y.matrixWorld).applyMatrix4(Ke)),Array.isArray(tn)){const jt=Lt.groups;for(let cn=0,vn=jt.length;cn<vn;cn++){const xn=jt[cn],ei=tn[xn.materialIndex];ei&&ei.visible&&N.push(Y,Lt,ei,xe,hn.z,xn)}}else tn.visible&&N.push(Y,Lt,tn,xe,hn.z,null)}const ut=Y.children;for(let Lt=0,tn=ut.length;Lt<tn;Lt++)bm(ut[Lt],de,xe,Me)}function m_(Y,de,xe,Me){const fe=Y.opaque,ut=Y.transmissive,Lt=Y.transparent;A.setupLightsView(xe),!0===di&&yt.setGlobalState(V.clippingPlanes,xe),Me&&ke.viewport(se.copy(Me)),fe.length>0&&ao(fe,de,xe),ut.length>0&&ao(ut,de,xe),Lt.length>0&&ao(Lt,de,xe),ke.buffers.depth.setTest(!0),ke.buffers.depth.setMask(!0),ke.buffers.color.setMask(!0),ke.setPolygonOffset(!1)}function xM(Y,de,xe,Me){if(null!==(!0===xe.isScene?xe.overrideMaterial:null))return;void 0===A.state.transmissionRenderTarget[Me.id]&&(A.state.transmissionRenderTarget[Me.id]=new _e(1,1,{generateMipmaps:!0,type:$e.has("EXT_color_buffer_half_float")||$e.has("EXT_color_buffer_float")?Qr:We,minFilter:oe,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Kn.workingColorSpace}));const ut=A.state.transmissionRenderTarget[Me.id],Lt=Me.viewport||se;ut.setSize(Lt.z*V.transmissionResolutionScale,Lt.w*V.transmissionResolutionScale);const tn=V.getRenderTarget(),jt=V.getActiveCubeFace(),cn=V.getActiveMipmapLevel();V.setRenderTarget(ut),V.getClearColor(we),Ne=V.getClearAlpha(),Ne<1&&V.setClearColor(16777215,.5),V.clear(),Jn&&Zt.render(xe);const vn=V.toneMapping;V.toneMapping=Li;const xn=Me.viewport;if(void 0!==Me.viewport&&(Me.viewport=void 0),A.setupLightsView(Me),!0===di&&yt.setGlobalState(V.clippingPlanes,Me),ao(Y,xe,Me),bt.updateMultisampleRenderTarget(ut),bt.updateRenderTargetMipmap(ut),!1===$e.has("WEBGL_multisampled_render_to_texture")){let ei=!1;for(let wi=0,Nr=de.length;wi<Nr;wi++){const Hi=de[wi],zi=Hi.object,En=Hi.geometry,cr=Hi.material,bi=Hi.group;if(cr.side===nt&&zi.layers.test(Me.layers)){const lo=cr.side;cr.side=fn,cr.needsUpdate=!0,$v(zi,xe,Me,En,cr,bi),cr.side=lo,cr.needsUpdate=!0,ei=!0}}!0===ei&&(bt.updateMultisampleRenderTarget(ut),bt.updateRenderTargetMipmap(ut))}V.setRenderTarget(tn,jt,cn),V.setClearColor(we,Ne),void 0!==xn&&(Me.viewport=xn),V.toneMapping=vn}function ao(Y,de,xe){const Me=!0===de.isScene?de.overrideMaterial:null;for(let fe=0,ut=Y.length;fe<ut;fe++){const Lt=Y[fe],tn=Lt.object,jt=Lt.geometry,cn=Lt.group;let vn=Lt.material;!0===vn.allowOverride&&null!==Me&&(vn=Me),tn.layers.test(xe.layers)&&$v(tn,de,xe,jt,vn,cn)}}function $v(Y,de,xe,Me,fe,ut){Y.onBeforeRender(V,de,xe,Me,fe,ut),Y.modelViewMatrix.multiplyMatrices(xe.matrixWorldInverse,Y.matrixWorld),Y.normalMatrix.getNormalMatrix(Y.modelViewMatrix),fe.onBeforeRender(V,de,xe,Me,Y,ut),!0===fe.transparent&&fe.side===nt&&!1===fe.forceSinglePass?(fe.side=fn,fe.needsUpdate=!0,V.renderBufferDirect(xe,de,Me,fe,Y,ut),fe.side=pt,fe.needsUpdate=!0,V.renderBufferDirect(xe,de,Me,fe,Y,ut),fe.side=nt):V.renderBufferDirect(xe,de,Me,fe,Y,ut),Y.onAfterRender(V,de,xe,Me,fe,ut)}function Ph(Y,de,xe){!0!==de.isScene&&(de=sn);const Me=ct.get(Y),fe=A.state.lights,Lt=fe.state.version,tn=Te.getParameters(Y,fe.state,A.state.shadowsArray,de,xe),jt=Te.getProgramCacheKey(tn);let cn=Me.programs;Me.environment=Y.isMeshStandardMaterial?de.environment:null,Me.fog=de.fog,Me.envMap=(Y.isMeshStandardMaterial?On:Hn).get(Y.envMap||Me.environment),Me.envMapRotation=null!==Me.environment&&null===Y.envMap?de.environmentRotation:Y.envMapRotation,void 0===cn&&(Y.addEventListener("dispose",Ye),cn=new Map,Me.programs=cn);let vn=cn.get(jt);if(void 0!==vn){if(Me.currentProgram===vn&&Me.lightsStateVersion===Lt)return MM(Y,tn),vn}else tn.uniforms=Te.getUniforms(Y),Y.onBeforeCompile(tn,V),vn=Te.acquireProgram(tn,jt),cn.set(jt,vn),Me.uniforms=tn.uniforms;const xn=Me.uniforms;return(!Y.isShaderMaterial&&!Y.isRawShaderMaterial||!0===Y.clipping)&&(xn.clippingPlanes=yt.uniform),MM(Y,tn),Me.needsLights=function g_(Y){return Y.isMeshLambertMaterial||Y.isMeshToonMaterial||Y.isMeshPhongMaterial||Y.isMeshStandardMaterial||Y.isShadowMaterial||Y.isShaderMaterial&&!0===Y.lights}(Y),Me.lightsStateVersion=Lt,Me.needsLights&&(xn.ambientLightColor.value=fe.state.ambient,xn.lightProbe.value=fe.state.probe,xn.directionalLights.value=fe.state.directional,xn.directionalLightShadows.value=fe.state.directionalShadow,xn.spotLights.value=fe.state.spot,xn.spotLightShadows.value=fe.state.spotShadow,xn.rectAreaLights.value=fe.state.rectArea,xn.ltc_1.value=fe.state.rectAreaLTC1,xn.ltc_2.value=fe.state.rectAreaLTC2,xn.pointLights.value=fe.state.point,xn.pointLightShadows.value=fe.state.pointShadow,xn.hemisphereLights.value=fe.state.hemi,xn.directionalShadowMap.value=fe.state.directionalShadowMap,xn.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,xn.spotShadowMap.value=fe.state.spotShadowMap,xn.spotLightMatrix.value=fe.state.spotLightMatrix,xn.spotLightMap.value=fe.state.spotLightMap,xn.pointShadowMap.value=fe.state.pointShadowMap,xn.pointShadowMatrix.value=fe.state.pointShadowMatrix),Me.currentProgram=vn,Me.uniformsList=null,vn}function jv(Y){if(null===Y.uniformsList){const de=Y.currentProgram.getUniforms();Y.uniformsList=jf.seqWithValue(de.seq,Y.uniforms)}return Y.uniformsList}function MM(Y,de){const xe=ct.get(Y);xe.outputColorSpace=de.outputColorSpace,xe.batching=de.batching,xe.batchingColor=de.batchingColor,xe.instancing=de.instancing,xe.instancingColor=de.instancingColor,xe.instancingMorph=de.instancingMorph,xe.skinning=de.skinning,xe.morphTargets=de.morphTargets,xe.morphNormals=de.morphNormals,xe.morphColors=de.morphColors,xe.morphTargetsCount=de.morphTargetsCount,xe.numClippingPlanes=de.numClippingPlanes,xe.numIntersection=de.numClipIntersection,xe.vertexAlphas=de.vertexAlphas,xe.vertexTangents=de.vertexTangents,xe.toneMapping=de.toneMapping}pd.setAnimationLoop(function lc(Y){Ai&&Ai(Y)}),typeof self<"u"&&pd.setContext(self),this.setAnimationLoop=function(Y){Ai=Y,ft.setAnimationLoop(Y),null===Y?pd.stop():pd.start()},ft.addEventListener("sessionstart",al),ft.addEventListener("sessionend",vM),this.render=function(Y,de){if(void 0!==de&&!0!==de.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===Z)return;if(!0===Y.matrixWorldAutoUpdate&&Y.updateMatrixWorld(),null===de.parent&&!0===de.matrixWorldAutoUpdate&&de.updateMatrixWorld(),!0===ft.enabled&&!0===ft.isPresenting&&(!0===ft.cameraAutoUpdate&&ft.updateCamera(de),de=ft.getCamera()),!0===Y.isScene&&Y.onBeforeRender(V,Y,de,ne),A=en.get(Y,k.length),A.init(de),k.push(A),Ke.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse),Ti.setFromProjectionMatrix(Ke,ts,de.reversedDepth),Ue=this.localClippingEnabled,di=yt.init(this.clippingPlanes,Ue),N=Re.get(Y,H.length),N.init(),H.push(N),!0===ft.enabled&&!0===ft.isPresenting){const ut=V.xr.getDepthSensingMesh();null!==ut&&bm(ut,de,-1/0,V.sortObjects)}bm(Y,de,0,V.sortObjects),N.finish(),!0===V.sortObjects&&N.sort(At,zt),Jn=!1===ft.enabled||!1===ft.isPresenting||!1===ft.hasDepthSensing(),Jn&&Zt.addToRenderList(N,Y),this.info.render.frame++,!0===di&&yt.beginShadows(),rn.render(A.state.shadowsArray,Y,de),!0===di&&yt.endShadows(),!0===this.info.autoReset&&this.info.reset();const Me=N.opaque,fe=N.transmissive;if(A.setupLights(),de.isArrayCamera){const ut=de.cameras;if(fe.length>0)for(let Lt=0,tn=ut.length;Lt<tn;Lt++)xM(Me,fe,Y,ut[Lt]);Jn&&Zt.render(Y);for(let Lt=0,tn=ut.length;Lt<tn;Lt++){const jt=ut[Lt];m_(N,Y,jt,jt.viewport)}}else fe.length>0&&xM(Me,fe,Y,de),Jn&&Zt.render(Y),m_(N,Y,de);null!==ne&&0===ee&&(bt.updateMultisampleRenderTarget(ne),bt.updateRenderTargetMipmap(ne)),!0===Y.isScene&&Y.onAfterRender(V,Y,de),Ot.resetDefaultState(),X=-1,j=null,k.pop(),k.length>0?(A=k[k.length-1],!0===di&&yt.setGlobalState(V.clippingPlanes,A.state.camera)):A=null,H.pop(),N=H.length>0?H[H.length-1]:null},this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return ee},this.getRenderTarget=function(){return ne},this.setRenderTargetTextures=function(Y,de,xe){const Me=ct.get(Y);Me.__autoAllocateDepthBuffer=!1===Y.resolveDepthBuffer,!1===Me.__autoAllocateDepthBuffer&&(Me.__useRenderToTexture=!1),ct.get(Y.texture).__webglTexture=de,ct.get(Y.depthTexture).__webglTexture=Me.__autoAllocateDepthBuffer?void 0:xe,Me.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Y,de){const xe=ct.get(Y);xe.__webglFramebuffer=de,xe.__useDefaultFramebuffer=void 0===de};const SM=re.createFramebuffer();this.setRenderTarget=function(Y,de=0,xe=0){ne=Y,q=de,ee=xe;let Me=!0,fe=null,ut=!1,Lt=!1;if(Y){const jt=ct.get(Y);if(void 0!==jt.__useDefaultFramebuffer)ke.bindFramebuffer(re.FRAMEBUFFER,null),Me=!1;else if(void 0===jt.__webglFramebuffer)bt.setupRenderTarget(Y);else if(jt.__hasExternalTextures)bt.rebindTextures(Y,ct.get(Y.texture).__webglTexture,ct.get(Y.depthTexture).__webglTexture);else if(Y.depthBuffer){const xn=Y.depthTexture;if(jt.__boundDepthTexture!==xn){if(null!==xn&&ct.has(xn)&&(Y.width!==xn.image.width||Y.height!==xn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");bt.setupDepthRenderbuffer(Y)}}const cn=Y.texture;(cn.isData3DTexture||cn.isDataArrayTexture||cn.isCompressedArrayTexture)&&(Lt=!0);const vn=ct.get(Y).__webglFramebuffer;Y.isWebGLCubeRenderTarget?(fe=Array.isArray(vn[de])?vn[de][xe]:vn[de],ut=!0):fe=Y.samples>0&&!1===bt.useMultisampledRTT(Y)?ct.get(Y).__webglMultisampledFramebuffer:Array.isArray(vn)?vn[xe]:vn,se.copy(Y.viewport),me.copy(Y.scissor),ve=Y.scissorTest}else se.copy(qt).multiplyScalar(Ie).floor(),me.copy(Vn).multiplyScalar(Ie).floor(),ve=ui;if(0!==xe&&(fe=SM),ke.bindFramebuffer(re.FRAMEBUFFER,fe)&&Me&&ke.drawBuffers(Y,fe),ke.viewport(se),ke.scissor(me),ke.setScissorTest(ve),ut){const jt=ct.get(Y.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_CUBE_MAP_POSITIVE_X+de,jt.__webglTexture,xe)}else if(Lt){const jt=de;for(let cn=0;cn<Y.textures.length;cn++){const vn=ct.get(Y.textures[cn]);re.framebufferTextureLayer(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0+cn,vn.__webglTexture,xe,jt)}}else if(null!==Y&&0!==xe){const jt=ct.get(Y.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,jt.__webglTexture,xe)}X=-1},this.readRenderTargetPixels=function(Y,de,xe,Me,fe,ut,Lt,tn=0){if(!Y||!Y.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let jt=ct.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&void 0!==Lt&&(jt=jt[Lt]),jt){ke.bindFramebuffer(re.FRAMEBUFFER,jt);try{const cn=Y.textures[tn],vn=cn.format,xn=cn.type;if(!Be.textureFormatReadable(vn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Be.textureTypeReadable(xn))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");de>=0&&de<=Y.width-Me&&xe>=0&&xe<=Y.height-fe&&(Y.textures.length>1&&re.readBuffer(re.COLOR_ATTACHMENT0+tn),re.readPixels(de,xe,Me,fe,an.convert(vn),an.convert(xn),ut))}finally{const cn=null!==ne?ct.get(ne).__webglFramebuffer:null;ke.bindFramebuffer(re.FRAMEBUFFER,cn)}}},this.readRenderTargetPixelsAsync=function(){var Y=kf(function*(de,xe,Me,fe,ut,Lt,tn,jt=0){if(!de||!de.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let cn=ct.get(de).__webglFramebuffer;if(de.isWebGLCubeRenderTarget&&void 0!==tn&&(cn=cn[tn]),cn){if(xe>=0&&xe<=de.width-fe&&Me>=0&&Me<=de.height-ut){ke.bindFramebuffer(re.FRAMEBUFFER,cn);const vn=de.textures[jt],xn=vn.format,ei=vn.type;if(!Be.textureFormatReadable(xn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Be.textureTypeReadable(ei))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const wi=re.createBuffer();re.bindBuffer(re.PIXEL_PACK_BUFFER,wi),re.bufferData(re.PIXEL_PACK_BUFFER,Lt.byteLength,re.STREAM_READ),de.textures.length>1&&re.readBuffer(re.COLOR_ATTACHMENT0+jt),re.readPixels(xe,Me,fe,ut,an.convert(xn),an.convert(ei),0);const Nr=null!==ne?ct.get(ne).__webglFramebuffer:null;ke.bindFramebuffer(re.FRAMEBUFFER,Nr);const Hi=re.fenceSync(re.SYNC_GPU_COMMANDS_COMPLETE,0);return re.flush(),yield function vu(l,e,t){return new Promise(function(i,s){setTimeout(function a(){switch(l.clientWaitSync(e,l.SYNC_FLUSH_COMMANDS_BIT,0)){case l.WAIT_FAILED:s();break;case l.TIMEOUT_EXPIRED:setTimeout(a,t);break;default:i()}},t)})}(re,Hi,4),re.bindBuffer(re.PIXEL_PACK_BUFFER,wi),re.getBufferSubData(re.PIXEL_PACK_BUFFER,0,Lt),re.deleteBuffer(wi),re.deleteSync(Hi),Lt}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}});return function(de,xe,Me,fe,ut,Lt,tn){return Y.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(Y,de=null,xe=0){const Me=Math.pow(2,-xe),fe=Math.floor(Y.image.width*Me),ut=Math.floor(Y.image.height*Me),Lt=null!==de?de.x:0,tn=null!==de?de.y:0;bt.setTexture2D(Y,0),re.copyTexSubImage2D(re.TEXTURE_2D,xe,0,0,Lt,tn,fe,ut),ke.unbindTexture()};const EM=re.createFramebuffer(),__=re.createFramebuffer();this.copyTextureToTexture=function(Y,de,xe=null,Me=null,fe=0,ut=null){let Lt,tn,jt,cn,vn,xn,ei,wi,Nr;null===ut&&(0!==fe?(bl("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),ut=fe,fe=0):ut=0);const Hi=Y.isCompressedTexture?Y.mipmaps[ut]:Y.image;if(null!==xe)Lt=xe.max.x-xe.min.x,tn=xe.max.y-xe.min.y,jt=xe.isBox3?xe.max.z-xe.min.z:1,cn=xe.min.x,vn=xe.min.y,xn=xe.isBox3?xe.min.z:0;else{const uo=Math.pow(2,-fe);Lt=Math.floor(Hi.width*uo),tn=Math.floor(Hi.height*uo),jt=Y.isDataArrayTexture?Hi.depth:Y.isData3DTexture?Math.floor(Hi.depth*uo):1,cn=0,vn=0,xn=0}null!==Me?(ei=Me.x,wi=Me.y,Nr=Me.z):(ei=0,wi=0,Nr=0);const zi=an.convert(de.format),En=an.convert(de.type);let cr;de.isData3DTexture?(bt.setTexture3D(de,0),cr=re.TEXTURE_3D):de.isDataArrayTexture||de.isCompressedArrayTexture?(bt.setTexture2DArray(de,0),cr=re.TEXTURE_2D_ARRAY):(bt.setTexture2D(de,0),cr=re.TEXTURE_2D),re.pixelStorei(re.UNPACK_FLIP_Y_WEBGL,de.flipY),re.pixelStorei(re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,de.premultiplyAlpha),re.pixelStorei(re.UNPACK_ALIGNMENT,de.unpackAlignment);const bi=re.getParameter(re.UNPACK_ROW_LENGTH),lo=re.getParameter(re.UNPACK_IMAGE_HEIGHT),Zf=re.getParameter(re.UNPACK_SKIP_PIXELS),co=re.getParameter(re.UNPACK_SKIP_ROWS),Kf=re.getParameter(re.UNPACK_SKIP_IMAGES);re.pixelStorei(re.UNPACK_ROW_LENGTH,Hi.width),re.pixelStorei(re.UNPACK_IMAGE_HEIGHT,Hi.height),re.pixelStorei(re.UNPACK_SKIP_PIXELS,cn),re.pixelStorei(re.UNPACK_SKIP_ROWS,vn),re.pixelStorei(re.UNPACK_SKIP_IMAGES,xn);const nr=Y.isDataArrayTexture||Y.isData3DTexture,Aa=de.isDataArrayTexture||de.isData3DTexture;if(Y.isDepthTexture){const uo=ct.get(Y),Ls=ct.get(de),qs=ct.get(uo.__renderTarget),Sm=ct.get(Ls.__renderTarget);ke.bindFramebuffer(re.READ_FRAMEBUFFER,qs.__webglFramebuffer),ke.bindFramebuffer(re.DRAW_FRAMEBUFFER,Sm.__webglFramebuffer);for(let au=0;au<jt;au++)nr&&(re.framebufferTextureLayer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,ct.get(Y).__webglTexture,fe,xn+au),re.framebufferTextureLayer(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,ct.get(de).__webglTexture,ut,Nr+au)),re.blitFramebuffer(cn,vn,Lt,tn,ei,wi,Lt,tn,re.DEPTH_BUFFER_BIT,re.NEAREST);ke.bindFramebuffer(re.READ_FRAMEBUFFER,null),ke.bindFramebuffer(re.DRAW_FRAMEBUFFER,null)}else if(0!==fe||Y.isRenderTargetTexture||ct.has(Y)){const uo=ct.get(Y),Ls=ct.get(de);ke.bindFramebuffer(re.READ_FRAMEBUFFER,EM),ke.bindFramebuffer(re.DRAW_FRAMEBUFFER,__);for(let qs=0;qs<jt;qs++)nr?re.framebufferTextureLayer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,uo.__webglTexture,fe,xn+qs):re.framebufferTexture2D(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,uo.__webglTexture,fe),Aa?re.framebufferTextureLayer(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,Ls.__webglTexture,ut,Nr+qs):re.framebufferTexture2D(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,Ls.__webglTexture,ut),0!==fe?re.blitFramebuffer(cn,vn,Lt,tn,ei,wi,Lt,tn,re.COLOR_BUFFER_BIT,re.NEAREST):Aa?re.copyTexSubImage3D(cr,ut,ei,wi,Nr+qs,cn,vn,Lt,tn):re.copyTexSubImage2D(cr,ut,ei,wi,cn,vn,Lt,tn);ke.bindFramebuffer(re.READ_FRAMEBUFFER,null),ke.bindFramebuffer(re.DRAW_FRAMEBUFFER,null)}else Aa?Y.isDataTexture||Y.isData3DTexture?re.texSubImage3D(cr,ut,ei,wi,Nr,Lt,tn,jt,zi,En,Hi.data):de.isCompressedArrayTexture?re.compressedTexSubImage3D(cr,ut,ei,wi,Nr,Lt,tn,jt,zi,Hi.data):re.texSubImage3D(cr,ut,ei,wi,Nr,Lt,tn,jt,zi,En,Hi):Y.isDataTexture?re.texSubImage2D(re.TEXTURE_2D,ut,ei,wi,Lt,tn,zi,En,Hi.data):Y.isCompressedTexture?re.compressedTexSubImage2D(re.TEXTURE_2D,ut,ei,wi,Hi.width,Hi.height,zi,Hi.data):re.texSubImage2D(re.TEXTURE_2D,ut,ei,wi,Lt,tn,zi,En,Hi);re.pixelStorei(re.UNPACK_ROW_LENGTH,bi),re.pixelStorei(re.UNPACK_IMAGE_HEIGHT,lo),re.pixelStorei(re.UNPACK_SKIP_PIXELS,Zf),re.pixelStorei(re.UNPACK_SKIP_ROWS,co),re.pixelStorei(re.UNPACK_SKIP_IMAGES,Kf),0===ut&&de.generateMipmaps&&re.generateMipmap(cr),ke.unbindTexture()},this.initRenderTarget=function(Y){void 0===ct.get(Y).__webglFramebuffer&&bt.setupRenderTarget(Y)},this.initTexture=function(Y){Y.isCubeTexture?bt.setTextureCube(Y,0):Y.isData3DTexture?bt.setTexture3D(Y,0):Y.isDataArrayTexture||Y.isCompressedArrayTexture?bt.setTexture2DArray(Y,0):bt.setTexture2D(Y,0),ke.unbindTexture()},this.resetState=function(){q=0,ee=0,ne=null,ke.reset(),Ot.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ts}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Kn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Kn._getUnpackColorSpace()}}const Pv={type:"change"},u_={type:"start"},Nv={type:"end"},ym=new rs,Lv=new Vo,oM=Math.cos(70*fr.DEG2RAD),lr=new K,Ys=2*Math.PI,Ni={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},vm=1e-6;class Ov extends m0{constructor(e,t=null){super(e,t),this.state=Ni.NONE,this.target=new K,this.cursor=new K,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:R.ROTATE,MIDDLE:R.DOLLY,RIGHT:R.PAN},this.touches={ONE:st.ROTATE,TWO:st.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new K,this._lastQuaternion=new wr,this._lastTargetPosition=new K,this._quat=(new wr).setFromUnitVectors(e.up,new K(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new ny,this._sphericalDelta=new ny,this._scale=1,this._panOffset=new K,this._rotateStart=new Ce,this._rotateEnd=new Ce,this._rotateDelta=new Ce,this._panStart=new Ce,this._panEnd=new Ce,this._panDelta=new Ce,this._dollyStart=new Ce,this._dollyEnd=new Ce,this._dollyDelta=new Ce,this._dollyDirection=new K,this._mouse=new Ce,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=aM.bind(this),this._onPointerDown=Fv.bind(this),this._onPointerUp=lM.bind(this),this._onContextMenu=Yf.bind(this),this._onMouseWheel=uM.bind(this),this._onKeyDown=dM.bind(this),this._onTouchStart=hM.bind(this),this._onTouchMove=fM.bind(this),this._onMouseDown=Lb.bind(this),this._onMouseMove=cM.bind(this),this._interceptControlDown=pM.bind(this),this._interceptControlUp=d_.bind(this),null!==this.domElement&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Pv),this.update(),this.state=Ni.NONE}update(e=null){const t=this.object.position;lr.copy(t).sub(this.target),lr.applyQuaternion(this._quat),this._spherical.setFromVector3(lr),this.autoRotate&&this.state===Ni.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(i)&&isFinite(s)&&(i<-Math.PI?i+=Ys:i>Math.PI&&(i-=Ys),s<-Math.PI?s+=Ys:s>Math.PI&&(s-=Ys),this._spherical.theta=i<=s?Math.max(i,Math.min(s,this._spherical.theta)):this._spherical.theta>(i+s)/2?Math.max(i,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let a=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const d=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),a=d!=this._spherical.radius}if(lr.setFromSpherical(this._spherical),lr.applyQuaternion(this._quatInverse),t.copy(this.target).add(lr),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let d=null;if(this.object.isPerspectiveCamera){const m=lr.length();d=this._clampDistance(m*this._scale);const y=m-d;this.object.position.addScaledVector(this._dollyDirection,y),this.object.updateMatrixWorld(),a=!!y}else if(this.object.isOrthographicCamera){const m=new K(this._mouse.x,this._mouse.y,0);m.unproject(this.object);const y=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),a=y!==this.object.zoom;const v=new K(this._mouse.x,this._mouse.y,0);v.unproject(this.object),this.object.position.sub(v).add(m),this.object.updateMatrixWorld(),d=lr.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==d&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(d).add(this.object.position):(ym.origin.copy(this.object.position),ym.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ym.direction))<oM?this.object.lookAt(this.target):(Lv.setFromNormalAndCoplanarPoint(this.object.up,this.target),ym.intersectPlane(Lv,this.target))))}else if(this.object.isOrthographicCamera){const d=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),d!==this.object.zoom&&(this.object.updateProjectionMatrix(),a=!0)}return this._scale=1,this._performCursorZoom=!1,!!(a||this._lastPosition.distanceToSquared(this.object.position)>vm||8*(1-this._lastQuaternion.dot(this.object.quaternion))>vm||this._lastTargetPosition.distanceToSquared(this.target)>vm)&&(this.dispatchEvent(Pv),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?Ys/60*this.autoRotateSpeed*e:Ys/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){lr.setFromMatrixColumn(t,0),lr.multiplyScalar(-e),this._panOffset.add(lr)}_panUp(e,t){!0===this.screenSpacePanning?lr.setFromMatrixColumn(t,1):(lr.setFromMatrixColumn(t,0),lr.crossVectors(this.object.up,lr)),lr.multiplyScalar(e),this._panOffset.add(lr)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){lr.copy(this.object.position).sub(this.target);let a=lr.length();a*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*a/i.clientHeight,this.object.matrix),this._panUp(2*t*a/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),a=t-i.top,m=i.height;this._mouse.x=(e-i.left)/i.width*2-1,this._mouse.y=-a/m*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Ys*this._rotateDelta.x/t.clientHeight),this._rotateUp(Ys*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Ys*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Ys*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Ys*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Ys*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._rotateStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,s=e.pageY-t.y,a=Math.sqrt(i*i+s*s);this._dollyStart.set(0,a)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e);this._rotateEnd.set(.5*(e.pageX+i.x),.5*(e.pageY+i.y))}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Ys*this._rotateDelta.x/t.clientHeight),this._rotateUp(Ys*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panEnd.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,s=e.pageY-t.y,a=Math.sqrt(i*i+s*s);this._dollyEnd.set(0,a),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd),this._updateZoomParameters(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Ce,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){return this._pointerPositions[e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0]]}_customWheelEvent(e){const i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(e.deltaMode){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function Fv(l){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(l.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(l)&&(this._addPointer(l),"touch"===l.pointerType?this._onTouchStart(l):this._onMouseDown(l)))}function aM(l){!1!==this.enabled&&("touch"===l.pointerType?this._onTouchMove(l):this._onMouseMove(l))}function lM(l){switch(this._removePointer(l),this._pointers.length){case 0:this.domElement.releasePointerCapture(l.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Nv),this.state=Ni.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y})}}function Lb(l){let e;switch(l.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case R.DOLLY:if(!1===this.enableZoom)return;this._handleMouseDownDolly(l),this.state=Ni.DOLLY;break;case R.ROTATE:if(l.ctrlKey||l.metaKey||l.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(l),this.state=Ni.PAN}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(l),this.state=Ni.ROTATE}break;case R.PAN:if(l.ctrlKey||l.metaKey||l.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(l),this.state=Ni.ROTATE}else{if(!1===this.enablePan)return;this._handleMouseDownPan(l),this.state=Ni.PAN}break;default:this.state=Ni.NONE}this.state!==Ni.NONE&&this.dispatchEvent(u_)}function cM(l){switch(this.state){case Ni.ROTATE:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(l);break;case Ni.DOLLY:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(l);break;case Ni.PAN:if(!1===this.enablePan)return;this._handleMouseMovePan(l)}}function uM(l){!1===this.enabled||!1===this.enableZoom||this.state!==Ni.NONE||(l.preventDefault(),this.dispatchEvent(u_),this._handleMouseWheel(this._customWheelEvent(l)),this.dispatchEvent(Nv))}function dM(l){!1!==this.enabled&&this._handleKeyDown(l)}function hM(l){switch(this._trackPointer(l),this._pointers.length){case 1:switch(this.touches.ONE){case st.ROTATE:if(!1===this.enableRotate)return;this._handleTouchStartRotate(l),this.state=Ni.TOUCH_ROTATE;break;case st.PAN:if(!1===this.enablePan)return;this._handleTouchStartPan(l),this.state=Ni.TOUCH_PAN;break;default:this.state=Ni.NONE}break;case 2:switch(this.touches.TWO){case st.DOLLY_PAN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(l),this.state=Ni.TOUCH_DOLLY_PAN;break;case st.DOLLY_ROTATE:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(l),this.state=Ni.TOUCH_DOLLY_ROTATE;break;default:this.state=Ni.NONE}break;default:this.state=Ni.NONE}this.state!==Ni.NONE&&this.dispatchEvent(u_)}function fM(l){switch(this._trackPointer(l),this.state){case Ni.TOUCH_ROTATE:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(l),this.update();break;case Ni.TOUCH_PAN:if(!1===this.enablePan)return;this._handleTouchMovePan(l),this.update();break;case Ni.TOUCH_DOLLY_PAN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(l),this.update();break;case Ni.TOUCH_DOLLY_ROTATE:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(l),this.update();break;default:this.state=Ni.NONE}}function Yf(l){!1!==this.enabled&&l.preventDefault()}function pM(l){"Control"===l.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function d_(l){"Control"===l.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}Tt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ce(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},oo.line={uniforms:Od.merge([Tt.common,Tt.fog,Tt.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n\t\t\t\tvec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n\t\t\t\tvec3 worldFwd = cross( worldDir, worldUp );\n\t\t\t\tworldPos = position.y < 0.5 ? start: end;\n\n\t\t\t\t// height offset\n\t\t\t\tfloat hw = linewidth * 0.5;\n\t\t\t\tworldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.xyz += worldFwd * hw;\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\tworldPos.xyz -= worldFwd * 2.0 * hw;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat alpha = opacity;\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class Zo extends io{constructor(e){super({type:"LineMaterial",uniforms:Od.clone(oo.line.uniforms),vertexShader:oo.line.vertexShader,fragmentShader:oo.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){!0===e!==this.dashed&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(!0===e!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===e?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const Uv=new gn,Ah=new K;class Dh extends z_{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new Bt([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new Bt([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new mg(t,6,1);return this.setAttribute("instanceStart",new xs(i,3,0)),this.setAttribute("instanceEnd",new xs(i,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new mg(t,6,1);return this.setAttribute("instanceColorStart",new xs(i,3,0)),this.setAttribute("instanceColorEnd",new xs(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new el(e.geometry)),this}fromLineSegments(e){return this.setPositions(e.geometry.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new gn);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Uv.setFromBufferAttribute(t),this.boundingBox.union(Uv))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Wr),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let s=0;for(let a=0,d=e.count;a<d;a++)Ah.fromBufferAttribute(e,a),s=Math.max(s,i.distanceToSquared(Ah)),Ah.fromBufferAttribute(t,a),s=Math.max(s,i.distanceToSquared(Ah));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}class Bv extends Dh{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let s=0;s<t;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let s=0;s<t;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return super.setColors(i),this}setFromPoints(e){const t=e.length-1,i=new Float32Array(6*t);for(let s=0;s<t;s++)i[6*s]=e[s].x,i[6*s+1]=e[s].y,i[6*s+2]=e[s].z||0,i[6*s+3]=e[s+1].x,i[6*s+4]=e[s+1].y,i[6*s+5]=e[s+1].z||0;return super.setPositions(i),this}fromLine(e){return this.setPositions(e.geometry.attributes.position.array),this}}const h_=new G,kv=new K,qf=new K,zr=new G,Es=new G,ol=new G,xm=new K,Mm=new yn,Kr=new class oy{constructor(e=new K,t=new K){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){ry.subVectors(e,this.start),od.subVectors(this.end,this.start);const i=od.dot(od);let a=od.dot(ry)/i;return t&&(a=Ct(a,0,1)),a}closestPointToPoint(e,t,i){const s=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(s).add(this.start)}distanceSqToLine3(e,t=_g,i=XM){const s=10000000000000001e-32;let a,d;const m=this.start,y=e.start,M=e.end;ic.subVectors(this.end,m),rc.subVectors(M,y),sy.subVectors(m,y);const b=ic.dot(ic),E=rc.dot(rc),C=rc.dot(sy);if(b<=s&&E<=s)return t.copy(m),i.copy(y),t.sub(i),t.dot(t);if(b<=s)a=0,d=C/E,d=Ct(d,0,1);else{const D=ic.dot(sy);if(E<=s)d=0,a=Ct(-D/b,0,1);else{const O=ic.dot(rc),N=b*E-O*O;a=0!==N?Ct((O*C-D*E)/N,0,1):0,d=(O*a+C)/E,d<0?(d=0,a=Ct(-D/b,0,1)):d>1&&(d=1,a=Ct((O-D)/b,0,1))}}return t.copy(m).add(ic.multiplyScalar(a)),i.copy(y).add(rc.multiplyScalar(d)),t.sub(i),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},f_=new K,Ih=new gn,Rh=new Wr,Ta=new G;let Ko,ac;function Vv(l,e,t){return Ta.set(0,0,-e,1).applyMatrix4(l.projectionMatrix),Ta.multiplyScalar(1/Ta.w),Ta.x=ac/t.width,Ta.y=ac/t.height,Ta.applyMatrix4(l.projectionMatrixInverse),Ta.multiplyScalar(1/Ta.w),Math.abs(Math.max(Ta.x,Ta.y))}class _M extends kr{constructor(e=new Dh,t=new Zo({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,s=new Float32Array(2*t.count);for(let d=0,m=0,y=t.count;d<y;d++,m+=2)kv.fromBufferAttribute(t,d),qf.fromBufferAttribute(i,d),s[m]=0===m?0:s[m-1],s[m+1]=s[m]+kv.distanceTo(qf);const a=new mg(s,2,1);return e.setAttribute("instanceDistanceStart",new xs(a,1,0)),e.setAttribute("instanceDistanceEnd",new xs(a,1,1)),this}raycast(e,t){const i=this.material.worldUnits,s=e.camera;null===s&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.'),Ko=e.ray;const d=this.matrixWorld,m=this.geometry,y=this.material;let v,M;ac=y.linewidth+(void 0!==e.params.Line2&&e.params.Line2.threshold||0),null===m.boundingSphere&&m.computeBoundingSphere(),Rh.copy(m.boundingSphere).applyMatrix4(d),v=i?.5*ac:Vv(s,Math.max(s.near,Rh.distanceToPoint(Ko.origin)),y.resolution),Rh.radius+=v,!1!==Ko.intersectsSphere(Rh)&&(null===m.boundingBox&&m.computeBoundingBox(),Ih.copy(m.boundingBox).applyMatrix4(d),M=i?.5*ac:Vv(s,Math.max(s.near,Ih.distanceToPoint(Ko.origin)),y.resolution),Ih.expandByScalar(M),!1!==Ko.intersectsBox(Ih)&&(i?function mM(l,e){const t=l.matrixWorld,i=l.geometry,s=i.attributes.instanceStart,a=i.attributes.instanceEnd;for(let m=0,y=Math.min(i.instanceCount,s.count);m<y;m++){Kr.start.fromBufferAttribute(s,m),Kr.end.fromBufferAttribute(a,m),Kr.applyMatrix4(t);const v=new K,M=new K;Ko.distanceSqToSegment(Kr.start,Kr.end,M,v),M.distanceTo(v)<.5*ac&&e.push({point:M,pointOnLine:v,distance:Ko.origin.distanceTo(M),object:l,face:null,faceIndex:m,uv:null,uv1:null})}}(this,t):function gM(l,e,t){const i=e.projectionMatrix,a=l.material.resolution,d=l.matrixWorld,m=l.geometry,y=m.attributes.instanceStart,v=m.attributes.instanceEnd,M=Math.min(m.instanceCount,y.count),b=-e.near;Ko.at(1,ol),ol.w=1,ol.applyMatrix4(e.matrixWorldInverse),ol.applyMatrix4(i),ol.multiplyScalar(1/ol.w),ol.x*=a.x/2,ol.y*=a.y/2,ol.z=0,xm.copy(ol),Mm.multiplyMatrices(e.matrixWorldInverse,d);for(let E=0,C=M;E<C;E++){if(zr.fromBufferAttribute(y,E),Es.fromBufferAttribute(v,E),zr.w=1,Es.w=1,zr.applyMatrix4(Mm),Es.applyMatrix4(Mm),zr.z>b&&Es.z>b)continue;zr.z>b?zr.lerp(Es,(zr.z-b)/(zr.z-Es.z)):Es.z>b&&Es.lerp(zr,(Es.z-b)/(Es.z-zr.z)),zr.applyMatrix4(i),Es.applyMatrix4(i),zr.multiplyScalar(1/zr.w),Es.multiplyScalar(1/Es.w),zr.x*=a.x/2,zr.y*=a.y/2,Es.x*=a.x/2,Es.y*=a.y/2,Kr.start.copy(zr),Kr.start.z=0,Kr.end.copy(Es),Kr.end.z=0;const O=Kr.closestPointToPointParameter(xm,!0);Kr.at(O,f_);const N=fr.lerp(zr.z,Es.z,O),A=N>=-1&&N<=1,H=xm.distanceTo(f_)<.5*ac;if(A&&H){Kr.start.fromBufferAttribute(y,E),Kr.end.fromBufferAttribute(v,E),Kr.start.applyMatrix4(d),Kr.end.applyMatrix4(d);const k=new K,V=new K;Ko.distanceSqToSegment(Kr.start,Kr.end,V,k),t.push({point:V,pointOnLine:k,distance:Ko.origin.distanceTo(V),object:l,face:null,faceIndex:E,uv:null,uv1:null})}}}(this,s,t)))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(h_),this.material.uniforms.resolution.value.set(h_.z,h_.w))}}class Hv extends _M{constructor(e=new Bv,t=new Zo({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}var ou=ae(256),Gv=ae(529);const Wv=["canvasContainer"];let yM=(()=>{const e=class{constructor(i){this.http=i,this.isInitialized=!1}ngAfterViewInit(){setTimeout(()=>this.initThree(),100)}ngOnDestroy(){this.disposeGlobe()}initThree(){if(!this.canvasContainer?.nativeElement||this.isInitialized)return;const i=this.canvasContainer.nativeElement,{width:a,height:d}=(()=>{let v=i.clientWidth,M=i.clientHeight;if(0===v||0===M){const b=i.parentElement;b?(v=b.clientWidth||520,M=b.clientHeight||360):(v=520,M=360)}return{width:v,height:M}})();if(0===a||0===d)return void setTimeout(()=>this.initThree(),50);this.scene=new Fm,this.scene.fog=new Ru(0,.3),this.camera=new ss(75,a/d,.1,1e3),this.camera.position.set(0,0,5),this.renderer=new sM({antialias:!0,alpha:!0,preserveDrawingBuffer:!1}),this.renderer.setSize(a,d),this.renderer.setClearColor(0,1),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.display="block",i.appendChild(this.renderer.domElement),this.controls=new Ov(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.minDistance=3,this.controls.maxDistance=20,this.controls.enableZoom=!1,this.controls.enablePan=!1;const m=new k_(16777215,.6);this.scene.add(m);const y=new sd(16777215,1);y.position.set(10,10,10),this.scene.add(y),this.group=new ko,this.scene.add(this.group),this.setupGlobe(),this.addExtraStars(),window.addEventListener("resize",()=>this.onWindowResize()),this.isInitialized=!0,this.animate()}setupGlobe(){const i=new Jc(1.99,128,128),s=new Ss({color:16777215,transparent:!0,opacity:.1}),a=new Xu(i);this.group.add(new Wu(a,s));const d=new Qc({color:5395036,roughness:1,metalness:0}),m=new kr(new Jc(1.99,128,128),d);this.group.add(m);const y=function zv({numStars:l=500,sprite:e,fog:t=!1}={}){function i(){const M=25*Math.random()+25,b=Math.random(),E=Math.random(),C=2*Math.PI*b,D=Math.acos(2*E-1),O=M*Math.sin(D)*Math.cos(C),N=M*Math.sin(D)*Math.sin(C),A=M*Math.cos(D);return{pos:new K(O,N,A),hue:.6,minDist:M}}const s=[],a=[],d=[];for(let M=0;M<l;M++){const b=i(),{pos:E,hue:C}=b;d.push(b);const D=(new Nt).setHSL(C,.2,Math.random());s.push(E.x,E.y,E.z),a.push(D.r,D.g,D.b)}const m=new An;m.setAttribute("position",new Bt(s,3)),m.setAttribute("color",new Bt(a,3));const y=new zl({size:.2,vertexColors:!0,fog:t,map:e});return new Zd(m,y)}({numStars:800,fog:!1});this.group.add(y),[{path:"assets/geojson/ne-110m/ne_110m_physical/ne_110m_land.json",color:3900150},{path:"assets/geojson/ne-110m/ne_110m_countries.json",color:3900150}].forEach(M=>{this.http.get(M.path).subscribe({next:b=>{if(!this.group)return;const E=function p_({json:l,radius:e,materialOptions:t={}}){const i=new Br;i.userData.update=H=>{for(const k of i.children)k.userData.update?.(H)},i.rotation.x=.5*-Math.PI;const s=[],a=[],d=[],m=function v(H){if("Feature"===H.type)return[H.geometry];if("FeatureCollection"===H.type)return H.features.map(k=>k.geometry);if("GeometryCollection"===H.type)return H.geometries;throw new Error("The geoJSON is not valid.")}(l);let y=[];for(const H of m)switch(H.type){case"Point":D(H.coordinates,e),O(s[0],a[0],d[0],t);break;case"MultiPoint":for(const k of H.coordinates)D(k,e),O(s[0],a[0],d[0],t);break;case"LineString":y=M(H.coordinates);for(const k of y)D(k,e);N(s,a,d,t);break;case"Polygon":case"MultiLineString":for(const k of H.coordinates){y=M(k);for(const V of y)D(V,e);N(s,a,d,t)}break;case"MultiPolygon":for(const k of H.coordinates)for(const V of k){y=M(V);for(const Z of y)D(Z,e);N(s,a,d,t)}break;default:throw new Error("The geoJSON is not valid.")}function M(H){const k=[];let V=[];for(let Z=0;Z<H.length;Z++){const q=H[Z],ee=H[Z-1];Z>0&&b(ee,q)?(V=[ee,q],V=E(V),k.push(...V)):k.push(q)}return k}function b(H,k){const[V,Z]=k,[q,ee]=H;return Math.abs(V-q)>5||Math.abs(Z-ee)>5}function E(H){let k=[];for(let V=0;V<H.length-1;V++){const Z=H[V],q=H[V+1];b(q,Z)?k.push(Z,C(Z,q)):k.push(Z)}return k.push(H[H.length-1]),k.length>H.length?E(k):k}function C(H,k){return[(H[0]+k[0])/2,(H[1]+k[1])/2]}function D(H,k){const[V,Z]=H;s.push(Math.cos(Z*Math.PI/180)*Math.cos(V*Math.PI/180)*k),a.push(Math.cos(Z*Math.PI/180)*Math.sin(V*Math.PI/180)*k),d.push(Math.sin(Z*Math.PI/180)*k)}function O(H,k,V,Z){const q=new An;q.setAttribute("position",new Bt([H,k,V],3));const ee=new zl(Z),ne=new Zd(q,ee);i.add(ne),A()}function N(H,k,V,Z){const q=new Bv,ee=[];for(let ve=0;ve<H.length;ve++)ee.push(H[ve],k[ve],V[ve]);q.setPositions(ee);const ne=.3+.2*Math.random()-(Math.random()>.5?.3:0),X=(new Nt).setHSL(ne,1,.5),j=new Zo({color:X,linewidth:2,fog:!0,...Z}),se=new Hv(q,j);se.computeLineDistances();const me=2e-4*Math.random();se.userData.update=ve=>{j.dashOffset=ve*me},i.add(se),A()}function A(){s.length=0,a.length=0,d.length=0}return i}({json:b,radius:2,materialOptions:{color:M.color,transparent:!0,opacity:.7,linewidth:2}});this.group.add(E)},error:b=>{console.warn(`\u274c Error cargando ${M.path}`,b)}})})}addExtraStars(){const i=new An,s=new zl({color:16777215,size:.1,transparent:!0,opacity:.8}),a=[];for(let y=0;y<2e3;y++){const M=Math.random()*Math.PI*2,b=Math.acos(2*Math.random()-1),E=100*Math.sin(b)*Math.cos(M),C=100*Math.sin(b)*Math.sin(M),D=100*Math.cos(b);a.push(E,C,D)}i.setAttribute("position",new Bt(a,3));const m=new Zd(i,s);this.scene.add(m)}animate(){this.isInitialized&&(this.animationId=requestAnimationFrame(()=>this.animate()),this.group&&(this.group.rotation.y+=8e-4),this.controls&&this.controls.update(),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera))}onWindowResize(){if(!(this.canvasContainer&&this.camera&&this.renderer&&this.isInitialized))return;const i=this.canvasContainer.nativeElement,s=i.parentElement,a=i.clientWidth||s?.clientWidth||520,d=i.clientHeight||s?.clientHeight||360;a>0&&d>0&&(this.camera.aspect=a/d,this.camera.updateProjectionMatrix(),this.renderer.setSize(a,d))}disposeGlobe(){this.isInitialized=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=0),this.controls&&(this.controls.dispose(),this.controls=void 0),this.renderer&&(this.renderer.domElement&&this.renderer.domElement.parentNode&&this.renderer.domElement.parentNode.removeChild(this.renderer.domElement),this.scene?.traverse(i=>{i instanceof kr&&(i.geometry?.dispose(),Array.isArray(i.material)?i.material.forEach(s=>s.dispose()):i.material?.dispose())}),this.renderer.dispose(),this.renderer=void 0),this.scene=void 0,this.camera=void 0,this.group=void 0,window.removeEventListener("resize",()=>this.onWindowResize())}};let l=e;return e.\u0275fac=function(s){return new(s||e)(ou.Y36(Gv.eN))},e.\u0275cmp=ou.Xpm({type:e,selectors:[["app-globe-scene"]],viewQuery:function(s,a){if(1&s&&ou.Gf(Wv,5),2&s){let d;ou.iGM(d=ou.CRH())&&(a.canvasContainer=d.first)}},standalone:!0,features:[ou.jDz],decls:2,vars:0,consts:[[1,"w-full","h-full"],["canvasContainer",""]],template:function(s,a){1&s&&ou._UZ(0,"div",0,1)}}),l})()},7:(Fn,mt,ae)=>{ae.d(mt,{J:()=>at});var U=ae(256),R=ae(895);function st(qe,Ft){if(1&qe&&(U.TgZ(0,"div",1)(1,"div",2),U.NdJ("click",function(Jt){return Jt.stopPropagation()}),U.TgZ(2,"div",3),U._UZ(3,"div",4),U.qZA(),U.TgZ(4,"h2",5),U._uU(5,"Processing Calculation"),U.qZA(),U.TgZ(6,"p",6),U._uU(7),U.qZA(),U.TgZ(8,"div",7),U._UZ(9,"div",8),U.qZA(),U.TgZ(10,"p",9),U._uU(11,"Analyzing input data"),U.qZA()()()),2&qe){const vt=U.oxw();U.xp6(7),U.Oqu(vt.currentMessage),U.xp6(2),U.Udp("width",vt.progress,"%")}}let at=(()=>{const Ft=class{constructor(){this.open=!1,this.closed=new U.vpe,this.completed=new U.vpe,this.progress=0,this.currentMessage="Connecting to quantum computing cluster...",this.messages=["Analyzing input data","Finalizing results..."],this.currentMessageIndex=0}ngOnInit(){this.open&&this.startProcessing()}ngOnChanges(Jt){Jt.open&&(Jt.open.currentValue?this.startProcessing():this.stopProcessing())}ngOnDestroy(){this.stopProcessing()}startProcessing(){this.progress=0,this.currentMessageIndex=0,this.currentMessage=this.messages[0],this.progressInterval=setInterval(()=>{this.progress+=2,this.progress>=100&&(this.progress=100,this.stopProcessing(),setTimeout(()=>{this.completed.emit()},500))},60),this.messageTimeout=setTimeout(()=>{this.currentMessageIndex=1,this.currentMessage=this.messages[1]},2e3)}stopProcessing(){this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=void 0),this.messageTimeout&&(clearTimeout(this.messageTimeout),this.messageTimeout=void 0)}};let qe=Ft;return Ft.\u0275fac=function(It){return new(It||Ft)},Ft.\u0275cmp=U.Xpm({type:Ft,selectors:[["app-processing-calculation"]],inputs:{open:"open"},outputs:{closed:"closed",completed:"completed"},standalone:!0,features:[U.TTD,U.jDz],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",4,"ngIf"],[1,"fixed","inset-0","z-50","bg-black/80","backdrop-blur-sm","flex","items-center","justify-center","p-4"],[1,"w-full","max-w-md","rounded-2xl","bg-zinc-900/95","border","border-white/10","shadow-2xl","p-8","text-white","relative",3,"click"],[1,"flex","justify-center","mb-6"],[1,"spinner"],[1,"text-2xl","font-bold","text-center","mb-4"],[1,"text-white/70","text-sm","text-center","mb-6"],[1,"w-full","bg-zinc-800","rounded-full","h-2","mb-4","overflow-hidden"],[1,"progress-bar","h-full","bg-brand","transition-all","duration-300","ease-out"],[1,"text-white/60","text-xs","text-center"]],template:function(It,Ve){1&It&&U.YNc(0,st,12,3,"div",0),2&It&&U.Q6J("ngIf",Ve.open)},dependencies:[R.ez,R.O5],styles:[".spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid rgba(59,130,246,.2);border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.progress-bar[_ngcontent-%COMP%]{background:#3b82f6;border-radius:999px;transition:width .3s ease-out}"]}),qe})()},62:(Fn,mt,ae)=>{ae.d(mt,{W:()=>qe});var U=ae(256),R=ae(895),st=ae(383);function at(Ft,vt){if(1&Ft){const Jt=U.EpF();U.TgZ(0,"div",1)(1,"div",2),U.NdJ("click",function(Ve){return Ve.stopPropagation()}),U.TgZ(2,"div",3),U._UZ(3,"app-globe-scene"),U.qZA(),U.TgZ(4,"button",4),U.NdJ("click",function(){U.CHM(Jt);const Ve=U.oxw();return U.KtG(Ve.closed.emit())}),U.O4$(),U.TgZ(5,"svg",5),U._UZ(6,"path",6),U.qZA()(),U.kcU(),U.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"span",10),U._uU(11,"\u{1f451}"),U.qZA(),U.TgZ(12,"h2",11),U._uU(13,"Upgrade to CalcJB7"),U._UZ(14,"br"),U._uU(15,"AI Premium"),U.qZA()(),U.TgZ(16,"p",12),U._uU(17," Access powerful computational tools and premium capabilities "),U.qZA(),U.TgZ(18,"div",13)(19,"div",14)(20,"div",15)(21,"span",16),U._uU(22,"\u26a1"),U.qZA(),U.TgZ(23,"div")(24,"b"),U._uU(25,"Lightning Fast"),U.qZA(),U._UZ(26,"br"),U.TgZ(27,"span",17),U._uU(28,"Instant computation engine"),U.qZA()()()(),U.TgZ(29,"div",14)(30,"div",15)(31,"span",16),U._uU(32,"\u2728"),U.qZA(),U.TgZ(33,"div")(34,"b"),U._uU(35,"Smart Intelligence"),U.qZA(),U._UZ(36,"br"),U.TgZ(37,"span",17),U._uU(38,"Advanced AI algorithms"),U.qZA()()()(),U.TgZ(39,"div",14)(40,"div",15)(41,"span",16),U._uU(42,"\u{1f6e1}\ufe0f"),U.qZA(),U.TgZ(43,"div")(44,"b"),U._uU(45,"Secure & Private"),U.qZA(),U._UZ(46,"br"),U.TgZ(47,"span",17),U._uU(48,"Military-grade protection"),U.qZA()()()()(),U.TgZ(49,"div",18)(50,"p",11),U._uU(51,"$70"),U.TgZ(52,"span",19),U._uU(53,"/month"),U.qZA()(),U.TgZ(54,"p",20),U._uU(55,"Billed annually at $840/year"),U.qZA()()(),U.TgZ(56,"div",21)(57,"h3",22),U._uU(58,"Billing Details"),U.qZA(),U.TgZ(59,"div",23)(60,"div")(61,"label",24),U._uU(62,"First Name"),U.qZA(),U._UZ(63,"input",25),U.qZA(),U.TgZ(64,"div")(65,"label",24),U._uU(66,"Last Name"),U.qZA(),U._UZ(67,"input",26),U.qZA()(),U.TgZ(68,"div")(69,"label",24),U._uU(70,"Email"),U.qZA(),U._UZ(71,"input",27),U.qZA(),U.TgZ(72,"div")(73,"label",24),U._uU(74,"Card Number"),U.qZA(),U._UZ(75,"input",28),U.qZA(),U.TgZ(76,"div",23)(77,"div")(78,"label",24),U._uU(79,"Expiry Date"),U.qZA(),U._UZ(80,"input",29),U.qZA(),U.TgZ(81,"div")(82,"label",24),U._uU(83,"CVV"),U.qZA(),U._UZ(84,"input",30),U.qZA()(),U.TgZ(85,"button",31),U.NdJ("click",function(){U.CHM(Jt);const Ve=U.oxw();return U.KtG(Ve.onSubscribeClick())}),U._uU(86),U.qZA(),U.TgZ(87,"p",32),U._uU(88," By subscribing, you agree to our "),U.TgZ(89,"a",33),U._uU(90,"Terms of Service"),U.qZA(),U._uU(91," and "),U.TgZ(92,"a",33),U._uU(93,"Privacy Policy"),U.qZA(),U._uU(94,". "),U.qZA()()()()()}if(2&Ft){const Jt=U.oxw();U.xp6(8),U.ekj("fade-in",Jt.showLeftSection)("hidden",!Jt.showLeftSection),U.xp6(48),U.ekj("fade-in",Jt.showRightSection)("hidden",!Jt.showRightSection),U.xp6(29),U.Q6J("disabled",Jt.isProcessing),U.xp6(1),U.hij(" ",Jt.isProcessing?"Processing...":"Subscribe Now"," ")}}let qe=(()=>{const vt=class{constructor(){this.open=!1,this.closed=new U.vpe,this.subscribed=new U.vpe,this.isProcessing=!1,this.showLeftSection=!1,this.showRightSection=!1}ngOnChanges(It){It.open&&It.open.currentValue&&(this.showLeftSection=!1,this.showRightSection=!1,setTimeout(()=>{this.showLeftSection=!0},100),setTimeout(()=>{this.showRightSection=!0},600))}onOverlayClick(It){const Ve=It.target;Ve&&Ve.classList.contains("fixed")&&this.closed.emit()}onSubscribeClick(){this.isProcessing||(this.isProcessing=!0,setTimeout(()=>{this.subscribed.emit(),this.isProcessing=!1},2e3))}};let Ft=vt;return vt.\u0275fac=function(Ve){return new(Ve||vt)},vt.\u0275cmp=U.Xpm({type:vt,selectors:[["app-premium-modal"]],inputs:{open:"open"},outputs:{closed:"closed",subscribed:"subscribed"},standalone:!0,features:[U.TTD,U.jDz],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-start md:items-center justify-center p-4 md:p-6 overflow-y-auto py-4 md:py-6",4,"ngIf"],[1,"fixed","inset-0","z-50","bg-black/70","backdrop-blur-sm","flex","items-start","md:items-center","justify-center","p-4","md:p-6","overflow-y-auto","py-4","md:py-6"],[1,"w-full","max-w-5xl","rounded-2xl","bg-zinc-900/90","border","border-white/10","shadow-2xl","text-white","relative","overflow-hidden","mt-16","md:mt-auto","mb-4","md:mb-auto",3,"click"],[1,"absolute","inset-0","z-0","opacity-60","pointer-events-none"],["aria-label","Close modal",1,"absolute","top-4","right-4","z-20","text-white/60","hover:text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"relative","z-10","p-4","md:p-6","lg:p-8","flex","flex-col","md:grid","md:grid-cols-2","gap-6","md:gap-8"],[1,"space-y-6"],[1,"flex","items-center","gap-3"],[1,"text-3xl"],[1,"text-3xl","font-bold"],[1,"text-white/70","text-sm"],[1,"space-y-3"],[1,"feature"],[1,"flex","items-start","gap-3"],[1,"text-xl"],[1,"text-white/60","text-sm"],[1,"p-4","rounded-xl","bg-zinc-800/60","border","border-white/10","text-center"],[1,"text-base","text-white/60"],[1,"text-sm","text-white/50"],[1,"space-y-4"],[1,"text-xl","font-semibold","mb-4"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-sm","text-white/70","mb-1"],["type","text","value","Johan",1,"inp"],["type","text","value","Barzallo",1,"inp"],["type","email","value","johan@example.com",1,"inp"],["type","text","value","1234 5678 9012 3456",1,"inp"],["type","text","placeholder","MM/YY",1,"inp"],["type","text","value","123",1,"inp"],[1,"w-full","mt-6","py-3","bg-brand","hover:brightness-110","transition","rounded-lg","text-lg","font-semibold","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled","click"],[1,"text-xs","text-white/50","text-center"],["href","#",1,"underline"]],template:function(Ve,Le){1&Ve&&U.YNc(0,at,95,10,"div",0),2&Ve&&U.Q6J("ngIf",Le.open)},dependencies:[R.ez,R.O5,st.u],styles:['@charset "UTF-8";.feature[_ngcontent-%COMP%]{border-radius:.75rem;border-width:1px;border-color:#ffffff0d;background-color:#27272a99;padding:1rem}.inp[_ngcontent-%COMP%]{height:2.75rem;width:100%;border-radius:.75rem;border-width:1px;border-color:#ffffff1a;background-color:#27272ab3;padding-left:.75rem;padding-right:.75rem;font-size:.875rem;line-height:1.25rem}.inp[_ngcontent-%COMP%]::placeholder{color:#fff6}.inp[_ngcontent-%COMP%]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-color: rgb(59 130 246 / .4)}[_nghost-%COMP%]     .fixed.overflow-y-auto{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.1) transparent}[_nghost-%COMP%]     .fixed.overflow-y-auto::-webkit-scrollbar{width:6px}[_nghost-%COMP%]     .fixed.overflow-y-auto::-webkit-scrollbar-track{background:transparent}[_nghost-%COMP%]     .fixed.overflow-y-auto::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:3px}[_nghost-%COMP%]     .fixed.overflow-y-auto::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.2)}.abs-stars[_ngcontent-%COMP%]{position:absolute;inset:0;background:radial-gradient(520px 280px at 35% 35%,rgba(59,130,246,.12),transparent 60%),radial-gradient(900px 520px at 0% 100%,rgba(59,130,246,.08),transparent 70%),radial-gradient(2px 2px at 15% 30%,rgba(255,255,255,.15),transparent 60%),radial-gradient(2px 2px at 22% 60%,rgba(255,255,255,.12),transparent 60%),radial-gradient(2px 2px at 35% 20%,rgba(255,255,255,.1),transparent 60%);pointer-events:none;z-index:0}.abs-globe[_ngcontent-%COMP%]{position:absolute;inset:0;pointer-events:none;z-index:0;mask-image:linear-gradient(to right,rgb(0,0,0) 75%,rgba(0,0,0,0))}.abs-globe[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%!important;height:100%!important;display:block;opacity:.9;filter:saturate(110%)}#canvasContainer[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;inset:0}#canvasContainer[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100%!important;height:100%!important;display:block;position:absolute;top:0;left:0}.hidden[_ngcontent-%COMP%]{opacity:0;visibility:hidden;transform:translateY(30px)}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp 1s cubic-bezier(.25,.46,.45,.94) forwards}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(40px);visibility:hidden}to{opacity:1;transform:translateY(0);visibility:visible}}']}),Ft})()},989:(Fn,mt,ae)=>{var U=ae(895),R=ae(256);class st extends U.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class at extends st{static makeCurrent(){(0,U.HT)(new at)}onAndCancel(h,u,_){return h.addEventListener(u,_,!1),()=>{h.removeEventListener(u,_,!1)}}dispatchEvent(h,u){h.dispatchEvent(u)}remove(h){h.parentNode&&h.parentNode.removeChild(h)}createElement(h,u){return(u=u||this.getDefaultDocument()).createElement(h)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(h){return h.nodeType===Node.ELEMENT_NODE}isShadowRoot(h){return h instanceof DocumentFragment}getGlobalEventTarget(h,u){return"window"===u?window:"document"===u?h:"body"===u?h.body:null}getBaseHref(h){const u=function Ft(){return qe=qe||document.querySelector("base"),qe?qe.getAttribute("href"):null}();return null==u?null:function Jt(f){vt=vt||document.createElement("a"),vt.setAttribute("href",f);const h=vt.pathname;return"/"===h.charAt(0)?h:`/${h}`}(u)}resetBaseElement(){qe=null}getUserAgent(){return window.navigator.userAgent}getCookie(h){return(0,U.Mx)(document.cookie,h)}}let vt,qe=null;const It=new R.OlP("TRANSITION_ID"),Le=[{provide:R.ip1,useFactory:function Ve(f,h,u){return()=>{u.get(R.CZH).donePromise.then(()=>{const _=(0,U.q)(),S=h.querySelectorAll(`style[ng-transition="${f}"]`);for(let L=0;L<S.length;L++)_.remove(S[L])})}},deps:[It,U.K0,R.zs3],multi:!0}];let fn=(()=>{class f{build(){return new XMLHttpRequest}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();const nt=new R.OlP("EventManagerPlugins");let Qt=(()=>{class f{constructor(u,_){this._zone=_,this._eventNameToPlugin=new Map,u.forEach(S=>{S.manager=this}),this._plugins=u.slice().reverse()}addEventListener(u,_,S){return this._findPluginFor(_).addEventListener(u,_,S)}addGlobalEventListener(u,_,S){return this._findPluginFor(_).addGlobalEventListener(u,_,S)}getZone(){return this._zone}_findPluginFor(u){const _=this._eventNameToPlugin.get(u);if(_)return _;const S=this._plugins;for(let L=0;L<S.length;L++){const z=S[L];if(z.supports(u))return this._eventNameToPlugin.set(u,z),z}throw new Error(`No event manager plugin found for event ${u}`)}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(nt),R.LFG(R.R0b))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();class Xt{constructor(h){this._doc=h}addGlobalEventListener(h,u,_){const S=(0,U.q)().getGlobalEventTarget(this._doc,h);if(!S)throw new Error(`Unsupported event target ${S} for event ${u}`);return this.addEventListener(S,u,_)}}let Nn=(()=>{class f{constructor(){this.usageCount=new Map}addStyles(u){for(const _ of u)1===this.changeUsageCount(_,1)&&this.onStyleAdded(_)}removeStyles(u){for(const _ of u)0===this.changeUsageCount(_,-1)&&this.onStyleRemoved(_)}onStyleRemoved(u){}onStyleAdded(u){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(u,_){const S=this.usageCount;let L=S.get(u)??0;return L+=_,L>0?S.set(u,L):S.delete(u),L}ngOnDestroy(){for(const u of this.getAllStyles())this.onStyleRemoved(u);this.usageCount.clear()}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})(),Pn=(()=>{class f extends Nn{constructor(u){super(),this.doc=u,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(u){for(const _ of this.hostNodes)this.addStyleToHost(_,u)}onStyleRemoved(u){const _=this.styleRef;_.get(u)?.forEach(L=>L.remove()),_.delete(u)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(u){this.hostNodes.add(u);for(const _ of this.getAllStyles())this.addStyleToHost(u,_)}removeHost(u){this.hostNodes.delete(u)}addStyleToHost(u,_){const S=this.doc.createElement("style");S.textContent=_,u.appendChild(S);const L=this.styleRef.get(_);L?L.push(S):this.styleRef.set(_,[S])}resetHostNodes(){const u=this.hostNodes;u.clear(),u.add(this.doc.head)}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(U.K0))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();const Di={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},kt=/%COMP%/g,St=new R.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function un(f,h){return h.flat(100).map(u=>u.replace(kt,f))}function jn(f){return h=>{if("__ngUnwrap__"===h)return f;!1===f(h)&&(h.preventDefault(),h.returnValue=!1)}}let $t=(()=>{class f{constructor(u,_,S,L){this.eventManager=u,this.sharedStylesHost=_,this.appId=S,this.removeStylesOnCompDestory=L,this.rendererByCompId=new Map,this.defaultRenderer=new Os(u)}createRenderer(u,_){if(!u||!_)return this.defaultRenderer;const S=this.getOrCreateRenderer(u,_);return S instanceof ye?S.applyToHost(u):S instanceof cs&&S.applyStyles(),S}getOrCreateRenderer(u,_){const S=this.rendererByCompId;let L=S.get(_.id);if(!L){const z=this.eventManager,ie=this.sharedStylesHost,he=this.removeStylesOnCompDestory;switch(_.encapsulation){case R.ifc.Emulated:L=new ye(z,ie,_,this.appId,he);break;case R.ifc.ShadowDom:return new cc(z,ie,u,_);default:L=new cs(z,ie,_,he)}L.onDestroy=()=>S.delete(_.id),S.set(_.id,L)}return L}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(Qt),R.LFG(Pn),R.LFG(R.AFp),R.LFG(St))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();class Os{constructor(h){this.eventManager=h,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(h,u){return u?document.createElementNS(Di[u]||u,h):document.createElement(h)}createComment(h){return document.createComment(h)}createText(h){return document.createTextNode(h)}appendChild(h,u){(Ia(h)?h.content:h).appendChild(u)}insertBefore(h,u,_){h&&(Ia(h)?h.content:h).insertBefore(u,_)}removeChild(h,u){h&&h.removeChild(u)}selectRootElement(h,u){let _="string"==typeof h?document.querySelector(h):h;if(!_)throw new Error(`The selector "${h}" did not match any elements`);return u||(_.textContent=""),_}parentNode(h){return h.parentNode}nextSibling(h){return h.nextSibling}setAttribute(h,u,_,S){if(S){u=S+":"+u;const L=Di[S];L?h.setAttributeNS(L,u,_):h.setAttribute(u,_)}else h.setAttribute(u,_)}removeAttribute(h,u,_){if(_){const S=Di[_];S?h.removeAttributeNS(S,u):h.removeAttribute(`${_}:${u}`)}else h.removeAttribute(u)}addClass(h,u){h.classList.add(u)}removeClass(h,u){h.classList.remove(u)}setStyle(h,u,_,S){S&(R.JOm.DashCase|R.JOm.Important)?h.style.setProperty(u,_,S&R.JOm.Important?"important":""):h.style[u]=_}removeStyle(h,u,_){_&R.JOm.DashCase?h.style.removeProperty(u):h.style[u]=""}setProperty(h,u,_){h[u]=_}setValue(h,u){h.nodeValue=u}listen(h,u,_){return"string"==typeof h?this.eventManager.addGlobalEventListener(h,u,jn(_)):this.eventManager.addEventListener(h,u,jn(_))}}function Ia(f){return"TEMPLATE"===f.tagName&&void 0!==f.content}class cc extends Os{constructor(h,u,_,S){super(h),this.sharedStylesHost=u,this.hostEl=_,this.shadowRoot=_.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const L=un(S.id,S.styles);for(const z of L){const ie=document.createElement("style");ie.textContent=z,this.shadowRoot.appendChild(ie)}}nodeOrShadowRoot(h){return h===this.hostEl?this.shadowRoot:h}appendChild(h,u){return super.appendChild(this.nodeOrShadowRoot(h),u)}insertBefore(h,u,_){return super.insertBefore(this.nodeOrShadowRoot(h),u,_)}removeChild(h,u){return super.removeChild(this.nodeOrShadowRoot(h),u)}parentNode(h){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(h)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class cs extends Os{constructor(h,u,_,S,L=_.id){super(h),this.sharedStylesHost=u,this.removeStylesOnCompDestory=S,this.rendererUsageCount=0,this.styles=un(L,_.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class ye extends cs{constructor(h,u,_,S,L){const z=S+"-"+_.id;super(h,u,_,L,z),this.contentAttr=function Fe(f){return"_ngcontent-%COMP%".replace(kt,f)}(z),this.hostAttr=function gt(f){return"_nghost-%COMP%".replace(kt,f)}(z)}applyToHost(h){this.applyStyles(),this.setAttribute(h,this.hostAttr,"")}createElement(h,u){const _=super.createElement(h,u);return super.setAttribute(_,this.contentAttr,""),_}}let be=(()=>{class f extends Xt{constructor(u){super(u)}supports(u){return!0}addEventListener(u,_,S){return u.addEventListener(_,S,!1),()=>this.removeEventListener(u,_,S)}removeEventListener(u,_,S){return u.removeEventListener(_,S)}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(U.K0))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();const Se=["alt","control","meta","shift"],Ee={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},et={alt:f=>f.altKey,control:f=>f.ctrlKey,meta:f=>f.metaKey,shift:f=>f.shiftKey};let je=(()=>{class f extends Xt{constructor(u){super(u)}supports(u){return null!=f.parseEventName(u)}addEventListener(u,_,S){const L=f.parseEventName(_),z=f.eventCallback(L.fullKey,S,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,U.q)().onAndCancel(u,L.domEventName,z))}static parseEventName(u){const _=u.toLowerCase().split("."),S=_.shift();if(0===_.length||"keydown"!==S&&"keyup"!==S)return null;const L=f._normalizeKey(_.pop());let z="",ie=_.indexOf("code");if(ie>-1&&(_.splice(ie,1),z="code."),Se.forEach(Ze=>{const ht=_.indexOf(Ze);ht>-1&&(_.splice(ht,1),z+=Ze+".")}),z+=L,0!=_.length||0===L.length)return null;const he={};return he.domEventName=S,he.fullKey=z,he}static matchEventFullKeyCode(u,_){let S=Ee[u.key]||u.key,L="";return _.indexOf("code.")>-1&&(S=u.code,L="code."),!(null==S||!S)&&(S=S.toLowerCase()," "===S?S="space":"."===S&&(S="dot"),Se.forEach(z=>{z!==S&&(0,et[z])(u)&&(L+=z+".")}),L+=S,L===_)}static eventCallback(u,_,S){return L=>{f.matchEventFullKeyCode(L,u)&&S.runGuarded(()=>_(L))}}static _normalizeKey(u){return"esc"===u?"escape":u}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(U.K0))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();const vr=(0,R.eFA)(R._c5,"browser",[{provide:R.Lbi,useValue:U.bD},{provide:R.g9A,useValue:function Ui(){at.makeCurrent()},multi:!0},{provide:U.K0,useFactory:function In(){return(0,R.RDi)(document),document},deps:[]}]),pi=new R.OlP(""),Lr=[{provide:R.rWj,useClass:class pt{addToWindow(h){R.dqk.getAngularTestability=(_,S=!0)=>{const L=h.findTestabilityInTree(_,S);if(null==L)throw new Error("Could not find testability for element.");return L},R.dqk.getAllAngularTestabilities=()=>h.getAllTestabilities(),R.dqk.getAllAngularRootElements=()=>h.getAllRootElements(),R.dqk.frameworkStabilizers||(R.dqk.frameworkStabilizers=[]),R.dqk.frameworkStabilizers.push(_=>{const S=R.dqk.getAllAngularTestabilities();let L=S.length,z=!1;const ie=function(he){z=z||he,L--,0==L&&_(z)};S.forEach(function(he){he.whenStable(ie)})})}findTestabilityInTree(h,u,_){return null==u?null:h.getTestability(u)??(_?(0,U.q)().isShadowRoot(u)?this.findTestabilityInTree(h,u.host,!0):this.findTestabilityInTree(h,u.parentElement,!0):null)}},deps:[]},{provide:R.lri,useClass:R.dDg,deps:[R.R0b,R.eoX,R.rWj]},{provide:R.dDg,useClass:R.dDg,deps:[R.R0b,R.eoX,R.rWj]}],ll=[{provide:R.zSh,useValue:"root"},{provide:R.qLn,useFactory:function ho(){return new R.qLn},deps:[]},{provide:nt,useClass:be,multi:!0,deps:[U.K0,R.R0b,R.Lbi]},{provide:nt,useClass:je,multi:!0,deps:[U.K0]},{provide:$t,useClass:$t,deps:[Qt,Pn,R.AFp,St]},{provide:R.FYo,useExisting:$t},{provide:Nn,useExisting:Pn},{provide:Pn,useClass:Pn,deps:[U.K0]},{provide:Qt,useClass:Qt,deps:[nt,R.R0b]},{provide:U.JF,useClass:fn,deps:[]},[]];let uc=(()=>{class f{constructor(u){}static withServerTransition(u){return{ngModule:f,providers:[{provide:R.AFp,useValue:u.appId},{provide:It,useExisting:R.AFp},Le]}}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(pi,12))},f.\u0275mod=R.oAB({type:f}),f.\u0275inj=R.cJS({providers:[...ll,...Lr],imports:[U.ez,R.hGG]}),f})(),Oi=(()=>{class f{constructor(u){this._doc=u}getTitle(){return this._doc.title}setTitle(u){this._doc.title=u||""}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(U.K0))},f.\u0275prov=R.Yz7({token:f,factory:function(u){let _=null;return _=u?new u:function dc(){return new Oi((0,R.LFG)(U.K0))}(),_},providedIn:"root"}),f})();typeof window<"u"&&window;var ws=ae(529),ii=ae(76),_t=ae(646),Un=ae(579);class ri extends Un.x{constructor(h){super(),this._value=h}get value(){return this.getValue()}_subscribe(h){const u=super._subscribe(h);return!u.closed&&h.next(this._value),u}getValue(){const{hasError:h,thrownError:u,_value:_}=this;if(h)throw u;return this._throwIfClosed(),_}next(h){super.next(this._value=h)}}const vi=(0,ae(888).d)(f=>function(){f(this),this.name="EmptyError",this.message="no elements in sequence"});var on=ae(751);const{isArray:Us}=Array,{getPrototypeOf:fo,prototype:ia,keys:cl}=Object;var Ra=ae(671),kn=ae(4);const{isArray:hc}=Array;var Cs=ae(669);var Mr=ae(403),uu=ae(672);function dl(...f){const h=(0,Cs.yG)(f),u=(0,Cs.jO)(f),{args:_,keys:S}=function Bs(f){if(1===f.length){const h=f[0];if(Us(h))return{args:h,keys:null};if(function ra(f){return f&&"object"==typeof f&&fo(f)===ia}(h)){const u=cl(h);return{args:u.map(_=>h[_]),keys:u}}}return{args:f,keys:null}}(f);if(0===_.length)return(0,ii.D)([],h);const L=new on.y(function Zn(f,h,u=Ra.y){return _=>{Zi(h,()=>{const{length:S}=f,L=new Array(S);let z=S,ie=S;for(let he=0;he<S;he++)Zi(h,()=>{const Ze=(0,ii.D)(f[he],h);let ht=!1;Ze.subscribe((0,Mr.x)(_,wn=>{L[he]=wn,ht||(ht=!0,ie--),ie||_.next(u(L.slice()))},()=>{--z||_.complete()}))},_)},_)}}(_,h,S?z=>function ul(f,h){return f.reduce((u,_,S)=>(u[_]=h[S],u),{})}(S,z):Ra.y));return u?L.pipe(function sa(f){return(0,kn.U)(h=>function fc(f,h){return hc(h)?f(...h):f(h)}(f,h))}(u)):L}function Zi(f,h,u){f?(0,uu.f)(u,f,h):h()}var Ki=ae(189);function hr(...f){return function Ao(){return(0,Ki.J)(1)}()((0,ii.D)(f,(0,Cs.yG)(f)))}var Do=ae(421);function hl(f){return new on.y(h=>{(0,Do.Xf)(f()).subscribe(h)})}var Pa=ae(635),ds=ae(576);function Rt(f,h){const u=(0,ds.m)(f)?f:()=>f,_=S=>S.error(u());return new on.y(h?S=>h.schedule(_,0,S):_)}var mn=ae(515),Ri=ae(727),Ci=ae(482);function hs(){return(0,Ci.e)((f,h)=>{let u=null;f._refCount++;const _=(0,Mr.x)(h,void 0,void 0,void 0,()=>{if(!f||f._refCount<=0||0<--f._refCount)return void(u=null);const S=f._connection,L=u;u=null,S&&(!L||S===L)&&S.unsubscribe(),h.unsubscribe()});f.subscribe(_),_.closed||(u=f.connect())})}class Wi extends on.y{constructor(h,u){super(),this.source=h,this.subjectFactory=u,this._subject=null,this._refCount=0,this._connection=null,(0,Ci.A)(h)&&(this.lift=h.lift)}_subscribe(h){return this.getSubject().subscribe(h)}getSubject(){const h=this._subject;return(!h||h.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:h}=this;this._subject=this._connection=null,h?.unsubscribe()}connect(){let h=this._connection;if(!h){h=this._connection=new Ri.w0;const u=this.getSubject();h.add(this.source.subscribe((0,Mr.x)(u,void 0,()=>{this._teardown(),u.complete()},_=>{this._teardown(),u.error(_)},()=>this._teardown()))),h.closed&&(this._connection=null,h=Ri.w0.EMPTY)}return h}refCount(){return hs()(this)}}function br(f,h){return(0,Ci.e)((u,_)=>{let S=null,L=0,z=!1;const ie=()=>z&&!S&&_.complete();u.subscribe((0,Mr.x)(_,he=>{S?.unsubscribe();let Ze=0;const ht=L++;(0,Do.Xf)(f(he,ht)).subscribe(S=(0,Mr.x)(_,wn=>_.next(h?h(he,wn,ht,Ze++):wn),()=>{S=null,ie()}))},()=>{z=!0,ie()}))})}function xi(f){return f<=0?()=>mn.E:(0,Ci.e)((h,u)=>{let _=0;h.subscribe((0,Mr.x)(u,S=>{++_<=f&&(u.next(S),f<=_&&u.complete())}))})}var es=ae(300),dn=ae(577);function oa(f){return(0,Ci.e)((h,u)=>{let _=!1;h.subscribe((0,Mr.x)(u,S=>{_=!0,u.next(S)},()=>{_||u.next(f),u.complete()}))})}function aa(f=du){return(0,Ci.e)((h,u)=>{let _=!1;h.subscribe((0,Mr.x)(u,S=>{_=!0,u.next(S)},()=>_?u.complete():u.error(f())))})}function du(){return new vi}function Pi(f,h){const u=arguments.length>=2;return _=>_.pipe(f?(0,es.h)((S,L)=>f(S,L,_)):Ra.y,xi(1),u?oa(h):aa(()=>new vi))}var Gi=ae(351);function Ji(f,h,u){const _=(0,ds.m)(f)||h||u?{next:f,error:h,complete:u}:f;return _?(0,Ci.e)((S,L)=>{var z;null===(z=_.subscribe)||void 0===z||z.call(_);let ie=!0;S.subscribe((0,Mr.x)(L,he=>{var Ze;null===(Ze=_.next)||void 0===Ze||Ze.call(_,he),L.next(he)},()=>{var he;ie=!1,null===(he=_.complete)||void 0===he||he.call(_),L.complete()},he=>{var Ze;ie=!1,null===(Ze=_.error)||void 0===Ze||Ze.call(_,he),L.error(he)},()=>{var he,Ze;ie&&(null===(he=_.unsubscribe)||void 0===he||he.call(_)),null===(Ze=_.finalize)||void 0===Ze||Ze.call(_)}))}):Ra.y}function fs(f){return(0,Ci.e)((h,u)=>{let L,_=null,S=!1;_=h.subscribe((0,Mr.x)(u,void 0,void 0,z=>{L=(0,Do.Xf)(f(z,fs(f)(h))),_?(_.unsubscribe(),_=null,L.subscribe(u)):S=!0})),S&&(_.unsubscribe(),_=null,L.subscribe(u))})}function Io(f,h){return(0,Ci.e)(function ps(f,h,u,_,S){return(L,z)=>{let ie=u,he=h,Ze=0;L.subscribe((0,Mr.x)(z,ht=>{const wn=Ze++;he=ie?f(he,ht,wn):(ie=!0,ht),_&&z.next(he)},S&&(()=>{ie&&z.next(he),z.complete()})))}}(f,h,arguments.length>=2,!0))}function Na(f){return f<=0?()=>mn.E:(0,Ci.e)((h,u)=>{let _=[];h.subscribe((0,Mr.x)(u,S=>{_.push(S),f<_.length&&_.shift()},()=>{for(const S of _)u.next(S);u.complete()},void 0,()=>{_=null}))})}function oi(f,h){const u=arguments.length>=2;return _=>_.pipe(f?(0,es.h)((S,L)=>f(S,L,_)):Ra.y,Na(1),u?oa(h):aa(()=>new vi))}function Oa(f){return(0,Ci.e)((h,u)=>{try{h.subscribe(u)}finally{u.add(f)}})}const Sn="primary",la=Symbol("RouteTitle");class ml{constructor(h){this.params=h||{}}has(h){return Object.prototype.hasOwnProperty.call(this.params,h)}get(h){if(this.has(h)){const u=this.params[h];return Array.isArray(u)?u[0]:u}return null}getAll(h){if(this.has(h)){const u=this.params[h];return Array.isArray(u)?u:[u]}return[]}get keys(){return Object.keys(this.params)}}function ir(f){return new ml(f)}function Qf(f,h,u){const _=u.path.split("/");if(_.length>f.length||"full"===u.pathMatch&&(h.hasChildren()||_.length<f.length))return null;const S={};for(let L=0;L<_.length;L++){const z=_[L],ie=f[L];if(z.startsWith(":"))S[z.substring(1)]=ie;else if(z!==ie.path)return null}return{consumed:f.slice(0,_.length),posParams:S}}function rr(f,h){const u=f?Object.keys(f):void 0,_=h?Object.keys(h):void 0;if(!u||!_||u.length!=_.length)return!1;let S;for(let L=0;L<u.length;L++)if(S=u[L],!hu(f[S],h[S]))return!1;return!0}function hu(f,h){if(Array.isArray(f)&&Array.isArray(h)){if(f.length!==h.length)return!1;const u=[...f].sort(),_=[...h].sort();return u.every((S,L)=>_[L]===S)}return f===h}function Ts(f){return Array.prototype.concat.apply([],f)}function Fa(f){return f.length>0?f[f.length-1]:null}function gi(f,h){for(const u in f)f.hasOwnProperty(u)&&h(f[u],u)}function As(f){return(0,R.CqO)(f)?f:(0,R.QGY)(f)?(0,ii.D)(Promise.resolve(f)):(0,_t.of)(f)}const po=!1,ci={exact:function Nh(f,h,u){if(!ca(f.segments,h.segments)||!Lh(f.segments,h.segments,u)||f.numberOfChildren!==h.numberOfChildren)return!1;for(const _ in h.children)if(!f.children[_]||!Nh(f.children[_],h.children[_],u))return!1;return!0},subset:ep},Em={exact:function wm(f,h){return rr(f,h)},subset:function Cm(f,h){return Object.keys(h).length<=Object.keys(f).length&&Object.keys(h).every(u=>hu(f[u],h[u]))},ignored:()=>!0};function gl(f,h,u){return ci[u.paths](f.root,h.root,u.matrixParams)&&Em[u.queryParams](f.queryParams,h.queryParams)&&!("exact"===u.fragment&&f.fragment!==h.fragment)}function ep(f,h,u){return tp(f,h,h.segments,u)}function tp(f,h,u,_){if(f.segments.length>u.length){const S=f.segments.slice(0,u.length);return!(!ca(S,u)||h.hasChildren()||!Lh(S,u,_))}if(f.segments.length===u.length){if(!ca(f.segments,u)||!Lh(f.segments,u,_))return!1;for(const S in h.children)if(!f.children[S]||!ep(f.children[S],h.children[S],_))return!1;return!0}{const S=u.slice(0,f.segments.length),L=u.slice(f.segments.length);return!!(ca(f.segments,S)&&Lh(f.segments,S,_)&&f.children[Sn])&&tp(f.children[Sn],h,L,_)}}function Lh(f,h,u){return h.every((_,S)=>Em[u](f[S].parameters,_.parameters))}class _l{constructor(h=new Wn([],{}),u={},_=null){this.root=h,this.queryParams=u,this.fragment=_}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ir(this.queryParams)),this._queryParamMap}toString(){return Tm.serialize(this)}}class Wn{constructor(h,u){this.segments=h,this.children=u,this.parent=null,gi(u,(_,S)=>_.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Js(this)}}class gd{constructor(h,u){this.path=h,this.parameters=u}get parameterMap(){return this._parameterMap||(this._parameterMap=ir(this.parameters)),this._parameterMap}toString(){return Uh(this)}}function ca(f,h){return f.length===h.length&&f.every((u,_)=>u.path===h[_].path)}let pc=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:function(){return new fu},providedIn:"root"}),f})();class fu{parse(h){const u=new gs(h);return new _l(u.parseRootSegment(),u.parseQueryParams(),u.parseFragment())}serialize(h){const u=`/${mc(h.root,!0)}`,_=function np(f){const h=Object.keys(f).map(u=>{const _=f[u];return Array.isArray(_)?_.map(S=>`${gc(u)}=${gc(S)}`).join("&"):`${gc(u)}=${gc(_)}`}).filter(u=>!!u);return h.length?`?${h.join("&")}`:""}(h.queryParams);return`${u}${_}${"string"==typeof h.fragment?`#${function Fh(f){return encodeURI(f)}(h.fragment)}`:""}`}}const Tm=new fu;function Js(f){return f.segments.map(h=>Uh(h)).join("/")}function mc(f,h){if(!f.hasChildren())return Js(f);if(h){const u=f.children[Sn]?mc(f.children[Sn],!1):"",_=[];return gi(f.children,(S,L)=>{L!==Sn&&_.push(`${L}:${mc(S,!1)}`)}),_.length>0?`${u}(${_.join("//")})`:u}{const u=function Oh(f,h){let u=[];return gi(f.children,(_,S)=>{S===Sn&&(u=u.concat(h(_,S)))}),gi(f.children,(_,S)=>{S!==Sn&&(u=u.concat(h(_,S)))}),u}(f,(_,S)=>S===Sn?[mc(f.children[Sn],!1)]:[`${S}:${mc(_,!1)}`]);return 1===Object.keys(f.children).length&&null!=f.children[Sn]?`${Js(f)}/${u[0]}`:`${Js(f)}/(${u.join("//")})`}}function ua(f){return encodeURIComponent(f).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function gc(f){return ua(f).replace(/%3B/gi,";")}function pu(f){return ua(f).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yl(f){return decodeURIComponent(f)}function mo(f){return yl(f.replace(/\+/g,"%20"))}function Uh(f){return`${pu(f.path)}${function vl(f){return Object.keys(f).map(h=>`;${pu(h)}=${pu(f[h])}`).join("")}(f.parameters)}`}const ks=/^[^\/()?;=#]+/;function mu(f){const h=f.match(ks);return h?h[0]:""}const Bh=/^[^=?&#]+/,ip=/^[^&#]+/;class gs{constructor(h){this.url=h,this.remaining=h}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Wn([],{}):new Wn([],this.parseChildren())}parseQueryParams(){const h={};if(this.consumeOptional("?"))do{this.parseQueryParam(h)}while(this.consumeOptional("&"));return h}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const h=[];for(this.peekStartsWith("(")||h.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),h.push(this.parseSegment());let u={};this.peekStartsWith("/(")&&(this.capture("/"),u=this.parseParens(!0));let _={};return this.peekStartsWith("(")&&(_=this.parseParens(!1)),(h.length>0||Object.keys(u).length>0)&&(_[Sn]=new Wn(h,u)),_}parseSegment(){const h=mu(this.remaining);if(""===h&&this.peekStartsWith(";"))throw new R.vHH(4009,po);return this.capture(h),new gd(yl(h),this.parseMatrixParams())}parseMatrixParams(){const h={};for(;this.consumeOptional(";");)this.parseParam(h);return h}parseParam(h){const u=mu(this.remaining);if(!u)return;this.capture(u);let _="";if(this.consumeOptional("=")){const S=mu(this.remaining);S&&(_=S,this.capture(_))}h[yl(u)]=yl(_)}parseQueryParam(h){const u=function Or(f){const h=f.match(Bh);return h?h[0]:""}(this.remaining);if(!u)return;this.capture(u);let _="";if(this.consumeOptional("=")){const z=function gu(f){const h=f.match(ip);return h?h[0]:""}(this.remaining);z&&(_=z,this.capture(_))}const S=mo(u),L=mo(_);if(h.hasOwnProperty(S)){let z=h[S];Array.isArray(z)||(z=[z],h[S]=z),z.push(L)}else h[S]=L}parseParens(h){const u={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const _=mu(this.remaining),S=this.remaining[_.length];if("/"!==S&&")"!==S&&";"!==S)throw new R.vHH(4010,po);let L;_.indexOf(":")>-1?(L=_.slice(0,_.indexOf(":")),this.capture(L),this.capture(":")):h&&(L=Sn);const z=this.parseChildren();u[L]=1===Object.keys(z).length?z[Sn]:new Wn([],z),this.consumeOptional("//")}return u}peekStartsWith(h){return this.remaining.startsWith(h)}consumeOptional(h){return!!this.peekStartsWith(h)&&(this.remaining=this.remaining.substring(h.length),!0)}capture(h){if(!this.consumeOptional(h))throw new R.vHH(4011,po)}}function ts(f){return f.segments.length>0?new Wn([],{[Sn]:f}):f}function go(f){const h={};for(const _ of Object.keys(f.children)){const L=go(f.children[_]);(L.segments.length>0||L.hasChildren())&&(h[_]=L)}return function xl(f){if(1===f.numberOfChildren&&f.children[Sn]){const h=f.children[Sn];return new Wn(f.segments.concat(h.segments),h.children)}return f}(new Wn(f.segments,h))}function sr(f){return f instanceof _l}const kh=!1;function Ro(f,h,u,_,S){if(0===u.length)return Ct(h.root,h.root,h.root,_,S);const L=function Hh(f){if("string"==typeof f[0]&&1===f.length&&"/"===f[0])return new Vh(!0,0,f);let h=0,u=!1;const _=f.reduce((S,L,z)=>{if("object"==typeof L&&null!=L){if(L.outlets){const ie={};return gi(L.outlets,(he,Ze)=>{ie[Ze]="string"==typeof he?he.split("/"):he}),[...S,{outlets:ie}]}if(L.segmentPath)return[...S,L.segmentPath]}return"string"!=typeof L?[...S,L]:0===z?(L.split("/").forEach((ie,he)=>{0==he&&"."===ie||(0==he&&""===ie?u=!0:".."===ie?h++:""!=ie&&S.push(ie))}),S):[...S,L]},[]);return new Vh(u,h,_)}(u);return L.toRoot()?Ct(h.root,h.root,new Wn([],{}),_,S):function z(he){const Ze=function rp(f,h,u,_){if(f.isAbsolute)return new yo(h.root,!0,0);if(-1===_)return new yo(u,u===h.root,0);return function yd(f,h,u){let _=f,S=h,L=u;for(;L>S;){if(L-=S,_=_.parent,!_)throw new R.vHH(4005,kh&&"Invalid number of '../'");S=_.segments.length}return new yo(_,!1,S-L)}(u,_+(Vs(f.commands[0])?0:1),f.numberOfDoubleDots)}(L,h,f.snapshot?._urlSegment,he),ht=Ze.processChildren?Ua(Ze.segmentGroup,Ze.index,L.commands):Xn(Ze.segmentGroup,Ze.index,L.commands);return Ct(h.root,Ze.segmentGroup,ht,_,S)}(f.snapshot?._lastPathIndex)}function Vs(f){return"object"==typeof f&&null!=f&&!f.outlets&&!f.segmentPath}function Yt(f){return"object"==typeof f&&null!=f&&f.outlets}function Ct(f,h,u,_,S){let z,L={};_&&gi(_,(he,Ze)=>{L[Ze]=Array.isArray(he)?he.map(ht=>`${ht}`):`${he}`}),z=f===h?u:_d(f,h,u);const ie=ts(go(z));return new _l(ie,L,S)}function _d(f,h,u){const _={};return gi(f.children,(S,L)=>{_[L]=S===h?u:_d(S,h,u)}),new Wn(f.segments,_)}class Vh{constructor(h,u,_){if(this.isAbsolute=h,this.numberOfDoubleDots=u,this.commands=_,h&&_.length>0&&Vs(_[0]))throw new R.vHH(4003,kh&&"Root segment cannot have matrix parameters");const S=_.find(Yt);if(S&&S!==Fa(_))throw new R.vHH(4004,kh&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class yo{constructor(h,u,_){this.segmentGroup=h,this.processChildren=u,this.index=_}}function Xn(f,h,u){if(f||(f=new Wn([],{})),0===f.segments.length&&f.hasChildren())return Ua(f,h,u);const _=function _u(f,h,u){let _=0,S=h;const L={match:!1,pathIndex:0,commandIndex:0};for(;S<f.segments.length;){if(_>=u.length)return L;const z=f.segments[S],ie=u[_];if(Yt(ie))break;const he=`${ie}`,Ze=_<u.length-1?u[_+1]:null;if(S>0&&void 0===he)break;if(he&&Ze&&"object"==typeof Ze&&void 0===Ze.outlets){if(!Gr(he,Ze,z))return L;_+=2}else{if(!Gr(he,{},z))return L;_++}S++}return{match:!0,pathIndex:S,commandIndex:_}}(f,h,u),S=u.slice(_.commandIndex);if(_.match&&_.pathIndex<f.segments.length){const L=new Wn(f.segments.slice(0,_.pathIndex),{});return L.children[Sn]=new Wn(f.segments.slice(_.pathIndex),f.children),Ua(L,0,S)}return _.match&&0===S.length?new Wn(f.segments,{}):_.match&&!f.hasChildren()?or(f,h,u):_.match?Ua(f,0,S):or(f,h,u)}function Ua(f,h,u){if(0===u.length)return new Wn(f.segments,{});{const _=function Ge(f){return Yt(f[0])?f[0].outlets:{[Sn]:f}}(u),S={};if(!_[Sn]&&f.children[Sn]&&1===f.numberOfChildren&&0===f.children[Sn].segments.length){const L=Ua(f.children[Sn],h,u);return new Wn(f.segments,L.children)}return gi(_,(L,z)=>{"string"==typeof L&&(L=[L]),null!==L&&(S[z]=Xn(f.children[z],h,L))}),gi(f.children,(L,z)=>{void 0===_[z]&&(S[z]=L)}),new Wn(f.segments,S)}}function or(f,h,u){const _=f.segments.slice(0,h);let S=0;for(;S<u.length;){const L=u[S];if(Yt(L)){const he=vd(L.outlets);return new Wn(_,he)}if(0===S&&Vs(u[0])){_.push(new gd(f.segments[h].path,Po(u[0]))),S++;continue}const z=Yt(L)?L.outlets[Sn]:`${L}`,ie=S<u.length-1?u[S+1]:null;z&&ie&&Vs(ie)?(_.push(new gd(z,Po(ie))),S+=2):(_.push(new gd(z,{})),S++)}return new Wn(_,{})}function vd(f){const h={};return gi(f,(u,_)=>{"string"==typeof u&&(u=[u]),null!==u&&(h[_]=or(new Wn([],{}),0,u))}),h}function Po(f){const h={};return gi(f,(u,_)=>h[_]=`${u}`),h}function Gr(f,h,u){return f==u.path&&rr(h,u.parameters)}const Ba="imperative";class Hs{constructor(h,u){this.id=h,this.url=u}}class _c extends Hs{constructor(h,u,_="imperative",S=null){super(h,u),this.type=0,this.navigationTrigger=_,this.restoredState=S}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class $i extends Hs{constructor(h,u,_){super(h,u),this.urlAfterRedirects=_,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Tn extends Hs{constructor(h,u,_,S){super(h,u),this.reason=_,this.code=S,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fr extends Hs{constructor(h,u,_,S){super(h,u),this.reason=_,this.code=S,this.type=16}}class Ce extends Hs{constructor(h,u,_,S){super(h,u),this.error=_,this.target=S,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class wr extends Hs{constructor(h,u,_,S){super(h,u),this.urlAfterRedirects=_,this.state=S,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class K extends Hs{constructor(h,u,_,S){super(h,u),this.urlAfterRedirects=_,this.state=S,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eo extends Hs{constructor(h,u,_,S,L){super(h,u),this.urlAfterRedirects=_,this.state=S,this.shouldActivate=L,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Gh extends Hs{constructor(h,u,_,S){super(h,u),this.urlAfterRedirects=_,this.state=S,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rn extends Hs{constructor(h,u,_,S){super(h,u),this.urlAfterRedirects=_,this.state=S,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xd{constructor(h){this.route=h,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Wh{constructor(h){this.route=h,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Md{constructor(h){this.snapshot=h,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class da{constructor(h){this.snapshot=h,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ml{constructor(h){this.snapshot=h,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bd{constructor(h){this.snapshot=h,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yu{constructor(h,u,_){this.routerEvent=h,this.position=u,this.anchor=_,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let xu=(()=>{class f{createUrlTree(u,_,S,L,z,ie){return Ro(u||_.root,S,L,z,ie)}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})(),$h=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:function(h){return xu.\u0275fac(h)},providedIn:"root"}),f})();class Kn{constructor(h){this._root=h}get root(){return this._root.value}parent(h){const u=this.pathFromRoot(h);return u.length>1?u[u.length-2]:null}children(h){const u=Ds(h,this._root);return u?u.children.map(_=>_.value):[]}firstChild(h){const u=Ds(h,this._root);return u&&u.children.length>0?u.children[0].value:null}siblings(h){const u=ha(h,this._root);return u.length<2?[]:u[u.length-2].children.map(S=>S.value).filter(S=>S!==h)}pathFromRoot(h){return ha(h,this._root).map(u=>u.value)}}function Ds(f,h){if(f===h.value)return h;for(const u of h.children){const _=Ds(f,u);if(_)return _}return null}function ha(f,h){if(f===h.value)return[h];for(const u of h.children){const _=ha(f,u);if(_.length)return _.unshift(h),_}return[]}class _s{constructor(h,u){this.value=h,this.children=u}toString(){return`TreeNode(${this.value})`}}function ar(f){const h={};return f&&f.children.forEach(u=>h[u.value.outlet]=u),h}class fa extends Kn{constructor(h,u){super(h),this.snapshot=u,_e(this,h)}toString(){return this.snapshot.toString()}}function _i(f,h){const u=function Mu(f,h){const z=new G([],{},{},"",{},Sn,h,null,f.root,-1,{});return new te("",new _s(z,[]))}(f,h),_=new ri([new gd("",{})]),S=new ri({}),L=new ri({}),z=new ri({}),ie=new ri(""),he=new T(_,S,z,ie,L,Sn,h,u.root);return he.snapshot=u.root,new fa(new _s(he,[]),u)}class T{constructor(h,u,_,S,L,z,ie,he){this.url=h,this.params=u,this.queryParams=_,this.fragment=S,this.data=L,this.outlet=z,this.component=ie,this.title=this.data?.pipe((0,kn.U)(Ze=>Ze[la]))??(0,_t.of)(void 0),this._futureSnapshot=he}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,kn.U)(h=>ir(h)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,kn.U)(h=>ir(h)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function B(f,h="emptyOnly"){const u=f.pathFromRoot;let _=0;if("always"!==h)for(_=u.length-1;_>=1;){const S=u[_],L=u[_-1];if(S.routeConfig&&""===S.routeConfig.path)_--;else{if(L.component)break;_--}}return function P(f){return f.reduce((h,u)=>({params:{...h.params,...u.params},data:{...h.data,...u.data},resolve:{...u.data,...h.resolve,...u.routeConfig?.data,...u._resolvedData}}),{params:{},data:{},resolve:{}})}(u.slice(_))}class G{get title(){return this.data?.[la]}constructor(h,u,_,S,L,z,ie,he,Ze,ht,wn){this.url=h,this.params=u,this.queryParams=_,this.fragment=S,this.data=L,this.outlet=z,this.component=ie,this.routeConfig=he,this._urlSegment=Ze,this._lastPathIndex=ht,this._resolve=wn}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ir(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ir(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(_=>_.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class te extends Kn{constructor(h,u){super(u),this.url=h,_e(this,u)}toString(){return Ae(this._root)}}function _e(f,h){h.value._routerState=f,h.children.forEach(u=>_e(f,u))}function Ae(f){const h=f.children.length>0?` { ${f.children.map(Ae).join(", ")} } `:"";return`${f.value}${h}`}function Ht(f){if(f.snapshot){const h=f.snapshot,u=f._futureSnapshot;f.snapshot=u,rr(h.queryParams,u.queryParams)||f.queryParams.next(u.queryParams),h.fragment!==u.fragment&&f.fragment.next(u.fragment),rr(h.params,u.params)||f.params.next(u.params),function ms(f,h){if(f.length!==h.length)return!1;for(let u=0;u<f.length;++u)if(!rr(f[u],h[u]))return!1;return!0}(h.url,u.url)||f.url.next(u.url),rr(h.data,u.data)||f.data.next(u.data)}else f.snapshot=f._futureSnapshot,f.data.next(f._futureSnapshot.data)}function Qn(f,h){const u=rr(f.params,h.params)&&function y_(f,h){return ca(f,h)&&f.every((u,_)=>rr(u.parameters,h[_].parameters))}(f.url,h.url);return u&&!(!f.parent!=!h.parent)&&(!f.parent||Qn(f.parent,h.parent))}function gn(f,h,u){if(u&&f.shouldReuseRoute(h.value,u.value.snapshot)){const _=u.value;_._futureSnapshot=h.value;const S=function _n(f,h,u){return h.children.map(_=>{for(const S of u.children)if(f.shouldReuseRoute(_.value,S.value.snapshot))return gn(f,_,S);return gn(f,_)})}(f,h,u);return new _s(_,S)}{if(f.shouldAttach(h.value)){const L=f.retrieve(h.value);if(null!==L){const z=L.route;return z.value._futureSnapshot=h.value,z.children=h.children.map(ie=>gn(f,ie)),z}}const _=function Yn(f){return new T(new ri(f.url),new ri(f.params),new ri(f.queryParams),new ri(f.fragment),new ri(f.data),f.outlet,f.component,f)}(h.value),S=h.children.map(L=>gn(f,L));return new _s(_,S)}}const ai="ngNavigationCancelingError";function ki(f,h){const{redirectTo:u,navigationBehaviorOptions:_}=sr(h)?{redirectTo:h,navigationBehaviorOptions:void 0}:h,S=Fr(!1,0,h);return S.url=u,S.navigationBehaviorOptions=_,S}function Fr(f,h,u){const _=new Error("NavigationCancelingError: "+(f||""));return _[ai]=!0,_.cancellationCode=h,u&&(_.url=u),_}function ns(f){return is(f)&&sr(f.url)}function is(f){return f&&f[ai]}class pr{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ur,this.attachRef=null}}let Ur=(()=>{class f{constructor(){this.contexts=new Map}onChildOutletCreated(u,_){const S=this.getOrCreateContext(u);S.outlet=_,this.contexts.set(u,S)}onChildOutletDestroyed(u){const _=this.getContext(u);_&&(_.outlet=null,_.attachRef=null)}onOutletDeactivated(){const u=this.contexts;return this.contexts=new Map,u}onOutletReAttached(u){this.contexts=u}getOrCreateContext(u){let _=this.getContext(u);return _||(_=new pr,this.contexts.set(u,_)),_}getContext(u){return this.contexts.get(u)||null}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();const ys=!1;let vs=(()=>{class f{constructor(){this.activated=null,this._activatedRoute=null,this.name=Sn,this.activateEvents=new R.vpe,this.deactivateEvents=new R.vpe,this.attachEvents=new R.vpe,this.detachEvents=new R.vpe,this.parentContexts=(0,R.f3M)(Ur),this.location=(0,R.f3M)(R.s_b),this.changeDetector=(0,R.f3M)(R.sBO),this.environmentInjector=(0,R.f3M)(R.lqb)}ngOnChanges(u){if(u.name){const{firstChange:_,previousValue:S}=u.name;if(_)return;this.isTrackedInParentContexts(S)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(S)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(u){return this.parentContexts.getContext(u)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const u=this.parentContexts.getContext(this.name);u?.route&&(u.attachRef?this.attach(u.attachRef,u.route):this.activateWith(u.route,u.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new R.vHH(4012,ys);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new R.vHH(4012,ys);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new R.vHH(4012,ys);this.location.detach();const u=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(u.instance),u}attach(u,_){this.activated=u,this._activatedRoute=_,this.location.insert(u.hostView),this.attachEvents.emit(u.instance)}deactivate(){if(this.activated){const u=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(u)}}activateWith(u,_){if(this.isActivated)throw new R.vHH(4013,ys);this._activatedRoute=u;const S=this.location,z=u.snapshot.component,ie=this.parentContexts.getOrCreateContext(this.name).children,he=new bu(u,ie,S.injector);if(_&&function ka(f){return!!f.resolveComponentFactory}(_)){const Ze=_.resolveComponentFactory(z);this.activated=S.createComponent(Ze,S.length,he)}else this.activated=S.createComponent(z,{index:S.length,injector:he,environmentInjector:_??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275dir=R.lG2({type:f,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[R.TTD]}),f})();class bu{constructor(h,u,_){this.route=h,this.childContexts=u,this.parent=_}get(h,u){return h===T?this.route:h===Ur?this.childContexts:this.parent.get(h,u)}}let pa=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275cmp=R.Xpm({type:f,selectors:[["ng-component"]],standalone:!0,features:[R.jDz],decls:1,vars:0,template:function(u,_){1&u&&R._UZ(0,"router-outlet")},dependencies:[vs],encapsulation:2}),f})();function jh(f,h){return f.providers&&!f._injector&&(f._injector=(0,R.MMx)(f.providers,h,`Route: ${f.path}`)),f._injector??h}function Cl(f){const h=f.children&&f.children.map(Cl),u=h?{...f,children:h}:{...f};return!u.component&&!u.loadComponent&&(h||u.loadChildren)&&u.outlet&&u.outlet!==Sn&&(u.component=pa),u}function Is(f){return f.outlet||Sn}function rs(f,h){const u=f.filter(_=>Is(_)===h);return u.push(...f.filter(_=>Is(_)!==h)),u}function yn(f){if(!f)return null;if(f.routeConfig?._injector)return f.routeConfig._injector;for(let h=f.parent;h;h=h.parent){const u=h.routeConfig;if(u?._loadedInjector)return u._loadedInjector;if(u?._injector)return u._injector}return null}class zs{constructor(h,u,_,S){this.routeReuseStrategy=h,this.futureState=u,this.currState=_,this.forwardEvent=S}activate(h){const u=this.futureState._root,_=this.currState?this.currState._root:null;this.deactivateChildRoutes(u,_,h),Ht(this.futureState.root),this.activateChildRoutes(u,_,h)}deactivateChildRoutes(h,u,_){const S=ar(u);h.children.forEach(L=>{const z=L.value.outlet;this.deactivateRoutes(L,S[z],_),delete S[z]}),gi(S,(L,z)=>{this.deactivateRouteAndItsChildren(L,_)})}deactivateRoutes(h,u,_){const S=h.value,L=u?u.value:null;if(S===L)if(S.component){const z=_.getContext(S.outlet);z&&this.deactivateChildRoutes(h,u,z.children)}else this.deactivateChildRoutes(h,u,_);else L&&this.deactivateRouteAndItsChildren(u,_)}deactivateRouteAndItsChildren(h,u){h.value.component&&this.routeReuseStrategy.shouldDetach(h.value.snapshot)?this.detachAndStoreRouteSubtree(h,u):this.deactivateRouteAndOutlet(h,u)}detachAndStoreRouteSubtree(h,u){const _=u.getContext(h.value.outlet),S=_&&h.value.component?_.children:u,L=ar(h);for(const z of Object.keys(L))this.deactivateRouteAndItsChildren(L[z],S);if(_&&_.outlet){const z=_.outlet.detach(),ie=_.children.onOutletDeactivated();this.routeReuseStrategy.store(h.value.snapshot,{componentRef:z,route:h,contexts:ie})}}deactivateRouteAndOutlet(h,u){const _=u.getContext(h.value.outlet),S=_&&h.value.component?_.children:u,L=ar(h);for(const z of Object.keys(L))this.deactivateRouteAndItsChildren(L[z],S);_&&(_.outlet&&(_.outlet.deactivate(),_.children.onOutletDeactivated()),_.attachRef=null,_.resolver=null,_.route=null)}activateChildRoutes(h,u,_){const S=ar(u);h.children.forEach(L=>{this.activateRoutes(L,S[L.value.outlet],_),this.forwardEvent(new bd(L.value.snapshot))}),h.children.length&&this.forwardEvent(new da(h.value.snapshot))}activateRoutes(h,u,_){const S=h.value,L=u?u.value:null;if(Ht(S),S===L)if(S.component){const z=_.getOrCreateContext(S.outlet);this.activateChildRoutes(h,u,z.children)}else this.activateChildRoutes(h,u,_);else if(S.component){const z=_.getOrCreateContext(S.outlet);if(this.routeReuseStrategy.shouldAttach(S.snapshot)){const ie=this.routeReuseStrategy.retrieve(S.snapshot);this.routeReuseStrategy.store(S.snapshot,null),z.children.onOutletReAttached(ie.contexts),z.attachRef=ie.componentRef,z.route=ie.route.value,z.outlet&&z.outlet.attach(ie.componentRef,ie.route.value),Ht(ie.route.value),this.activateChildRoutes(h,null,z.children)}else{const ie=yn(S.snapshot),he=ie?.get(R._Vd)??null;z.attachRef=null,z.route=S,z.resolver=he,z.injector=ie,z.outlet&&z.outlet.activateWith(S,z.injector),this.activateChildRoutes(h,null,z.children)}}else this.activateChildRoutes(h,null,_)}}class Xh{constructor(h){this.path=h,this.route=this.path[this.path.length-1]}}class yc{constructor(h,u){this.component=h,this.route=u}}function No(f,h,u){const _=f._root;return Tl(_,h?h._root:null,u,[_.value])}function Cr(f,h){const u=Symbol(),_=h.get(f,u);return _===u?"function"!=typeof f||(0,R.Z0I)(f)?h.get(f):f:_}function Tl(f,h,u,_,S={canDeactivateChecks:[],canActivateChecks:[]}){const L=ar(h);return f.children.forEach(z=>{(function Yh(f,h,u,_,S={canDeactivateChecks:[],canActivateChecks:[]}){const L=f.value,z=h?h.value:null,ie=u?u.getContext(f.value.outlet):null;if(z&&L.routeConfig===z.routeConfig){const he=function Lo(f,h,u){if("function"==typeof u)return u(f,h);switch(u){case"pathParamsChange":return!ca(f.url,h.url);case"pathParamsOrQueryParamsChange":return!ca(f.url,h.url)||!rr(f.queryParams,h.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Qn(f,h)||!rr(f.queryParams,h.queryParams);default:return!Qn(f,h)}}(z,L,L.routeConfig.runGuardsAndResolvers);he?S.canActivateChecks.push(new Xh(_)):(L.data=z.data,L._resolvedData=z._resolvedData),Tl(f,h,L.component?ie?ie.children:null:u,_,S),he&&ie&&ie.outlet&&ie.outlet.isActivated&&S.canDeactivateChecks.push(new yc(ie.outlet.component,z))}else z&&Al(h,ie,S),S.canActivateChecks.push(new Xh(_)),Tl(f,null,L.component?ie?ie.children:null:u,_,S)})(z,L[z.value.outlet],u,_.concat([z.value]),S),delete L[z.value.outlet]}),gi(L,(z,ie)=>Al(z,u.getContext(ie),S)),S}function Al(f,h,u){const _=ar(f),S=f.value;gi(_,(L,z)=>{Al(L,S.component?h?h.children.getContext(z):null:h,u)}),u.canDeactivateChecks.push(new yc(S.component&&h&&h.outlet&&h.outlet.isActivated?h.outlet.component:null,S))}function Va(f){return"function"==typeof f}function Td(f){return f instanceof vi||"EmptyError"===f?.name}const xc=Symbol("INITIAL_VALUE");function ga(){return br(f=>dl(f.map(h=>h.pipe(xi(1),function fl(...f){const h=(0,Cs.yG)(f);return(0,Ci.e)((u,_)=>{(h?hr(f,u,h):hr(f,u)).subscribe(_)})}(xc)))).pipe((0,kn.U)(h=>{for(const u of h)if(!0!==u){if(u===xc)return xc;if(!1===u||u instanceof _l)return u}return!0}),(0,es.h)(h=>h!==xc),xi(1)))}function bc(f){return(0,Pa.z)(Ji(h=>{if(sr(h))throw ki(0,h)}),(0,kn.U)(h=>!0===h))}const Ad={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qh(f,h,u,_,S){const L=Dd(f,h,u);return L.matched?function Im(f,h,u,_){const S=h.canMatch;if(!S||0===S.length)return(0,_t.of)(!0);const L=S.map(z=>{const ie=Cr(z,f);return As(function Am(f){return f&&Va(f.canMatch)}(ie)?ie.canMatch(h,u):f.runInContext(()=>ie(h,u)))});return(0,_t.of)(L).pipe(ga(),bc())}(_=jh(h,_),h,u).pipe((0,kn.U)(z=>!0===z?L:{...Ad})):(0,_t.of)(L)}function Dd(f,h,u){if(""===h.path)return"full"===h.pathMatch&&(f.hasChildren()||u.length>0)?{...Ad}:{matched:!0,consumedSegments:[],remainingSegments:u,parameters:{},positionalParamSegments:{}};const S=(h.matcher||Qf)(u,f,h);if(!S)return{...Ad};const L={};gi(S.posParams,(ie,he)=>{L[he]=ie.path});const z=S.consumed.length>0?{...L,...S.consumed[S.consumed.length-1].parameters}:L;return{matched:!0,consumedSegments:S.consumed,remainingSegments:u.slice(S.consumed.length),parameters:z,positionalParamSegments:S.posParams??{}}}function Cu(f,h,u,_){if(u.length>0&&function to(f,h,u){return u.some(_=>Ei(f,h,_)&&Is(_)!==Sn)}(f,u,_)){const L=new Wn(h,function Dl(f,h,u,_){const S={};S[Sn]=_,_._sourceSegment=f,_._segmentIndexShift=h.length;for(const L of u)if(""===L.path&&Is(L)!==Sn){const z=new Wn([],{});z._sourceSegment=f,z._segmentIndexShift=h.length,S[Is(L)]=z}return S}(f,h,_,new Wn(u,f.children)));return L._sourceSegment=f,L._segmentIndexShift=h.length,{segmentGroup:L,slicedSegments:[]}}if(0===u.length&&function Rm(f,h,u){return u.some(_=>Ei(f,h,_))}(f,u,_)){const L=new Wn(f.segments,function op(f,h,u,_,S){const L={};for(const z of _)if(Ei(f,u,z)&&!S[Is(z)]){const ie=new Wn([],{});ie._sourceSegment=f,ie._segmentIndexShift=h.length,L[Is(z)]=ie}return{...S,...L}}(f,h,u,_,f.children));return L._sourceSegment=f,L._segmentIndexShift=h.length,{segmentGroup:L,slicedSegments:u}}const S=new Wn(f.segments,f.children);return S._sourceSegment=f,S._segmentIndexShift=h.length,{segmentGroup:S,slicedSegments:u}}function Ei(f,h,u){return(!(f.hasChildren()||h.length>0)||"full"!==u.pathMatch)&&""===u.path}function Il(f,h,u,_){return!!(Is(f)===_||_!==Sn&&Ei(h,u,f))&&("**"===f.path||Dd(h,f,u).matched)}function Ga(f,h,u){return 0===h.length&&!f.children[u]}const Nt=!1;class Mi{constructor(h){this.segmentGroup=h||null}}class Wa{constructor(h){this.urlTree=h}}function Ws(f){return Rt(new Mi(f))}function Mo(f){return Rt(new Wa(f))}class Tu{constructor(h,u,_,S,L){this.injector=h,this.configLoader=u,this.urlSerializer=_,this.urlTree=S,this.config=L,this.allowRedirects=!0}apply(){const h=Cu(this.urlTree.root,[],[],this.config).segmentGroup,u=new Wn(h.segments,h.children);return this.expandSegmentGroup(this.injector,this.config,u,Sn).pipe((0,kn.U)(L=>this.createUrlTree(go(L),this.urlTree.queryParams,this.urlTree.fragment))).pipe(fs(L=>{if(L instanceof Wa)return this.allowRedirects=!1,this.match(L.urlTree);throw L instanceof Mi?this.noMatchError(L):L}))}match(h){return this.expandSegmentGroup(this.injector,this.config,h.root,Sn).pipe((0,kn.U)(S=>this.createUrlTree(go(S),h.queryParams,h.fragment))).pipe(fs(S=>{throw S instanceof Mi?this.noMatchError(S):S}))}noMatchError(h){return new R.vHH(4002,Nt)}createUrlTree(h,u,_){const S=ts(h);return new _l(S,u,_)}expandSegmentGroup(h,u,_,S){return 0===_.segments.length&&_.hasChildren()?this.expandChildren(h,u,_).pipe((0,kn.U)(L=>new Wn([],L))):this.expandSegment(h,_,u,_.segments,S,!0)}expandChildren(h,u,_){const S=[];for(const L of Object.keys(_.children))"primary"===L?S.unshift(L):S.push(L);return(0,ii.D)(S).pipe((0,Gi.b)(L=>{const z=_.children[L],ie=rs(u,L);return this.expandSegmentGroup(h,ie,z,L).pipe((0,kn.U)(he=>({segment:he,outlet:L})))}),Io((L,z)=>(L[z.outlet]=z.segment,L),{}),oi())}expandSegment(h,u,_,S,L,z){return(0,ii.D)(_).pipe((0,Gi.b)(ie=>this.expandSegmentAgainstRoute(h,u,_,ie,S,L,z).pipe(fs(Ze=>{if(Ze instanceof Mi)return(0,_t.of)(null);throw Ze}))),Pi(ie=>!!ie),fs((ie,he)=>{if(Td(ie))return Ga(u,S,L)?(0,_t.of)(new Wn([],{})):Ws(u);throw ie}))}expandSegmentAgainstRoute(h,u,_,S,L,z,ie){return Il(S,u,L,z)?void 0===S.redirectTo?this.matchSegmentAgainstRoute(h,u,S,L,z):ie&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(h,u,_,S,L,z):Ws(u):Ws(u)}expandSegmentAgainstRouteUsingRedirect(h,u,_,S,L,z){return"**"===S.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(h,_,S,z):this.expandRegularSegmentAgainstRouteUsingRedirect(h,u,_,S,L,z)}expandWildCardWithParamsAgainstRouteUsingRedirect(h,u,_,S){const L=this.applyRedirectCommands([],_.redirectTo,{});return _.redirectTo.startsWith("/")?Mo(L):this.lineralizeSegments(_,L).pipe((0,dn.z)(z=>{const ie=new Wn(z,{});return this.expandSegment(h,ie,u,z,S,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(h,u,_,S,L,z){const{matched:ie,consumedSegments:he,remainingSegments:Ze,positionalParamSegments:ht}=Dd(u,S,L);if(!ie)return Ws(u);const wn=this.applyRedirectCommands(he,S.redirectTo,ht);return S.redirectTo.startsWith("/")?Mo(wn):this.lineralizeSegments(S,wn).pipe((0,dn.z)(ji=>this.expandSegment(h,u,_,ji.concat(Ze),z,!1)))}matchSegmentAgainstRoute(h,u,_,S,L){return"**"===_.path?(h=jh(_,h),_.loadChildren?(_._loadedRoutes?(0,_t.of)({routes:_._loadedRoutes,injector:_._loadedInjector}):this.configLoader.loadChildren(h,_)).pipe((0,kn.U)(ie=>(_._loadedRoutes=ie.routes,_._loadedInjector=ie.injector,new Wn(S,{})))):(0,_t.of)(new Wn(S,{}))):qh(u,_,S,h).pipe(br(({matched:z,consumedSegments:ie,remainingSegments:he})=>z?this.getChildConfig(h=_._injector??h,_,S).pipe((0,dn.z)(ht=>{const wn=ht.injector??h,ji=ht.routes,{segmentGroup:nu,slicedSegments:Sa}=Cu(u,ie,he,ji),Kl=new Wn(nu.segments,nu.children);if(0===Sa.length&&Kl.hasChildren())return this.expandChildren(wn,ji,Kl).pipe((0,kn.U)(hh=>new Wn(ie,hh)));if(0===ji.length&&0===Sa.length)return(0,_t.of)(new Wn(ie,{}));const Hr=Is(_)===L;return this.expandSegment(wn,Kl,ji,Sa,Hr?Sn:L,!0).pipe((0,kn.U)(Jl=>new Wn(ie.concat(Jl.segments),Jl.children)))})):Ws(u)))}getChildConfig(h,u,_){return u.children?(0,_t.of)({routes:u.children,injector:h}):u.loadChildren?void 0!==u._loadedRoutes?(0,_t.of)({routes:u._loadedRoutes,injector:u._loadedInjector}):function yi(f,h,u,_){const S=h.canLoad;if(void 0===S||0===S.length)return(0,_t.of)(!0);const L=S.map(z=>{const ie=Cr(z,f);return As(function vc(f){return f&&Va(f.canLoad)}(ie)?ie.canLoad(h,u):f.runInContext(()=>ie(h,u)))});return(0,_t.of)(L).pipe(ga(),bc())}(h,u,_).pipe((0,dn.z)(S=>S?this.configLoader.loadChildren(h,u).pipe(Ji(L=>{u._loadedRoutes=L.routes,u._loadedInjector=L.injector})):function v_(f){return Rt(Fr(Nt,3))}())):(0,_t.of)({routes:[],injector:h})}lineralizeSegments(h,u){let _=[],S=u.root;for(;;){if(_=_.concat(S.segments),0===S.numberOfChildren)return(0,_t.of)(_);if(S.numberOfChildren>1||!S.children[Sn])return h.redirectTo,Rt(new R.vHH(4e3,Nt));S=S.children[Sn]}}applyRedirectCommands(h,u,_){return this.applyRedirectCreateUrlTree(u,this.urlSerializer.parse(u),h,_)}applyRedirectCreateUrlTree(h,u,_,S){const L=this.createSegmentGroup(h,u.root,_,S);return new _l(L,this.createQueryParams(u.queryParams,this.urlTree.queryParams),u.fragment)}createQueryParams(h,u){const _={};return gi(h,(S,L)=>{if("string"==typeof S&&S.startsWith(":")){const ie=S.substring(1);_[L]=u[ie]}else _[L]=S}),_}createSegmentGroup(h,u,_,S){const L=this.createSegments(h,u.segments,_,S);let z={};return gi(u.children,(ie,he)=>{z[he]=this.createSegmentGroup(h,ie,_,S)}),new Wn(L,z)}createSegments(h,u,_,S){return u.map(L=>L.path.startsWith(":")?this.findPosParam(h,L,S):this.findOrReturn(L,_))}findPosParam(h,u,_){const S=_[u.path.substring(1)];if(!S)throw new R.vHH(4001,Nt);return S}findOrReturn(h,u){let _=0;for(const S of u){if(S.path===h.path)return u.splice(_),S;_++}return h}}class Sc{}class Pm{constructor(h,u,_,S,L,z,ie){this.injector=h,this.rootComponentType=u,this.config=_,this.urlTree=S,this.url=L,this.paramsInheritanceStrategy=z,this.urlSerializer=ie}recognize(){const h=Cu(this.urlTree.root,[],[],this.config.filter(u=>void 0===u.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,h,Sn).pipe((0,kn.U)(u=>{if(null===u)return null;const _=new G([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Sn,this.rootComponentType,null,this.urlTree.root,-1,{}),S=new _s(_,u),L=new te(this.url,S);return this.inheritParamsAndData(L._root),L}))}inheritParamsAndData(h){const u=h.value,_=B(u,this.paramsInheritanceStrategy);u.params=Object.freeze(_.params),u.data=Object.freeze(_.data),h.children.forEach(S=>this.inheritParamsAndData(S))}processSegmentGroup(h,u,_,S){return 0===_.segments.length&&_.hasChildren()?this.processChildren(h,u,_):this.processSegment(h,u,_,_.segments,S)}processChildren(h,u,_){return(0,ii.D)(Object.keys(_.children)).pipe((0,Gi.b)(S=>{const L=_.children[S],z=rs(u,S);return this.processSegmentGroup(h,z,L,S)}),Io((S,L)=>S&&L?(S.push(...L),S):null),function pl(f,h=!1){return(0,Ci.e)((u,_)=>{let S=0;u.subscribe((0,Mr.x)(_,L=>{const z=f(L,S++);(z||h)&&_.next(L),!z&&_.complete()}))})}(S=>null!==S),oa(null),oi(),(0,kn.U)(S=>{if(null===S)return null;const L=Zh(S);return function x_(f){f.sort((h,u)=>h.value.outlet===Sn?-1:u.value.outlet===Sn?1:h.value.outlet.localeCompare(u.value.outlet))}(L),L}))}processSegment(h,u,_,S,L){return(0,ii.D)(u).pipe((0,Gi.b)(z=>this.processSegmentAgainstRoute(z._injector??h,z,_,S,L)),Pi(z=>!!z),fs(z=>{if(Td(z))return Ga(_,S,L)?(0,_t.of)([]):(0,_t.of)(null);throw z}))}processSegmentAgainstRoute(h,u,_,S,L){if(u.redirectTo||!Il(u,_,S,L))return(0,_t.of)(null);let z;if("**"===u.path){const ie=S.length>0?Fa(S).parameters:{},he=Jh(_)+S.length,Ze=new G(S,ie,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Id(u),Is(u),u.component??u._loadedComponent??null,u,Kh(_),he,$r(u));z=(0,_t.of)({snapshot:Ze,consumedSegments:[],remainingSegments:[]})}else z=qh(_,u,S,h).pipe((0,kn.U)(({matched:ie,consumedSegments:he,remainingSegments:Ze,parameters:ht})=>{if(!ie)return null;const wn=Jh(_)+he.length;return{snapshot:new G(he,ht,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Id(u),Is(u),u.component??u._loadedComponent??null,u,Kh(_),wn,$r(u)),consumedSegments:he,remainingSegments:Ze}}));return z.pipe(br(ie=>{if(null===ie)return(0,_t.of)(null);const{snapshot:he,consumedSegments:Ze,remainingSegments:ht}=ie;h=u._injector??h;const wn=u._loadedInjector??h,ji=function M_(f){return f.children?f.children:f.loadChildren?f._loadedRoutes:[]}(u),{segmentGroup:nu,slicedSegments:Sa}=Cu(_,Ze,ht,ji.filter(Hr=>void 0===Hr.redirectTo));if(0===Sa.length&&nu.hasChildren())return this.processChildren(wn,ji,nu).pipe((0,kn.U)(Hr=>null===Hr?null:[new _s(he,Hr)]));if(0===ji.length&&0===Sa.length)return(0,_t.of)([new _s(he,[])]);const Kl=Is(u)===L;return this.processSegment(wn,ji,nu,Sa,Kl?Sn:L).pipe((0,kn.U)(Hr=>null===Hr?null:[new _s(he,Hr)]))}))}}function b_(f){const h=f.value.routeConfig;return h&&""===h.path&&void 0===h.redirectTo}function Zh(f){const h=[],u=new Set;for(const _ of f){if(!b_(_)){h.push(_);continue}const S=h.find(L=>_.value.routeConfig===L.value.routeConfig);void 0!==S?(S.children.push(..._.children),u.add(S)):h.push(_)}for(const _ of u){const S=Zh(_.children);h.push(new _s(_.value,S))}return h.filter(_=>!u.has(_))}function Kh(f){let h=f;for(;h._sourceSegment;)h=h._sourceSegment;return h}function Jh(f){let h=f,u=h._segmentIndexShift??0;for(;h._sourceSegment;)h=h._sourceSegment,u+=h._segmentIndexShift??0;return u-1}function Id(f){return f.data||{}}function $r(f){return f.resolve||{}}function Pd(f){return"string"==typeof f.title||null===f.title}function ya(f){return br(h=>{const u=f(h);return u?(0,ii.D)(u).pipe((0,kn.U)(()=>h)):(0,_t.of)(h)})}const no=new R.OlP("ROUTES");let Bo=(()=>{class f{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,R.f3M)(R.Sil)}loadComponent(u){if(this.componentLoaders.get(u))return this.componentLoaders.get(u);if(u._loadedComponent)return(0,_t.of)(u._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(u);const _=As(u.loadComponent()).pipe((0,kn.U)(Ld),Ji(L=>{this.onLoadEndListener&&this.onLoadEndListener(u),u._loadedComponent=L}),Oa(()=>{this.componentLoaders.delete(u)})),S=new Wi(_,()=>new Un.x).pipe(hs());return this.componentLoaders.set(u,S),S}loadChildren(u,_){if(this.childrenLoaders.get(_))return this.childrenLoaders.get(_);if(_._loadedRoutes)return(0,_t.of)({routes:_._loadedRoutes,injector:_._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(_);const L=this.loadModuleFactoryOrRoutes(_.loadChildren).pipe((0,kn.U)(ie=>{this.onLoadEndListener&&this.onLoadEndListener(_);let he,Ze,ht=!1;Array.isArray(ie)?Ze=ie:(he=ie.create(u).injector,Ze=Ts(he.get(no,[],R.XFs.Self|R.XFs.Optional)));return{routes:Ze.map(Cl),injector:he}}),Oa(()=>{this.childrenLoaders.delete(_)})),z=new Wi(L,()=>new Un.x).pipe(hs());return this.childrenLoaders.set(_,z),z}loadModuleFactoryOrRoutes(u){return As(u()).pipe((0,kn.U)(Ld),(0,dn.z)(_=>_ instanceof R.YKP||Array.isArray(_)?(0,_t.of)(_):(0,ii.D)(this.compiler.compileModuleAsync(_))))}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();function Ld(f){return function Nd(f){return f&&"object"==typeof f&&"default"in f}(f)?f.default:f}let Pl=(()=>{class f{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Un.x,this.configLoader=(0,R.f3M)(Bo),this.environmentInjector=(0,R.f3M)(R.lqb),this.urlSerializer=(0,R.f3M)(pc),this.rootContexts=(0,R.f3M)(Ur),this.navigationId=0,this.afterPreactivation=()=>(0,_t.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=S=>this.events.next(new Wh(S)),this.configLoader.onLoadStartListener=S=>this.events.next(new xd(S))}complete(){this.transitions?.complete()}handleNavigationRequest(u){const _=++this.navigationId;this.transitions?.next({...this.transitions.value,...u,id:_})}setupNavigations(u){return this.transitions=new ri({id:0,targetPageId:0,currentUrlTree:u.currentUrlTree,currentRawUrl:u.currentUrlTree,extractedUrl:u.urlHandlingStrategy.extract(u.currentUrlTree),urlAfterRedirects:u.urlHandlingStrategy.extract(u.currentUrlTree),rawUrl:u.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ba,restoredState:null,currentSnapshot:u.routerState.snapshot,targetSnapshot:null,currentRouterState:u.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,es.h)(_=>0!==_.id),(0,kn.U)(_=>({..._,extractedUrl:u.urlHandlingStrategy.extract(_.rawUrl)})),br(_=>{let S=!1,L=!1;return(0,_t.of)(_).pipe(Ji(z=>{this.currentNavigation={id:z.id,initialUrl:z.rawUrl,extractedUrl:z.extractedUrl,trigger:z.source,extras:z.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),br(z=>{const ie=u.browserUrlTree.toString(),he=!u.navigated||z.extractedUrl.toString()!==ie||ie!==u.currentUrlTree.toString();if(!he&&"reload"!==(z.extras.onSameUrlNavigation??u.onSameUrlNavigation)){const ht="";return this.events.next(new fr(z.id,u.serializeUrl(_.rawUrl),ht,0)),u.rawUrlTree=z.rawUrl,z.resolve(null),mn.E}if(u.urlHandlingStrategy.shouldProcessUrl(z.rawUrl))return ap(z.source)&&(u.browserUrlTree=z.extractedUrl),(0,_t.of)(z).pipe(br(ht=>{const wn=this.transitions?.getValue();return this.events.next(new _c(ht.id,this.urlSerializer.serialize(ht.extractedUrl),ht.source,ht.restoredState)),wn!==this.transitions?.getValue()?mn.E:Promise.resolve(ht)}),function Kv(f,h,u,_){return br(S=>function js(f,h,u,_,S){return new Tu(f,h,u,_,S).apply()}(f,h,u,S.extractedUrl,_).pipe((0,kn.U)(L=>({...S,urlAfterRedirects:L}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,u.config),Ji(ht=>{this.currentNavigation={...this.currentNavigation,finalUrl:ht.urlAfterRedirects},_.urlAfterRedirects=ht.urlAfterRedirects}),function Rd(f,h,u,_,S){return(0,dn.z)(L=>function Tr(f,h,u,_,S,L,z="emptyOnly"){return new Pm(f,h,u,_,S,z,L).recognize().pipe(br(ie=>null===ie?function Ec(f){return new on.y(h=>h.error(f))}(new Sc):(0,_t.of)(ie)))}(f,h,u,L.urlAfterRedirects,_.serialize(L.urlAfterRedirects),_,S).pipe((0,kn.U)(z=>({...L,targetSnapshot:z}))))}(this.environmentInjector,this.rootComponentType,u.config,this.urlSerializer,u.paramsInheritanceStrategy),Ji(ht=>{if(_.targetSnapshot=ht.targetSnapshot,"eager"===u.urlUpdateStrategy){if(!ht.extras.skipLocationChange){const ji=u.urlHandlingStrategy.merge(ht.urlAfterRedirects,ht.rawUrl);u.setBrowserUrl(ji,ht)}u.browserUrlTree=ht.urlAfterRedirects}const wn=new wr(ht.id,this.urlSerializer.serialize(ht.extractedUrl),this.urlSerializer.serialize(ht.urlAfterRedirects),ht.targetSnapshot);this.events.next(wn)}));if(he&&u.urlHandlingStrategy.shouldProcessUrl(u.rawUrlTree)){const{id:ht,extractedUrl:wn,source:ji,restoredState:nu,extras:Sa}=z,Kl=new _c(ht,this.urlSerializer.serialize(wn),ji,nu);this.events.next(Kl);const Hr=_i(wn,this.rootComponentType).snapshot;return _={...z,targetSnapshot:Hr,urlAfterRedirects:wn,extras:{...Sa,skipLocationChange:!1,replaceUrl:!1}},(0,_t.of)(_)}{const ht="";return this.events.next(new fr(z.id,u.serializeUrl(_.extractedUrl),ht,1)),u.rawUrlTree=z.rawUrl,z.resolve(null),mn.E}}),Ji(z=>{const ie=new K(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot);this.events.next(ie)}),(0,kn.U)(z=>_={...z,guards:No(z.targetSnapshot,z.currentSnapshot,this.rootContexts)}),function Mc(f,h){return(0,dn.z)(u=>{const{targetSnapshot:_,currentSnapshot:S,guards:{canActivateChecks:L,canDeactivateChecks:z}}=u;return 0===z.length&&0===L.length?(0,_t.of)({...u,guardsResult:!0}):function xo(f,h,u,_){return(0,ii.D)(f).pipe((0,dn.z)(S=>function _a(f,h,u,_,S){const L=h&&h.routeConfig?h.routeConfig.canDeactivate:null;if(!L||0===L.length)return(0,_t.of)(!0);const z=L.map(ie=>{const he=yn(h)??S,Ze=Cr(ie,he);return As(function Fo(f){return f&&Va(f.canDeactivate)}(Ze)?Ze.canDeactivate(f,h,u,_):he.runInContext(()=>Ze(f,h,u,_))).pipe(Pi())});return(0,_t.of)(z).pipe(ga())}(S.component,S.route,u,h,_)),Pi(S=>!0!==S,!0))}(z,_,S,f).pipe((0,dn.z)(ie=>ie&&function Ha(f){return"boolean"==typeof f}(ie)?function za(f,h,u,_){return(0,ii.D)(h).pipe((0,Gi.b)(S=>hr(function Gs(f,h){return null!==f&&h&&h(new Md(f)),(0,_t.of)(!0)}(S.route.parent,_),function Br(f,h){return null!==f&&h&&h(new Ml(f)),(0,_t.of)(!0)}(S.route,_),function sp(f,h,u){const _=h[h.length-1],L=h.slice(0,h.length-1).reverse().map(z=>function wd(f){const h=f.routeConfig?f.routeConfig.canActivateChild:null;return h&&0!==h.length?{node:f,guards:h}:null}(z)).filter(z=>null!==z).map(z=>hl(()=>{const ie=z.guards.map(he=>{const Ze=yn(z.node)??u,ht=Cr(he,Ze);return As(function wu(f){return f&&Va(f.canActivateChild)}(ht)?ht.canActivateChild(_,f):Ze.runInContext(()=>ht(_,f))).pipe(Pi())});return(0,_t.of)(ie).pipe(ga())}));return(0,_t.of)(L).pipe(ga())}(f,S.path,u),function Rs(f,h,u){const _=h.routeConfig?h.routeConfig.canActivate:null;if(!_||0===_.length)return(0,_t.of)(!0);const S=_.map(L=>hl(()=>{const z=yn(h)??u,ie=Cr(L,z);return As(function Oo(f){return f&&Va(f.canActivate)}(ie)?ie.canActivate(h,f):z.runInContext(()=>ie(h,f))).pipe(Pi())}));return(0,_t.of)(S).pipe(ga())}(f,S.route,u))),Pi(S=>!0!==S,!0))}(_,L,f,h):(0,_t.of)(ie)),(0,kn.U)(ie=>({...u,guardsResult:ie})))})}(this.environmentInjector,z=>this.events.next(z)),Ji(z=>{if(_.guardsResult=z.guardsResult,sr(z.guardsResult))throw ki(0,z.guardsResult);const ie=new eo(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot,!!z.guardsResult);this.events.next(ie)}),(0,es.h)(z=>!!z.guardsResult||(u.restoreHistory(z),this.cancelNavigationTransition(z,"",3),!1)),ya(z=>{if(z.guards.canActivateChecks.length)return(0,_t.of)(z).pipe(Ji(ie=>{const he=new Gh(ie.id,this.urlSerializer.serialize(ie.extractedUrl),this.urlSerializer.serialize(ie.urlAfterRedirects),ie.targetSnapshot);this.events.next(he)}),br(ie=>{let he=!1;return(0,_t.of)(ie).pipe(function Uo(f,h){return(0,dn.z)(u=>{const{targetSnapshot:_,guards:{canActivateChecks:S}}=u;if(!S.length)return(0,_t.of)(u);let L=0;return(0,ii.D)(S).pipe((0,Gi.b)(z=>function Xs(f,h,u,_){const S=f.routeConfig,L=f._resolve;return void 0!==S?.title&&!Pd(S)&&(L[la]=S.title),function wc(f,h,u,_){const S=function Qi(f){return[...Object.keys(f),...Object.getOwnPropertySymbols(f)]}(f);if(0===S.length)return(0,_t.of)({});const L={};return(0,ii.D)(S).pipe((0,dn.z)(z=>function An(f,h,u,_){const S=yn(h)??_,L=Cr(f,S);return As(L.resolve?L.resolve(h,u):S.runInContext(()=>L(h,u)))}(f[z],h,u,_).pipe(Pi(),Ji(ie=>{L[z]=ie}))),Na(1),function La(f){return(0,kn.U)(()=>f)}(L),fs(z=>Td(z)?mn.E:Rt(z)))}(L,f,h,_).pipe((0,kn.U)(z=>(f._resolvedData=z,f.data=B(f,u).resolve,S&&Pd(S)&&(f.data[la]=S.title),null)))}(z.route,_,f,h)),Ji(()=>L++),Na(1),(0,dn.z)(z=>L===S.length?(0,_t.of)(u):mn.E))})}(u.paramsInheritanceStrategy,this.environmentInjector),Ji({next:()=>he=!0,complete:()=>{he||(u.restoreHistory(ie),this.cancelNavigationTransition(ie,"",2))}}))}),Ji(ie=>{const he=new Rn(ie.id,this.urlSerializer.serialize(ie.extractedUrl),this.urlSerializer.serialize(ie.urlAfterRedirects),ie.targetSnapshot);this.events.next(he)}))}),ya(z=>{const ie=he=>{const Ze=[];he.routeConfig?.loadComponent&&!he.routeConfig._loadedComponent&&Ze.push(this.configLoader.loadComponent(he.routeConfig).pipe(Ji(ht=>{he.component=ht}),(0,kn.U)(()=>{})));for(const ht of he.children)Ze.push(...ie(ht));return Ze};return dl(ie(z.targetSnapshot.root)).pipe(oa(),xi(1))}),ya(()=>this.afterPreactivation()),(0,kn.U)(z=>{const ie=function Si(f,h,u){const _=gn(f,h._root,u?u._root:void 0);return new fa(_,h)}(u.routeReuseStrategy,z.targetSnapshot,z.currentRouterState);return _={...z,targetRouterState:ie}}),Ji(z=>{u.currentUrlTree=z.urlAfterRedirects,u.rawUrlTree=u.urlHandlingStrategy.merge(z.urlAfterRedirects,z.rawUrl),u.routerState=z.targetRouterState,"deferred"===u.urlUpdateStrategy&&(z.extras.skipLocationChange||u.setBrowserUrl(u.rawUrlTree,z),u.browserUrlTree=z.urlAfterRedirects)}),((f,h,u)=>(0,kn.U)(_=>(new zs(h,_.targetRouterState,_.currentRouterState,u).activate(f),_)))(this.rootContexts,u.routeReuseStrategy,z=>this.events.next(z)),xi(1),Ji({next:z=>{S=!0,this.lastSuccessfulNavigation=this.currentNavigation,u.navigated=!0,this.events.next(new $i(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(u.currentUrlTree))),u.titleStrategy?.updateTitle(z.targetRouterState.snapshot),z.resolve(!0)},complete:()=>{S=!0}}),Oa(()=>{S||L||this.cancelNavigationTransition(_,"",1),this.currentNavigation?.id===_.id&&(this.currentNavigation=null)}),fs(z=>{if(L=!0,is(z)){ns(z)||(u.navigated=!0,u.restoreHistory(_,!0));const ie=new Tn(_.id,this.urlSerializer.serialize(_.extractedUrl),z.message,z.cancellationCode);if(this.events.next(ie),ns(z)){const he=u.urlHandlingStrategy.merge(z.url,u.rawUrlTree),Ze={skipLocationChange:_.extras.skipLocationChange,replaceUrl:"eager"===u.urlUpdateStrategy||ap(_.source)};u.scheduleNavigation(he,Ba,null,Ze,{resolve:_.resolve,reject:_.reject,promise:_.promise})}else _.resolve(!1)}else{u.restoreHistory(_,!0);const ie=new Ce(_.id,this.urlSerializer.serialize(_.extractedUrl),z,_.targetSnapshot??void 0);this.events.next(ie);try{_.resolve(u.errorHandler(z))}catch(he){_.reject(he)}}return mn.E}))}))}cancelNavigationTransition(u,_,S){const L=new Tn(u.id,this.urlSerializer.serialize(u.extractedUrl),_,S);this.events.next(L),u.resolve(!1)}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();function ap(f){return f!==Ba}let Du=(()=>{class f{buildTitle(u){let _,S=u.root;for(;void 0!==S;)_=this.getResolvedTitleForRoute(S)??_,S=S.children.find(L=>L.outlet===Sn);return _}getResolvedTitleForRoute(u){return u.data[la]}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:function(){return(0,R.f3M)(kr)},providedIn:"root"}),f})(),kr=(()=>{class f extends Du{constructor(u){super(),this.title=u}updateTitle(u){const _=this.buildTitle(u);void 0!==_&&this.title.setTitle(_)}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(Oi))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})(),Nm=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:function(){return(0,R.f3M)(Ll)},providedIn:"root"}),f})();class Nl{shouldDetach(h){return!1}store(h,u){}shouldAttach(h){return!1}retrieve(h){return null}shouldReuseRoute(h,u){return h.routeConfig===u.routeConfig}}let Ll=(()=>{class f extends Nl{}return f.\u0275fac=function(){let h;return function(_){return(h||(h=R.n5z(f)))(_||f)}}(),f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();const Ar=new R.OlP("",{providedIn:"root",factory:()=>({})});let E_=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:function(){return(0,R.f3M)(Qh)},providedIn:"root"}),f})(),Qh=(()=>{class f{shouldProcessUrl(u){return!0}extract(u){return u}merge(u,_){return u}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();function Lm(f){throw f}function Om(f,h,u){return h.parse("/")}const io={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lp={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Dr=(()=>{class f{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,R.f3M)(R.c2e),this.isNgZoneEnabled=!1,this.options=(0,R.f3M)(Ar,{optional:!0})||{},this.errorHandler=this.options.errorHandler||Lm,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Om,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,R.f3M)(E_),this.routeReuseStrategy=(0,R.f3M)(Nm),this.urlCreationStrategy=(0,R.f3M)($h),this.titleStrategy=(0,R.f3M)(Du),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ts((0,R.f3M)(no,{optional:!0})??[]),this.navigationTransitions=(0,R.f3M)(Pl),this.urlSerializer=(0,R.f3M)(pc),this.location=(0,R.f3M)(U.Ye),this.isNgZoneEnabled=(0,R.f3M)(R.R0b)instanceof R.R0b&&R.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new _l,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=_i(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(u=>{this.lastSuccessfulId=u.id,this.currentPageId=this.browserPageId??0},u=>{this.console.warn(`Unhandled Navigation Error: ${u}`)})}resetRootComponentType(u){this.routerState.root.component=u,this.navigationTransitions.rootComponentType=u}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const u=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ba,u)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(u=>{const _="popstate"===u.type?"popstate":"hashchange";"popstate"===_&&setTimeout(()=>{this.navigateToSyncWithBrowser(u.url,_,u.state)},0)}))}navigateToSyncWithBrowser(u,_,S){const L={replaceUrl:!0},z=S?.navigationId?S:null;if(S){const he={...S};delete he.navigationId,delete he.\u0275routerPageId,0!==Object.keys(he).length&&(L.state=he)}const ie=this.parseUrl(u);this.scheduleNavigation(ie,_,z,L)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(u){this.config=u.map(Cl),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(u,_={}){const{relativeTo:S,queryParams:L,fragment:z,queryParamsHandling:ie,preserveFragment:he}=_,Ze=he?this.currentUrlTree.fragment:z;let ht=null;switch(ie){case"merge":ht={...this.currentUrlTree.queryParams,...L};break;case"preserve":ht=this.currentUrlTree.queryParams;break;default:ht=L||null}return null!==ht&&(ht=this.removeEmptyProps(ht)),this.urlCreationStrategy.createUrlTree(S,this.routerState,this.currentUrlTree,u,ht,Ze??null)}navigateByUrl(u,_={skipLocationChange:!1}){const S=sr(u)?u:this.parseUrl(u),L=this.urlHandlingStrategy.merge(S,this.rawUrlTree);return this.scheduleNavigation(L,Ba,null,_)}navigate(u,_={skipLocationChange:!1}){return function Fd(f){for(let h=0;h<f.length;h++){const u=f[h];if(null==u)throw new R.vHH(4008,false)}}(u),this.navigateByUrl(this.createUrlTree(u,_),_)}serializeUrl(u){return this.urlSerializer.serialize(u)}parseUrl(u){let _;try{_=this.urlSerializer.parse(u)}catch(S){_=this.malformedUriErrorHandler(S,this.urlSerializer,u)}return _}isActive(u,_){let S;if(S=!0===_?{...io}:!1===_?{...lp}:_,sr(u))return gl(this.currentUrlTree,u,S);const L=this.parseUrl(u);return gl(this.currentUrlTree,L,S)}removeEmptyProps(u){return Object.keys(u).reduce((_,S)=>{const L=u[S];return null!=L&&(_[S]=L),_},{})}scheduleNavigation(u,_,S,L,z){if(this.disposed)return Promise.resolve(!1);let ie,he,Ze,ht;return z?(ie=z.resolve,he=z.reject,Ze=z.promise):Ze=new Promise((wn,ji)=>{ie=wn,he=ji}),ht="computed"===this.canceledNavigationResolution?S&&S.\u0275routerPageId?S.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:ht,source:_,restoredState:S,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:u,extras:L,resolve:ie,reject:he,promise:Ze,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ze.catch(wn=>Promise.reject(wn))}setBrowserUrl(u,_){const S=this.urlSerializer.serialize(u);if(this.location.isCurrentPathEqualTo(S)||_.extras.replaceUrl){const z={..._.extras.state,...this.generateNgRouterState(_.id,this.browserPageId)};this.location.replaceState(S,"",z)}else{const L={..._.extras.state,...this.generateNgRouterState(_.id,_.targetPageId)};this.location.go(S,"",L)}}restoreHistory(u,_=!1){if("computed"===this.canceledNavigationResolution){const L=this.currentPageId-(this.browserPageId??this.currentPageId);0!==L?this.location.historyGo(L):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===L&&(this.resetState(u),this.browserUrlTree=u.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(_&&this.resetState(u),this.resetUrlToCurrentUrlTree())}resetState(u){this.routerState=u.currentRouterState,this.currentUrlTree=u.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,u.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(u,_){return"computed"===this.canceledNavigationResolution?{navigationId:u,\u0275routerPageId:_}:{navigationId:u}}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();class Tc{}let cp=(()=>{class f{constructor(u,_,S,L,z){this.router=u,this.injector=S,this.preloadingStrategy=L,this.loader=z}setUpPreloading(){this.subscription=this.router.events.pipe((0,es.h)(u=>u instanceof $i),(0,Gi.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(u,_){const S=[];for(const L of _){L.providers&&!L._injector&&(L._injector=(0,R.MMx)(L.providers,u,`Route: ${L.path}`));const z=L._injector??u,ie=L._loadedInjector??z;(L.loadChildren&&!L._loadedRoutes&&void 0===L.canLoad||L.loadComponent&&!L._loadedComponent)&&S.push(this.preloadConfig(z,L)),(L.children||L._loadedRoutes)&&S.push(this.processRoutes(ie,L.children??L._loadedRoutes))}return(0,ii.D)(S).pipe((0,Ki.J)())}preloadConfig(u,_){return this.preloadingStrategy.preload(_,()=>{let S;S=_.loadChildren&&void 0===_.canLoad?this.loader.loadChildren(u,_):(0,_t.of)(null);const L=S.pipe((0,dn.z)(z=>null===z?(0,_t.of)(void 0):(_._loadedRoutes=z.routes,_._loadedInjector=z.injector,this.processRoutes(z.injector??u,z.routes))));if(_.loadComponent&&!_._loadedComponent){const z=this.loader.loadComponent(_);return(0,ii.D)([L,z]).pipe((0,Ki.J)())}return L})}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(Dr),R.LFG(R.Sil),R.LFG(R.lqb),R.LFG(Tc),R.LFG(Bo))},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();const ko=new R.OlP("");let nf=(()=>{class f{constructor(u,_,S,L,z={}){this.urlSerializer=u,this.transitions=_,this.viewportScroller=S,this.zone=L,this.options=z,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},z.scrollPositionRestoration=z.scrollPositionRestoration||"disabled",z.anchorScrolling=z.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(u=>{u instanceof _c?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=u.navigationTrigger,this.restoredId=u.restoredState?u.restoredState.navigationId:0):u instanceof $i&&(this.lastId=u.id,this.scheduleScrollEvent(u,this.urlSerializer.parse(u.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(u=>{u instanceof yu&&(u.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(u.position):u.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(u.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(u,_){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new yu(u,"popstate"===this.lastSource?this.store[this.restoredId]:null,_))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return f.\u0275fac=function(u){R.$Z()},f.\u0275prov=R.Yz7({token:f,factory:f.\u0275fac}),f})();var os=(()=>((os=os||{})[os.COMPLETE=0]="COMPLETE",os[os.FAILED=1]="FAILED",os[os.REDIRECTING=2]="REDIRECTING",os))();const jr=!1;function er(f,h){return{\u0275kind:f,\u0275providers:h}}const xs=new R.OlP("",{providedIn:"root",factory:()=>!1});function Ol(){const f=(0,R.f3M)(R.zs3);return h=>{const u=f.get(R.z2F);if(h!==u.components[0])return;const _=f.get(Dr),S=f.get($a);1===f.get(ja)&&_.initialNavigation(),f.get(Fl,null,R.XFs.Optional)?.setUpPreloading(),f.get(ko,null,R.XFs.Optional)?.init(),_.resetRootComponentType(u.componentTypes[0]),S.closed||(S.next(),S.complete(),S.unsubscribe())}}const $a=new R.OlP(jr?"bootstrap done indicator":"",{factory:()=>new Un.x}),ja=new R.OlP(jr?"initial navigation":"",{providedIn:"root",factory:()=>1});function Ac(){let f=[];return f=jr?[{provide:R.Xts,multi:!0,useFactory:()=>{const h=(0,R.f3M)(Dr);return()=>h.events.subscribe(u=>{console.group?.(`Router Event: ${u.constructor.name}`),console.log(function bl(f){if(!("type"in f))return`Unknown Router Event: ${f.constructor.name}`;switch(f.type){case 14:return`ActivationEnd(path: '${f.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${f.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${f.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${f.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${f.id}, url: '${f.url}', urlAfterRedirects: '${f.urlAfterRedirects}', state: ${f.state}, shouldActivate: ${f.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${f.id}, url: '${f.url}', urlAfterRedirects: '${f.urlAfterRedirects}', state: ${f.state})`;case 2:return`NavigationCancel(id: ${f.id}, url: '${f.url}')`;case 16:return`NavigationSkipped(id: ${f.id}, url: '${f.url}')`;case 1:return`NavigationEnd(id: ${f.id}, url: '${f.url}', urlAfterRedirects: '${f.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${f.id}, url: '${f.url}', error: ${f.error})`;case 0:return`NavigationStart(id: ${f.id}, url: '${f.url}')`;case 6:return`ResolveEnd(id: ${f.id}, url: '${f.url}', urlAfterRedirects: '${f.urlAfterRedirects}', state: ${f.state})`;case 5:return`ResolveStart(id: ${f.id}, url: '${f.url}', urlAfterRedirects: '${f.urlAfterRedirects}', state: ${f.state})`;case 10:return`RouteConfigLoadEnd(path: ${f.route.path})`;case 9:return`RouteConfigLoadStart(path: ${f.route.path})`;case 4:return`RoutesRecognized(id: ${f.id}, url: '${f.url}', urlAfterRedirects: '${f.urlAfterRedirects}', state: ${f.state})`;case 15:return`Scroll(anchor: '${f.anchor}', position: '${f.position?`${f.position[0]}, ${f.position[1]}`:null}')`}}(u)),console.log(u),console.groupEnd?.()})}}]:[],er(1,f)}const Fl=new R.OlP(jr?"router preloader":"");function Dc(f){return er(0,[{provide:Fl,useExisting:cp},{provide:Tc,useExisting:f}])}const Rc=!1,Pc=new R.OlP(Rc?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),dp=[U.Ye,{provide:pc,useClass:fu},Dr,Ur,{provide:T,useFactory:function Ud(f){return f.routerState.root},deps:[Dr]},Bo,Rc?{provide:xs,useValue:!0}:[]];function hp(){return new R.PXZ("Router",Dr)}let sf=(()=>{class f{constructor(u){}static forRoot(u,_){return{ngModule:f,providers:[dp,Rc&&_?.enableTracing?Ac().\u0275providers:[],{provide:no,multi:!0,useValue:u},{provide:Pc,useFactory:Vd,deps:[[Dr,new R.FiY,new R.tp0]]},{provide:Ar,useValue:_||{}},_?.useHash?{provide:U.S$,useClass:U.Do}:{provide:U.S$,useClass:U.b0},{provide:ko,useFactory:()=>{const f=(0,R.f3M)(U.EM),h=(0,R.f3M)(R.R0b),u=(0,R.f3M)(Ar),_=(0,R.f3M)(Pl),S=(0,R.f3M)(pc);return u.scrollOffset&&f.setOffset(u.scrollOffset),new nf(S,_,f,h,u)}},_?.preloadingStrategy?Dc(_.preloadingStrategy).\u0275providers:[],{provide:R.PXZ,multi:!0,useFactory:hp},_?.initialNavigation?Nc(_):[],[{provide:Hd,useFactory:Ol},{provide:R.tb,multi:!0,useExisting:Hd}]]}}static forChild(u){return{ngModule:f,providers:[{provide:no,multi:!0,useValue:u}]}}}return f.\u0275fac=function(u){return new(u||f)(R.LFG(Pc,8))},f.\u0275mod=R.oAB({type:f}),f.\u0275inj=R.cJS({imports:[pa]}),f})();function Vd(f){if(Rc&&f)throw new R.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Nc(f){return["disabled"===f.initialNavigation?er(3,[{provide:R.ip1,multi:!0,useFactory:()=>{const h=(0,R.f3M)(Dr);return()=>{h.setUpLocationChangeListener()}}},{provide:ja,useValue:2}]).\u0275providers:[],"enabledBlocking"===f.initialNavigation?er(2,[{provide:ja,useValue:0},{provide:R.ip1,multi:!0,deps:[R.zs3],useFactory:h=>{const u=h.get(U.V_,Promise.resolve());return()=>u.then(()=>new Promise(_=>{const S=h.get(Dr),L=h.get($a);(function Ru(f,h){f.events.pipe((0,es.h)(u=>u instanceof $i||u instanceof Tn||u instanceof Ce||u instanceof fr),(0,kn.U)(u=>u instanceof $i||u instanceof fr?os.COMPLETE:u instanceof Tn&&(0===u.code||1===u.code)?os.REDIRECTING:os.FAILED),(0,es.h)(u=>u!==os.REDIRECTING),xi(1)).subscribe(()=>{h()})})(S,()=>{_(!0)}),h.get(Pl).afterPreactivation=()=>(_(!0),L.closed?(0,_t.of)(void 0):L),S.initialNavigation()}))}}]).\u0275providers:[]]}const Hd=new R.OlP(Rc?"Router Initializer":""),Bm=[{path:"",loadComponent:()=>ae.e(120).then(ae.bind(ae,120)).then(f=>f.CalculatorComponent)},{path:"**",redirectTo:""}];let zd=(()=>{const h=class{};let f=h;return h.\u0275fac=function(S){return new(S||h)},h.\u0275mod=R.oAB({type:h}),h.\u0275inj=R.cJS({imports:[sf.forRoot(Bm),sf]}),f})(),bo=(()=>{const h=class{constructor(){this.title="calculator-AI-jb7"}};let f=h;return h.\u0275fac=function(S){return new(S||h)},h.\u0275cmp=R.Xpm({type:h,selectors:[["app-root"]],decls:1,vars:0,template:function(S,L){1&S&&R._UZ(0,"router-outlet")},dependencies:[vs]}),f})();const jl=new R.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>$c}),$c="always";let bf=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275mod=R.oAB({type:f}),f.\u0275inj=R.cJS({}),f})();const Ju=new R.OlP("NgModelWithFormControlWarning");let R_=(()=>{class f{}return f.\u0275fac=function(u){return new(u||f)},f.\u0275mod=R.oAB({type:f}),f.\u0275inj=R.cJS({imports:[bf]}),f})(),ch=(()=>{class f{static withConfig(u){return{ngModule:f,providers:[{provide:Ju,useValue:u.warnOnNgModelWithFormControl??"always"},{provide:jl,useValue:u.callSetDisabledState??$c}]}}}return f.\u0275fac=function(u){return new(u||f)},f.\u0275mod=R.oAB({type:f}),f.\u0275inj=R.cJS({imports:[R_]}),f})();var lg=ae(62),uh=ae(383),tu=ae(7);let rd=(()=>{const h=class{};let f=h;return h.\u0275fac=function(S){return new(S||h)},h.\u0275mod=R.oAB({type:h}),h.\u0275inj=R.cJS({imports:[U.ez,ch,lg.W,uh.u,tu.J]}),f})(),dh=(()=>{const h=class{};let f=h;return h.\u0275fac=function(S){return new(S||h)},h.\u0275mod=R.oAB({type:h,bootstrap:[bo]}),h.\u0275inj=R.cJS({imports:[uc,zd,rd,ws.JF]}),f})();vr().bootstrapModule(dh).catch(f=>console.error(f))},751:(Fn,mt,ae)=>{ae.d(mt,{y:()=>Jt});var U=ae(961),R=ae(727),st=ae(822),at=ae(635),qe=ae(416),Ft=ae(576),vt=ae(806);let Jt=(()=>{class pt{constructor(nt){nt&&(this._subscribe=nt)}lift(nt){const Qt=new pt;return Qt.source=this,Qt.operator=nt,Qt}subscribe(nt,Qt,Xt){const Nn=function Le(pt){return pt&&pt instanceof U.Lv||function Ve(pt){return pt&&(0,Ft.m)(pt.next)&&(0,Ft.m)(pt.error)&&(0,Ft.m)(pt.complete)}(pt)&&(0,R.Nn)(pt)}(nt)?nt:new U.Hp(nt,Qt,Xt);return(0,vt.x)(()=>{const{operator:Pn,source:Di}=this;Nn.add(Pn?Pn.call(Nn,Di):Di?this._subscribe(Nn):this._trySubscribe(Nn))}),Nn}_trySubscribe(nt){try{return this._subscribe(nt)}catch(Qt){nt.error(Qt)}}forEach(nt,Qt){return new(Qt=It(Qt))((Xt,Nn)=>{const Pn=new U.Hp({next:Di=>{try{nt(Di)}catch(kt){Nn(kt),Pn.unsubscribe()}},error:Nn,complete:Xt});this.subscribe(Pn)})}_subscribe(nt){var Qt;return null===(Qt=this.source)||void 0===Qt?void 0:Qt.subscribe(nt)}[st.L](){return this}pipe(...nt){return(0,at.U)(nt)(this)}toPromise(nt){return new(nt=It(nt))((Qt,Xt)=>{let Nn;this.subscribe(Pn=>Nn=Pn,Pn=>Xt(Pn),()=>Qt(Nn))})}}return pt.create=fn=>new pt(fn),pt})();function It(pt){var fn;return null!==(fn=pt??qe.v.Promise)&&void 0!==fn?fn:Promise}},579:(Fn,mt,ae)=>{ae.d(mt,{x:()=>vt});var U=ae(751),R=ae(727);const at=(0,ae(888).d)(It=>function(){It(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var qe=ae(737),Ft=ae(806);let vt=(()=>{class It extends U.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Le){const pt=new Jt(this,this);return pt.operator=Le,pt}_throwIfClosed(){if(this.closed)throw new at}next(Le){(0,Ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const pt of this.currentObservers)pt.next(Le)}})}error(Le){(0,Ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Le;const{observers:pt}=this;for(;pt.length;)pt.shift().error(Le)}})}complete(){(0,Ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Le}=this;for(;Le.length;)Le.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Le;return(null===(Le=this.observers)||void 0===Le?void 0:Le.length)>0}_trySubscribe(Le){return this._throwIfClosed(),super._trySubscribe(Le)}_subscribe(Le){return this._throwIfClosed(),this._checkFinalizedStatuses(Le),this._innerSubscribe(Le)}_innerSubscribe(Le){const{hasError:pt,isStopped:fn,observers:nt}=this;return pt||fn?R.Lc:(this.currentObservers=null,nt.push(Le),new R.w0(()=>{this.currentObservers=null,(0,qe.P)(nt,Le)}))}_checkFinalizedStatuses(Le){const{hasError:pt,thrownError:fn,isStopped:nt}=this;pt?Le.error(fn):nt&&Le.complete()}asObservable(){const Le=new U.y;return Le.source=this,Le}}return It.create=(Ve,Le)=>new Jt(Ve,Le),It})();class Jt extends vt{constructor(Ve,Le){super(),this.destination=Ve,this.source=Le}next(Ve){var Le,pt;null===(pt=null===(Le=this.destination)||void 0===Le?void 0:Le.next)||void 0===pt||pt.call(Le,Ve)}error(Ve){var Le,pt;null===(pt=null===(Le=this.destination)||void 0===Le?void 0:Le.error)||void 0===pt||pt.call(Le,Ve)}complete(){var Ve,Le;null===(Le=null===(Ve=this.destination)||void 0===Ve?void 0:Ve.complete)||void 0===Le||Le.call(Ve)}_subscribe(Ve){var Le,pt;return null!==(pt=null===(Le=this.source)||void 0===Le?void 0:Le.subscribe(Ve))&&void 0!==pt?pt:R.Lc}}},961:(Fn,mt,ae)=>{ae.d(mt,{Hp:()=>Xt,Lv:()=>pt});var U=ae(576),R=ae(727),st=ae(416),at=ae(849);function qe(){}const Ft=It("C",void 0,void 0);function It(wt,dt,pn){return{kind:wt,value:dt,error:pn}}var Ve=ae(410),Le=ae(806);class pt extends R.w0{constructor(dt){super(),this.isStopped=!1,dt?(this.destination=dt,(0,R.Nn)(dt)&&dt.add(this)):this.destination=kt}static create(dt,pn,ti){return new Xt(dt,pn,ti)}next(dt){this.isStopped?Di(function Jt(wt){return It("N",wt,void 0)}(dt),this):this._next(dt)}error(dt){this.isStopped?Di(function vt(wt){return It("E",void 0,wt)}(dt),this):(this.isStopped=!0,this._error(dt))}complete(){this.isStopped?Di(Ft,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(dt){this.destination.next(dt)}_error(dt){try{this.destination.error(dt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const fn=Function.prototype.bind;function nt(wt,dt){return fn.call(wt,dt)}class Qt{constructor(dt){this.partialObserver=dt}next(dt){const{partialObserver:pn}=this;if(pn.next)try{pn.next(dt)}catch(ti){Nn(ti)}}error(dt){const{partialObserver:pn}=this;if(pn.error)try{pn.error(dt)}catch(ti){Nn(ti)}else Nn(dt)}complete(){const{partialObserver:dt}=this;if(dt.complete)try{dt.complete()}catch(pn){Nn(pn)}}}class Xt extends pt{constructor(dt,pn,ti){let He;if(super(),(0,U.m)(dt)||!dt)He={next:dt??void 0,error:pn??void 0,complete:ti??void 0};else{let St;this&&st.v.useDeprecatedNextContext?(St=Object.create(dt),St.unsubscribe=()=>this.unsubscribe(),He={next:dt.next&&nt(dt.next,St),error:dt.error&&nt(dt.error,St),complete:dt.complete&&nt(dt.complete,St)}):He=dt}this.destination=new Qt(He)}}function Nn(wt){st.v.useDeprecatedSynchronousErrorHandling?(0,Le.O)(wt):(0,at.h)(wt)}function Di(wt,dt){const{onStoppedNotification:pn}=st.v;pn&&Ve.z.setTimeout(()=>pn(wt,dt))}const kt={closed:!0,next:qe,error:function Pn(wt){throw wt},complete:qe}},727:(Fn,mt,ae)=>{ae.d(mt,{Lc:()=>Ft,w0:()=>qe,Nn:()=>vt});var U=ae(576);const st=(0,ae(888).d)(It=>function(Le){It(this),this.message=Le?`${Le.length} errors occurred during unsubscription:\n${Le.map((pt,fn)=>`${fn+1}) ${pt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Le});var at=ae(737);class qe{constructor(Ve){this.initialTeardown=Ve,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ve;if(!this.closed){this.closed=!0;const{_parentage:Le}=this;if(Le)if(this._parentage=null,Array.isArray(Le))for(const nt of Le)nt.remove(this);else Le.remove(this);const{initialTeardown:pt}=this;if((0,U.m)(pt))try{pt()}catch(nt){Ve=nt instanceof st?nt.errors:[nt]}const{_finalizers:fn}=this;if(fn){this._finalizers=null;for(const nt of fn)try{Jt(nt)}catch(Qt){Ve=Ve??[],Qt instanceof st?Ve=[...Ve,...Qt.errors]:Ve.push(Qt)}}if(Ve)throw new st(Ve)}}add(Ve){var Le;if(Ve&&Ve!==this)if(this.closed)Jt(Ve);else{if(Ve instanceof qe){if(Ve.closed||Ve._hasParent(this))return;Ve._addParent(this)}(this._finalizers=null!==(Le=this._finalizers)&&void 0!==Le?Le:[]).push(Ve)}}_hasParent(Ve){const{_parentage:Le}=this;return Le===Ve||Array.isArray(Le)&&Le.includes(Ve)}_addParent(Ve){const{_parentage:Le}=this;this._parentage=Array.isArray(Le)?(Le.push(Ve),Le):Le?[Le,Ve]:Ve}_removeParent(Ve){const{_parentage:Le}=this;Le===Ve?this._parentage=null:Array.isArray(Le)&&(0,at.P)(Le,Ve)}remove(Ve){const{_finalizers:Le}=this;Le&&(0,at.P)(Le,Ve),Ve instanceof qe&&Ve._removeParent(this)}}qe.EMPTY=(()=>{const It=new qe;return It.closed=!0,It})();const Ft=qe.EMPTY;function vt(It){return It instanceof qe||It&&"closed"in It&&(0,U.m)(It.remove)&&(0,U.m)(It.add)&&(0,U.m)(It.unsubscribe)}function Jt(It){(0,U.m)(It)?It():It.unsubscribe()}},416:(Fn,mt,ae)=>{ae.d(mt,{v:()=>U});const U={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Fn,mt,ae)=>{ae.d(mt,{E:()=>R});const R=new(ae(751).y)(qe=>qe.complete())},76:(Fn,mt,ae)=>{ae.d(mt,{D:()=>ti});var U=ae(421),R=ae(672),st=ae(482),at=ae(403);function qe(He,St=0){return(0,st.e)((Fe,gt)=>{Fe.subscribe((0,at.x)(gt,un=>(0,R.f)(gt,He,()=>gt.next(un),St),()=>(0,R.f)(gt,He,()=>gt.complete(),St),un=>(0,R.f)(gt,He,()=>gt.error(un),St)))})}function Ft(He,St=0){return(0,st.e)((Fe,gt)=>{gt.add(He.schedule(()=>Fe.subscribe(gt),St))})}var It=ae(751),Le=ae(202),pt=ae(576);function nt(He,St){if(!He)throw new Error("Iterable cannot be null");return new It.y(Fe=>{(0,R.f)(Fe,St,()=>{const gt=He[Symbol.asyncIterator]();(0,R.f)(Fe,St,()=>{gt.next().then(un=>{un.done?Fe.complete():Fe.next(un.value)})},0,!0)})})}var Qt=ae(670),Xt=ae(239),Nn=ae(144),Pn=ae(495),Di=ae(206),kt=ae(532),wt=ae(260);function ti(He,St){return St?function pn(He,St){if(null!=He){if((0,Qt.c)(He))return function vt(He,St){return(0,U.Xf)(He).pipe(Ft(St),qe(St))}(He,St);if((0,Nn.z)(He))return function Ve(He,St){return new It.y(Fe=>{let gt=0;return St.schedule(function(){gt===He.length?Fe.complete():(Fe.next(He[gt++]),Fe.closed||this.schedule())})})}(He,St);if((0,Xt.t)(He))return function Jt(He,St){return(0,U.Xf)(He).pipe(Ft(St),qe(St))}(He,St);if((0,Di.D)(He))return nt(He,St);if((0,Pn.T)(He))return function fn(He,St){return new It.y(Fe=>{let gt;return(0,R.f)(Fe,St,()=>{gt=He[Le.h](),(0,R.f)(Fe,St,()=>{let un,jn;try{({value:un,done:jn}=gt.next())}catch($t){return void Fe.error($t)}jn?Fe.complete():Fe.next(un)},0,!0)}),()=>(0,pt.m)(gt?.return)&&gt.return()})}(He,St);if((0,wt.L)(He))return function dt(He,St){return nt((0,wt.Q)(He),St)}(He,St)}throw(0,kt.z)(He)}(He,St):(0,U.Xf)(He)}},421:(Fn,mt,ae)=>{ae.d(mt,{Xf:()=>fn});var U=ae(582),R=ae(144),st=ae(239),at=ae(751),qe=ae(670),Ft=ae(206),vt=ae(532),Jt=ae(495),It=ae(260),Ve=ae(576),Le=ae(849),pt=ae(822);function fn(wt){if(wt instanceof at.y)return wt;if(null!=wt){if((0,qe.c)(wt))return function nt(wt){return new at.y(dt=>{const pn=wt[pt.L]();if((0,Ve.m)(pn.subscribe))return pn.subscribe(dt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(wt);if((0,R.z)(wt))return function Qt(wt){return new at.y(dt=>{for(let pn=0;pn<wt.length&&!dt.closed;pn++)dt.next(wt[pn]);dt.complete()})}(wt);if((0,st.t)(wt))return function Xt(wt){return new at.y(dt=>{wt.then(pn=>{dt.closed||(dt.next(pn),dt.complete())},pn=>dt.error(pn)).then(null,Le.h)})}(wt);if((0,Ft.D)(wt))return Pn(wt);if((0,Jt.T)(wt))return function Nn(wt){return new at.y(dt=>{for(const pn of wt)if(dt.next(pn),dt.closed)return;dt.complete()})}(wt);if((0,It.L)(wt))return function Di(wt){return Pn((0,It.Q)(wt))}(wt)}throw(0,vt.z)(wt)}function Pn(wt){return new at.y(dt=>{(function kt(wt,dt){var pn,ti,He,St;return(0,U.mG)(this,void 0,void 0,function*(){try{for(pn=(0,U.KL)(wt);!(ti=yield pn.next()).done;)if(dt.next(ti.value),dt.closed)return}catch(Fe){He={error:Fe}}finally{try{ti&&!ti.done&&(St=pn.return)&&(yield St.call(pn))}finally{if(He)throw He.error}}dt.complete()})})(wt,dt).catch(pn=>dt.error(pn))})}},646:(Fn,mt,ae)=>{ae.d(mt,{of:()=>st});var U=ae(669),R=ae(76);function st(...at){const qe=(0,U.yG)(at);return(0,R.D)(at,qe)}},403:(Fn,mt,ae)=>{ae.d(mt,{x:()=>R});var U=ae(961);function R(at,qe,Ft,vt,Jt){return new st(at,qe,Ft,vt,Jt)}class st extends U.Lv{constructor(qe,Ft,vt,Jt,It,Ve){super(qe),this.onFinalize=It,this.shouldUnsubscribe=Ve,this._next=Ft?function(Le){try{Ft(Le)}catch(pt){qe.error(pt)}}:super._next,this._error=Jt?function(Le){try{Jt(Le)}catch(pt){qe.error(pt)}finally{this.unsubscribe()}}:super._error,this._complete=vt?function(){try{vt()}catch(Le){qe.error(Le)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var qe;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ft}=this;super.unsubscribe(),!Ft&&(null===(qe=this.onFinalize)||void 0===qe||qe.call(this))}}}},351:(Fn,mt,ae)=>{ae.d(mt,{b:()=>st});var U=ae(577),R=ae(576);function st(at,qe){return(0,R.m)(qe)?(0,U.z)(at,qe,1):(0,U.z)(at,1)}},300:(Fn,mt,ae)=>{ae.d(mt,{h:()=>st});var U=ae(482),R=ae(403);function st(at,qe){return(0,U.e)((Ft,vt)=>{let Jt=0;Ft.subscribe((0,R.x)(vt,It=>at.call(qe,It,Jt++)&&vt.next(It)))})}},4:(Fn,mt,ae)=>{ae.d(mt,{U:()=>st});var U=ae(482),R=ae(403);function st(at,qe){return(0,U.e)((Ft,vt)=>{let Jt=0;Ft.subscribe((0,R.x)(vt,It=>{vt.next(at.call(qe,It,Jt++))}))})}},189:(Fn,mt,ae)=>{ae.d(mt,{J:()=>st});var U=ae(577),R=ae(671);function st(at=1/0){return(0,U.z)(R.y,at)}},577:(Fn,mt,ae)=>{ae.d(mt,{z:()=>Jt});var U=ae(4),R=ae(421),st=ae(482),at=ae(672),qe=ae(403),vt=ae(576);function Jt(It,Ve,Le=1/0){return(0,vt.m)(Ve)?Jt((pt,fn)=>(0,U.U)((nt,Qt)=>Ve(pt,nt,fn,Qt))((0,R.Xf)(It(pt,fn))),Le):("number"==typeof Ve&&(Le=Ve),(0,st.e)((pt,fn)=>function Ft(It,Ve,Le,pt,fn,nt,Qt,Xt){const Nn=[];let Pn=0,Di=0,kt=!1;const wt=()=>{kt&&!Nn.length&&!Pn&&Ve.complete()},dt=ti=>Pn<pt?pn(ti):Nn.push(ti),pn=ti=>{nt&&Ve.next(ti),Pn++;let He=!1;(0,R.Xf)(Le(ti,Di++)).subscribe((0,qe.x)(Ve,St=>{fn?.(St),nt?dt(St):Ve.next(St)},()=>{He=!0},void 0,()=>{if(He)try{for(Pn--;Nn.length&&Pn<pt;){const St=Nn.shift();Qt?(0,at.f)(Ve,Qt,()=>pn(St)):pn(St)}wt()}catch(St){Ve.error(St)}}))};return It.subscribe((0,qe.x)(Ve,dt,()=>{kt=!0,wt()})),()=>{Xt?.()}}(pt,fn,It,Le)))}},410:(Fn,mt,ae)=>{ae.d(mt,{z:()=>U});const U={setTimeout(R,st,...at){const{delegate:qe}=U;return qe?.setTimeout?qe.setTimeout(R,st,...at):setTimeout(R,st,...at)},clearTimeout(R){const{delegate:st}=U;return(st?.clearTimeout||clearTimeout)(R)},delegate:void 0}},202:(Fn,mt,ae)=>{ae.d(mt,{h:()=>R});const R=function U(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},822:(Fn,mt,ae)=>{ae.d(mt,{L:()=>U});const U="function"==typeof Symbol&&Symbol.observable||"@@observable"},669:(Fn,mt,ae)=>{ae.d(mt,{_6:()=>Ft,jO:()=>at,yG:()=>qe});var U=ae(576);function st(vt){return vt[vt.length-1]}function at(vt){return(0,U.m)(st(vt))?vt.pop():void 0}function qe(vt){return function R(vt){return vt&&(0,U.m)(vt.schedule)}(st(vt))?vt.pop():void 0}function Ft(vt,Jt){return"number"==typeof st(vt)?vt.pop():Jt}},737:(Fn,mt,ae)=>{function U(R,st){if(R){const at=R.indexOf(st);0<=at&&R.splice(at,1)}}ae.d(mt,{P:()=>U})},888:(Fn,mt,ae)=>{function U(R){const at=R(qe=>{Error.call(qe),qe.stack=(new Error).stack});return at.prototype=Object.create(Error.prototype),at.prototype.constructor=at,at}ae.d(mt,{d:()=>U})},806:(Fn,mt,ae)=>{ae.d(mt,{O:()=>at,x:()=>st});var U=ae(416);let R=null;function st(qe){if(U.v.useDeprecatedSynchronousErrorHandling){const Ft=!R;if(Ft&&(R={errorThrown:!1,error:null}),qe(),Ft){const{errorThrown:vt,error:Jt}=R;if(R=null,vt)throw Jt}}else qe()}function at(qe){U.v.useDeprecatedSynchronousErrorHandling&&R&&(R.errorThrown=!0,R.error=qe)}},672:(Fn,mt,ae)=>{function U(R,st,at,qe=0,Ft=!1){const vt=st.schedule(function(){at(),Ft?R.add(this.schedule(null,qe)):this.unsubscribe()},qe);if(R.add(vt),!Ft)return vt}ae.d(mt,{f:()=>U})},671:(Fn,mt,ae)=>{function U(R){return R}ae.d(mt,{y:()=>U})},144:(Fn,mt,ae)=>{ae.d(mt,{z:()=>U});const U=R=>R&&"number"==typeof R.length&&"function"!=typeof R},206:(Fn,mt,ae)=>{ae.d(mt,{D:()=>R});var U=ae(576);function R(st){return Symbol.asyncIterator&&(0,U.m)(st?.[Symbol.asyncIterator])}},576:(Fn,mt,ae)=>{function U(R){return"function"==typeof R}ae.d(mt,{m:()=>U})},670:(Fn,mt,ae)=>{ae.d(mt,{c:()=>st});var U=ae(822),R=ae(576);function st(at){return(0,R.m)(at[U.L])}},495:(Fn,mt,ae)=>{ae.d(mt,{T:()=>st});var U=ae(202),R=ae(576);function st(at){return(0,R.m)(at?.[U.h])}},239:(Fn,mt,ae)=>{ae.d(mt,{t:()=>R});var U=ae(576);function R(st){return(0,U.m)(st?.then)}},260:(Fn,mt,ae)=>{ae.d(mt,{L:()=>at,Q:()=>st});var U=ae(582),R=ae(576);function st(qe){return(0,U.FC)(this,arguments,function*(){const vt=qe.getReader();try{for(;;){const{value:Jt,done:It}=yield(0,U.qq)(vt.read());if(It)return yield(0,U.qq)(void 0);yield yield(0,U.qq)(Jt)}}finally{vt.releaseLock()}})}function at(qe){return(0,R.m)(qe?.getReader)}},482:(Fn,mt,ae)=>{ae.d(mt,{A:()=>R,e:()=>st});var U=ae(576);function R(at){return(0,U.m)(at?.lift)}function st(at){return qe=>{if(R(qe))return qe.lift(function(Ft){try{return at(Ft,this)}catch(vt){this.error(vt)}});throw new TypeError("Unable to lift unknown Observable type")}}},635:(Fn,mt,ae)=>{ae.d(mt,{U:()=>st,z:()=>R});var U=ae(671);function R(...at){return st(at)}function st(at){return 0===at.length?U.y:1===at.length?at[0]:function(Ft){return at.reduce((vt,Jt)=>Jt(vt),Ft)}}},849:(Fn,mt,ae)=>{ae.d(mt,{h:()=>st});var U=ae(416),R=ae(410);function st(at){R.z.setTimeout(()=>{const{onUnhandledError:qe}=U.v;if(!qe)throw at;qe(at)})}},532:(Fn,mt,ae)=>{function U(R){return new TypeError(`You provided ${null!==R&&"object"==typeof R?"an invalid object":`'${R}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}ae.d(mt,{z:()=>U})},895:(Fn,mt,ae)=>{ae.d(mt,{Do:()=>Di,EM:()=>ca,HT:()=>at,JF:()=>Js,K0:()=>Ft,Mx:()=>dl,O5:()=>mn,S$:()=>Xt,V_:()=>It,Ye:()=>kt,b0:()=>Pn,bD:()=>Nh,ez:()=>wm,q:()=>st,w_:()=>qe});var U=ae(256);let R=null;function st(){return R}function at(T){R||(R=T)}class qe{}const Ft=new U.OlP("DocumentToken");let vt=(()=>{class T{historyGo(P){throw new Error("Not implemented")}}return T.\u0275fac=function(P){return new(P||T)},T.\u0275prov=U.Yz7({token:T,factory:function(){return function Jt(){return(0,U.LFG)(Ve)}()},providedIn:"platform"}),T})();const It=new U.OlP("Location Initialized");let Ve=(()=>{class T extends vt{constructor(P){super(),this._doc=P,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return st().getBaseHref(this._doc)}onPopState(P){const G=st().getGlobalEventTarget(this._doc,"window");return G.addEventListener("popstate",P,!1),()=>G.removeEventListener("popstate",P)}onHashChange(P){const G=st().getGlobalEventTarget(this._doc,"window");return G.addEventListener("hashchange",P,!1),()=>G.removeEventListener("hashchange",P)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(P){this._location.pathname=P}pushState(P,G,te){Le()?this._history.pushState(P,G,te):this._location.hash=te}replaceState(P,G,te){Le()?this._history.replaceState(P,G,te):this._location.hash=te}forward(){this._history.forward()}back(){this._history.back()}historyGo(P=0){this._history.go(P)}getState(){return this._history.state}}return T.\u0275fac=function(P){return new(P||T)(U.LFG(Ft))},T.\u0275prov=U.Yz7({token:T,factory:function(){return function pt(){return new Ve((0,U.LFG)(Ft))}()},providedIn:"platform"}),T})();function Le(){return!!window.history.pushState}function fn(T,B){if(0==T.length)return B;if(0==B.length)return T;let P=0;return T.endsWith("/")&&P++,B.startsWith("/")&&P++,2==P?T+B.substring(1):1==P?T+B:T+"/"+B}function nt(T){const B=T.match(/#|\?|$/),P=B&&B.index||T.length;return T.slice(0,P-("/"===T[P-1]?1:0))+T.slice(P)}function Qt(T){return T&&"?"!==T[0]?"?"+T:T}let Xt=(()=>{class T{historyGo(P){throw new Error("Not implemented")}}return T.\u0275fac=function(P){return new(P||T)},T.\u0275prov=U.Yz7({token:T,factory:function(){return(0,U.f3M)(Pn)},providedIn:"root"}),T})();const Nn=new U.OlP("appBaseHref");let Pn=(()=>{class T extends Xt{constructor(P,G){super(),this._platformLocation=P,this._removeListenerFns=[],this._baseHref=G??this._platformLocation.getBaseHrefFromDOM()??(0,U.f3M)(Ft).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}prepareExternalUrl(P){return fn(this._baseHref,P)}path(P=!1){const G=this._platformLocation.pathname+Qt(this._platformLocation.search),te=this._platformLocation.hash;return te&&P?`${G}${te}`:G}pushState(P,G,te,_e){const Ae=this.prepareExternalUrl(te+Qt(_e));this._platformLocation.pushState(P,G,Ae)}replaceState(P,G,te,_e){const Ae=this.prepareExternalUrl(te+Qt(_e));this._platformLocation.replaceState(P,G,Ae)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(P=0){this._platformLocation.historyGo?.(P)}}return T.\u0275fac=function(P){return new(P||T)(U.LFG(vt),U.LFG(Nn,8))},T.\u0275prov=U.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})(),Di=(()=>{class T extends Xt{constructor(P,G){super(),this._platformLocation=P,this._baseHref="",this._removeListenerFns=[],null!=G&&(this._baseHref=G)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}path(P=!1){let G=this._platformLocation.hash;return null==G&&(G="#"),G.length>0?G.substring(1):G}prepareExternalUrl(P){const G=fn(this._baseHref,P);return G.length>0?"#"+G:G}pushState(P,G,te,_e){let Ae=this.prepareExternalUrl(te+Qt(_e));0==Ae.length&&(Ae=this._platformLocation.pathname),this._platformLocation.pushState(P,G,Ae)}replaceState(P,G,te,_e){let Ae=this.prepareExternalUrl(te+Qt(_e));0==Ae.length&&(Ae=this._platformLocation.pathname),this._platformLocation.replaceState(P,G,Ae)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(P=0){this._platformLocation.historyGo?.(P)}}return T.\u0275fac=function(P){return new(P||T)(U.LFG(vt),U.LFG(Nn,8))},T.\u0275prov=U.Yz7({token:T,factory:T.\u0275fac}),T})(),kt=(()=>{class T{constructor(P){this._subject=new U.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=P;const G=this._locationStrategy.getBaseHref();this._basePath=function ti(T){if(new RegExp("^(https?:)?//").test(T)){const[,P]=T.split(/\/\/[^\/]+/);return P}return T}(nt(pn(G))),this._locationStrategy.onPopState(te=>{this._subject.emit({url:this.path(!0),pop:!0,state:te.state,type:te.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(P=!1){return this.normalize(this._locationStrategy.path(P))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(P,G=""){return this.path()==this.normalize(P+Qt(G))}normalize(P){return T.stripTrailingSlash(function dt(T,B){if(!T||!B.startsWith(T))return B;const P=B.substring(T.length);return""===P||["/",";","?","#"].includes(P[0])?P:B}(this._basePath,pn(P)))}prepareExternalUrl(P){return P&&"/"!==P[0]&&(P="/"+P),this._locationStrategy.prepareExternalUrl(P)}go(P,G="",te=null){this._locationStrategy.pushState(te,"",P,G),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+Qt(G)),te)}replaceState(P,G="",te=null){this._locationStrategy.replaceState(te,"",P,G),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+Qt(G)),te)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(P=0){this._locationStrategy.historyGo?.(P)}onUrlChange(P){return this._urlChangeListeners.push(P),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(G=>{this._notifyUrlChangeListeners(G.url,G.state)})),()=>{const G=this._urlChangeListeners.indexOf(P);this._urlChangeListeners.splice(G,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(P="",G){this._urlChangeListeners.forEach(te=>te(P,G))}subscribe(P,G,te){return this._subject.subscribe({next:P,error:G,complete:te})}}return T.normalizeQueryParams=Qt,T.joinWithSlash=fn,T.stripTrailingSlash=nt,T.\u0275fac=function(P){return new(P||T)(U.LFG(Xt))},T.\u0275prov=U.Yz7({token:T,factory:function(){return function wt(){return new kt((0,U.LFG)(Xt))}()},providedIn:"root"}),T})();function pn(T){return T.replace(/\/index.html$/,"")}function dl(T,B){B=encodeURIComponent(B);for(const P of T.split(";")){const G=P.indexOf("="),[te,_e]=-1==G?[P,""]:[P.slice(0,G),P.slice(G+1)];if(te.trim()===B)return decodeURIComponent(_e)}return null}let mn=(()=>{class T{constructor(P,G){this._viewContainer=P,this._context=new Ri,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=G}set ngIf(P){this._context.$implicit=this._context.ngIf=P,this._updateView()}set ngIfThen(P){Ci("ngIfThen",P),this._thenTemplateRef=P,this._thenViewRef=null,this._updateView()}set ngIfElse(P){Ci("ngIfElse",P),this._elseTemplateRef=P,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(P,G){return!0}}return T.\u0275fac=function(P){return new(P||T)(U.Y36(U.s_b),U.Y36(U.Rgc))},T.\u0275dir=U.lG2({type:T,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),T})();class Ri{constructor(){this.$implicit=null,this.ngIf=null}}function Ci(T,B){if(B&&!B.createEmbeddedView)throw new Error(`${T} must be a TemplateRef, but received '${(0,U.AaK)(B)}'.`)}let wm=(()=>{class T{}return T.\u0275fac=function(P){return new(P||T)},T.\u0275mod=U.oAB({type:T}),T.\u0275inj=U.cJS({}),T})();const Nh="browser";let ca=(()=>{class T{}return T.\u0275prov=(0,U.Yz7)({token:T,providedIn:"root",factory:()=>new Oh((0,U.LFG)(Ft),window)}),T})();class Oh{constructor(B,P){this.document=B,this.window=P,this.offset=()=>[0,0]}setOffset(B){this.offset=Array.isArray(B)?()=>B:B}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(B){this.supportsScrolling()&&this.window.scrollTo(B[0],B[1])}scrollToAnchor(B){if(!this.supportsScrolling())return;const P=function fu(T,B){const P=T.getElementById(B)||T.getElementsByName(B)[0];if(P)return P;if("function"==typeof T.createTreeWalker&&T.body&&(T.body.createShadowRoot||T.body.attachShadow)){const G=T.createTreeWalker(T.body,NodeFilter.SHOW_ELEMENT);let te=G.currentNode;for(;te;){const _e=te.shadowRoot;if(_e){const Ae=_e.getElementById(B)||_e.querySelector(`[name="${B}"]`);if(Ae)return Ae}te=G.nextNode()}}return null}(this.document,B);P&&(this.scrollToElement(P),P.focus())}setHistoryScrollRestoration(B){if(this.supportScrollRestoration()){const P=this.window.history;P&&P.scrollRestoration&&(P.scrollRestoration=B)}}scrollToElement(B){const P=B.getBoundingClientRect(),G=P.left+this.window.pageXOffset,te=P.top+this.window.pageYOffset,_e=this.offset();this.window.scrollTo(G-_e[0],te-_e[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const B=pc(this.window.history)||pc(Object.getPrototypeOf(this.window.history));return!(!B||!B.writable&&!B.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function pc(T){return Object.getOwnPropertyDescriptor(T,"scrollRestoration")}class Js{}},529:(Fn,mt,ae)=>{ae.d(mt,{JF:()=>ta,eN:()=>ur});var U=ae(895),R=ae(256),st=ae(646),at=ae(751),qe=ae(351),Ft=ae(300),vt=ae(4);class Jt{}class It{}class Ve{constructor(oe){this.normalizedNames=new Map,this.lazyUpdate=null,oe?this.lazyInit="string"==typeof oe?()=>{this.headers=new Map,oe.split("\n").forEach(ce=>{const We=ce.indexOf(":");if(We>0){const ze=ce.slice(0,We),Ut=ze.toLowerCase(),ni=ce.slice(We+1).trim();this.maybeSetNormalizedName(ze,Ut),this.headers.has(Ut)?this.headers.get(Ut).push(ni):this.headers.set(Ut,[ni])}})}:()=>{this.headers=new Map,Object.entries(oe).forEach(([ce,We])=>{let ze;if(ze="string"==typeof We?[We]:"number"==typeof We?[We.toString()]:We.map(Ut=>Ut.toString()),ze.length>0){const Ut=ce.toLowerCase();this.headers.set(Ut,ze),this.maybeSetNormalizedName(ce,Ut)}})}:this.headers=new Map}has(oe){return this.init(),this.headers.has(oe.toLowerCase())}get(oe){this.init();const ce=this.headers.get(oe.toLowerCase());return ce&&ce.length>0?ce[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(oe){return this.init(),this.headers.get(oe.toLowerCase())||null}append(oe,ce){return this.clone({name:oe,value:ce,op:"a"})}set(oe,ce){return this.clone({name:oe,value:ce,op:"s"})}delete(oe,ce){return this.clone({name:oe,value:ce,op:"d"})}maybeSetNormalizedName(oe,ce){this.normalizedNames.has(ce)||this.normalizedNames.set(ce,oe)}init(){this.lazyInit&&(this.lazyInit instanceof Ve?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(oe=>this.applyUpdate(oe)),this.lazyUpdate=null))}copyFrom(oe){oe.init(),Array.from(oe.headers.keys()).forEach(ce=>{this.headers.set(ce,oe.headers.get(ce)),this.normalizedNames.set(ce,oe.normalizedNames.get(ce))})}clone(oe){const ce=new Ve;return ce.lazyInit=this.lazyInit&&this.lazyInit instanceof Ve?this.lazyInit:this,ce.lazyUpdate=(this.lazyUpdate||[]).concat([oe]),ce}applyUpdate(oe){const ce=oe.name.toLowerCase();switch(oe.op){case"a":case"s":let We=oe.value;if("string"==typeof We&&(We=[We]),0===We.length)return;this.maybeSetNormalizedName(oe.name,ce);const ze=("a"===oe.op?this.headers.get(ce):void 0)||[];ze.push(...We),this.headers.set(ce,ze);break;case"d":const Ut=oe.value;if(Ut){let ni=this.headers.get(ce);if(!ni)return;ni=ni.filter(Bi=>-1===Ut.indexOf(Bi)),0===ni.length?(this.headers.delete(ce),this.normalizedNames.delete(ce)):this.headers.set(ce,ni)}else this.headers.delete(ce),this.normalizedNames.delete(ce)}}forEach(oe){this.init(),Array.from(this.normalizedNames.keys()).forEach(ce=>oe(this.normalizedNames.get(ce),this.headers.get(ce)))}}class pt{encodeKey(oe){return Xt(oe)}encodeValue(oe){return Xt(oe)}decodeKey(oe){return decodeURIComponent(oe)}decodeValue(oe){return decodeURIComponent(oe)}}const nt=/%(\d[a-f0-9])/gi,Qt={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Xt(Oe){return encodeURIComponent(Oe).replace(nt,(oe,ce)=>Qt[ce]??oe)}function Nn(Oe){return`${Oe}`}class Pn{constructor(oe={}){if(this.updates=null,this.cloneFrom=null,this.encoder=oe.encoder||new pt,oe.fromString){if(oe.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function fn(Oe,oe){const ce=new Map;return Oe.length>0&&Oe.replace(/^\?/,"").split("&").forEach(ze=>{const Ut=ze.indexOf("="),[ni,Bi]=-1==Ut?[oe.decodeKey(ze),""]:[oe.decodeKey(ze.slice(0,Ut)),oe.decodeValue(ze.slice(Ut+1))],Cn=ce.get(ni)||[];Cn.push(Bi),ce.set(ni,Cn)}),ce}(oe.fromString,this.encoder)}else oe.fromObject?(this.map=new Map,Object.keys(oe.fromObject).forEach(ce=>{const We=oe.fromObject[ce],ze=Array.isArray(We)?We.map(Nn):[Nn(We)];this.map.set(ce,ze)})):this.map=null}has(oe){return this.init(),this.map.has(oe)}get(oe){this.init();const ce=this.map.get(oe);return ce?ce[0]:null}getAll(oe){return this.init(),this.map.get(oe)||null}keys(){return this.init(),Array.from(this.map.keys())}append(oe,ce){return this.clone({param:oe,value:ce,op:"a"})}appendAll(oe){const ce=[];return Object.keys(oe).forEach(We=>{const ze=oe[We];Array.isArray(ze)?ze.forEach(Ut=>{ce.push({param:We,value:Ut,op:"a"})}):ce.push({param:We,value:ze,op:"a"})}),this.clone(ce)}set(oe,ce){return this.clone({param:oe,value:ce,op:"s"})}delete(oe,ce){return this.clone({param:oe,value:ce,op:"d"})}toString(){return this.init(),this.keys().map(oe=>{const ce=this.encoder.encodeKey(oe);return this.map.get(oe).map(We=>ce+"="+this.encoder.encodeValue(We)).join("&")}).filter(oe=>""!==oe).join("&")}clone(oe){const ce=new Pn({encoder:this.encoder});return ce.cloneFrom=this.cloneFrom||this,ce.updates=(this.updates||[]).concat(oe),ce}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(oe=>this.map.set(oe,this.cloneFrom.map.get(oe))),this.updates.forEach(oe=>{switch(oe.op){case"a":case"s":const ce=("a"===oe.op?this.map.get(oe.param):void 0)||[];ce.push(Nn(oe.value)),this.map.set(oe.param,ce);break;case"d":if(void 0===oe.value){this.map.delete(oe.param);break}{let We=this.map.get(oe.param)||[];const ze=We.indexOf(Nn(oe.value));-1!==ze&&We.splice(ze,1),We.length>0?this.map.set(oe.param,We):this.map.delete(oe.param)}}}),this.cloneFrom=this.updates=null)}}class kt{constructor(){this.map=new Map}set(oe,ce){return this.map.set(oe,ce),this}get(oe){return this.map.has(oe)||this.map.set(oe,oe.defaultValue()),this.map.get(oe)}delete(oe){return this.map.delete(oe),this}has(oe){return this.map.has(oe)}keys(){return this.map.keys()}}function dt(Oe){return typeof ArrayBuffer<"u"&&Oe instanceof ArrayBuffer}function pn(Oe){return typeof Blob<"u"&&Oe instanceof Blob}function ti(Oe){return typeof FormData<"u"&&Oe instanceof FormData}class St{constructor(oe,ce,We,ze){let Ut;if(this.url=ce,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=oe.toUpperCase(),function wt(Oe){switch(Oe){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||ze?(this.body=void 0!==We?We:null,Ut=ze):Ut=We,Ut&&(this.reportProgress=!!Ut.reportProgress,this.withCredentials=!!Ut.withCredentials,Ut.responseType&&(this.responseType=Ut.responseType),Ut.headers&&(this.headers=Ut.headers),Ut.context&&(this.context=Ut.context),Ut.params&&(this.params=Ut.params)),this.headers||(this.headers=new Ve),this.context||(this.context=new kt),this.params){const ni=this.params.toString();if(0===ni.length)this.urlWithParams=ce;else{const Bi=ce.indexOf("?");this.urlWithParams=ce+(-1===Bi?"?":Bi<ce.length-1?"&":"")+ni}}else this.params=new Pn,this.urlWithParams=ce}serializeBody(){return null===this.body?null:dt(this.body)||pn(this.body)||ti(this.body)||function He(Oe){return typeof URLSearchParams<"u"&&Oe instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Pn?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||ti(this.body)?null:pn(this.body)?this.body.type||null:dt(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Pn?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(oe={}){const ce=oe.method||this.method,We=oe.url||this.url,ze=oe.responseType||this.responseType,Ut=void 0!==oe.body?oe.body:this.body,ni=void 0!==oe.withCredentials?oe.withCredentials:this.withCredentials,Bi=void 0!==oe.reportProgress?oe.reportProgress:this.reportProgress;let Cn=oe.headers||this.headers,si=oe.params||this.params;const Qr=oe.context??this.context;return void 0!==oe.setHeaders&&(Cn=Object.keys(oe.setHeaders).reduce((ws,ii)=>ws.set(ii,oe.setHeaders[ii]),Cn)),oe.setParams&&(si=Object.keys(oe.setParams).reduce((ws,ii)=>ws.set(ii,oe.setParams[ii]),si)),new St(ce,We,Ut,{params:si,headers:Cn,context:Qr,reportProgress:Bi,responseType:ze,withCredentials:ni})}}var Fe=(()=>((Fe=Fe||{})[Fe.Sent=0]="Sent",Fe[Fe.UploadProgress=1]="UploadProgress",Fe[Fe.ResponseHeader=2]="ResponseHeader",Fe[Fe.DownloadProgress=3]="DownloadProgress",Fe[Fe.Response=4]="Response",Fe[Fe.User=5]="User",Fe))();class gt{constructor(oe,ce=200,We="OK"){this.headers=oe.headers||new Ve,this.status=void 0!==oe.status?oe.status:ce,this.statusText=oe.statusText||We,this.url=oe.url||null,this.ok=this.status>=200&&this.status<300}}class un extends gt{constructor(oe={}){super(oe),this.type=Fe.ResponseHeader}clone(oe={}){return new un({headers:oe.headers||this.headers,status:void 0!==oe.status?oe.status:this.status,statusText:oe.statusText||this.statusText,url:oe.url||this.url||void 0})}}class jn extends gt{constructor(oe={}){super(oe),this.type=Fe.Response,this.body=void 0!==oe.body?oe.body:null}clone(oe={}){return new jn({body:void 0!==oe.body?oe.body:this.body,headers:oe.headers||this.headers,status:void 0!==oe.status?oe.status:this.status,statusText:oe.statusText||this.statusText,url:oe.url||this.url||void 0})}}class $t extends gt{constructor(oe){super(oe,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${oe.url||"(unknown url)"}`:`Http failure response for ${oe.url||"(unknown url)"}: ${oe.status} ${oe.statusText}`,this.error=oe.error||null}}function Os(Oe,oe){return{body:oe,headers:Oe.headers,context:Oe.context,observe:Oe.observe,params:Oe.params,reportProgress:Oe.reportProgress,responseType:Oe.responseType,withCredentials:Oe.withCredentials}}let ur=(()=>{class Oe{constructor(ce){this.handler=ce}request(ce,We,ze={}){let Ut;if(ce instanceof St)Ut=ce;else{let Cn,si;Cn=ze.headers instanceof Ve?ze.headers:new Ve(ze.headers),ze.params&&(si=ze.params instanceof Pn?ze.params:new Pn({fromObject:ze.params})),Ut=new St(ce,We,void 0!==ze.body?ze.body:null,{headers:Cn,context:ze.context,params:si,reportProgress:ze.reportProgress,responseType:ze.responseType||"json",withCredentials:ze.withCredentials})}const ni=(0,st.of)(Ut).pipe((0,qe.b)(Cn=>this.handler.handle(Cn)));if(ce instanceof St||"events"===ze.observe)return ni;const Bi=ni.pipe((0,Ft.h)(Cn=>Cn instanceof jn));switch(ze.observe||"body"){case"body":switch(Ut.responseType){case"arraybuffer":return Bi.pipe((0,vt.U)(Cn=>{if(null!==Cn.body&&!(Cn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Cn.body}));case"blob":return Bi.pipe((0,vt.U)(Cn=>{if(null!==Cn.body&&!(Cn.body instanceof Blob))throw new Error("Response is not a Blob.");return Cn.body}));case"text":return Bi.pipe((0,vt.U)(Cn=>{if(null!==Cn.body&&"string"!=typeof Cn.body)throw new Error("Response is not a string.");return Cn.body}));default:return Bi.pipe((0,vt.U)(Cn=>Cn.body))}case"response":return Bi;default:throw new Error(`Unreachable: unhandled observe type ${ze.observe}}`)}}delete(ce,We={}){return this.request("DELETE",ce,We)}get(ce,We={}){return this.request("GET",ce,We)}head(ce,We={}){return this.request("HEAD",ce,We)}jsonp(ce,We){return this.request("JSONP",ce,{params:(new Pn).append(We,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(ce,We={}){return this.request("OPTIONS",ce,We)}patch(ce,We,ze={}){return this.request("PATCH",ce,Os(ze,We))}post(ce,We,ze={}){return this.request("POST",ce,Os(ze,We))}put(ce,We,ze={}){return this.request("PUT",ce,Os(ze,We))}}return Oe.\u0275fac=function(ce){return new(ce||Oe)(R.LFG(Jt))},Oe.\u0275prov=R.Yz7({token:Oe,factory:Oe.\u0275fac}),Oe})();function Da(Oe,oe){return oe(Oe)}function Ia(Oe,oe){return(ce,We)=>oe.intercept(ce,{handle:ze=>Oe(ze,We)})}const cs=new R.OlP("HTTP_INTERCEPTORS"),ye=new R.OlP("HTTP_INTERCEPTOR_FNS");function be(){let Oe=null;return(oe,ce)=>(null===Oe&&(Oe=((0,R.f3M)(cs,{optional:!0})??[]).reduceRight(Ia,Da)),Oe(oe,ce))}let Se=(()=>{class Oe extends Jt{constructor(ce,We){super(),this.backend=ce,this.injector=We,this.chain=null}handle(ce){if(null===this.chain){const We=Array.from(new Set(this.injector.get(ye)));this.chain=We.reduceRight((ze,Ut)=>function cc(Oe,oe,ce){return(We,ze)=>ce.runInContext(()=>oe(We,Ut=>Oe(Ut,ze)))}(ze,Ut,this.injector),Da)}return this.chain(ce,We=>this.backend.handle(We))}}return Oe.\u0275fac=function(ce){return new(ce||Oe)(R.LFG(It),R.LFG(R.lqb))},Oe.\u0275prov=R.Yz7({token:Oe,factory:Oe.\u0275fac}),Oe})();const Li=/^\)\]\}',?\n/;let pi=(()=>{class Oe{constructor(ce){this.xhrFactory=ce}handle(ce){if("JSONP"===ce.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new at.y(We=>{const ze=this.xhrFactory.build();if(ze.open(ce.method,ce.urlWithParams),ce.withCredentials&&(ze.withCredentials=!0),ce.headers.forEach((_t,Un)=>ze.setRequestHeader(_t,Un.join(","))),ce.headers.has("Accept")||ze.setRequestHeader("Accept","application/json, text/plain, */*"),!ce.headers.has("Content-Type")){const _t=ce.detectContentTypeHeader();null!==_t&&ze.setRequestHeader("Content-Type",_t)}if(ce.responseType){const _t=ce.responseType.toLowerCase();ze.responseType="json"!==_t?_t:"text"}const Ut=ce.serializeBody();let ni=null;const Bi=()=>{if(null!==ni)return ni;const _t=ze.statusText||"OK",Un=new Ve(ze.getAllResponseHeaders()),ri=function vr(Oe){return"responseURL"in Oe&&Oe.responseURL?Oe.responseURL:/^X-Request-URL:/m.test(Oe.getAllResponseHeaders())?Oe.getResponseHeader("X-Request-URL"):null}(ze)||ce.url;return ni=new un({headers:Un,status:ze.status,statusText:_t,url:ri}),ni},Cn=()=>{let{headers:_t,status:Un,statusText:ri,url:us}=Bi(),vi=null;204!==Un&&(vi=typeof ze.response>"u"?ze.responseText:ze.response),0===Un&&(Un=vi?200:0);let on=Un>=200&&Un<300;if("json"===ce.responseType&&"string"==typeof vi){const Us=vi;vi=vi.replace(Li,"");try{vi=""!==vi?JSON.parse(vi):null}catch(fo){vi=Us,on&&(on=!1,vi={error:fo,text:vi})}}on?(We.next(new jn({body:vi,headers:_t,status:Un,statusText:ri,url:us||void 0})),We.complete()):We.error(new $t({error:vi,headers:_t,status:Un,statusText:ri,url:us||void 0}))},si=_t=>{const{url:Un}=Bi(),ri=new $t({error:_t,status:ze.status||0,statusText:ze.statusText||"Unknown Error",url:Un||void 0});We.error(ri)};let Qr=!1;const ws=_t=>{Qr||(We.next(Bi()),Qr=!0);let Un={type:Fe.DownloadProgress,loaded:_t.loaded};_t.lengthComputable&&(Un.total=_t.total),"text"===ce.responseType&&ze.responseText&&(Un.partialText=ze.responseText),We.next(Un)},ii=_t=>{let Un={type:Fe.UploadProgress,loaded:_t.loaded};_t.lengthComputable&&(Un.total=_t.total),We.next(Un)};return ze.addEventListener("load",Cn),ze.addEventListener("error",si),ze.addEventListener("timeout",si),ze.addEventListener("abort",si),ce.reportProgress&&(ze.addEventListener("progress",ws),null!==Ut&&ze.upload&&ze.upload.addEventListener("progress",ii)),ze.send(Ut),We.next({type:Fe.Sent}),()=>{ze.removeEventListener("error",si),ze.removeEventListener("abort",si),ze.removeEventListener("load",Cn),ze.removeEventListener("timeout",si),ce.reportProgress&&(ze.removeEventListener("progress",ws),null!==Ut&&ze.upload&&ze.upload.removeEventListener("progress",ii)),ze.readyState!==ze.DONE&&ze.abort()}})}}return Oe.\u0275fac=function(ce){return new(ce||Oe)(R.LFG(U.JF))},Oe.\u0275prov=R.Yz7({token:Oe,factory:Oe.\u0275fac}),Oe})();const Lr=new R.OlP("XSRF_ENABLED"),uc=new R.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Qo=new R.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Zs{}let dc=(()=>{class Oe{constructor(ce,We,ze){this.doc=ce,this.platform=We,this.cookieName=ze,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const ce=this.doc.cookie||"";return ce!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,U.Mx)(ce,this.cookieName),this.lastCookieString=ce),this.lastToken}}return Oe.\u0275fac=function(ce){return new(ce||Oe)(R.LFG(U.K0),R.LFG(R.Lbi),R.LFG(uc))},Oe.\u0275prov=R.Yz7({token:Oe,factory:Oe.\u0275fac}),Oe})();function Oi(Oe,oe){const ce=Oe.url.toLowerCase();if(!(0,R.f3M)(Lr)||"GET"===Oe.method||"HEAD"===Oe.method||ce.startsWith("http://")||ce.startsWith("https://"))return oe(Oe);const We=(0,R.f3M)(Zs).getToken(),ze=(0,R.f3M)(Qo);return null!=We&&!Oe.headers.has(ze)&&(Oe=Oe.clone({headers:Oe.headers.set(ze,We)})),oe(Oe)}var xt=(()=>((xt=xt||{})[xt.Interceptors=0]="Interceptors",xt[xt.LegacyInterceptors=1]="LegacyInterceptors",xt[xt.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",xt[xt.NoXsrfProtection=3]="NoXsrfProtection",xt[xt.JsonpSupport=4]="JsonpSupport",xt[xt.RequestsMadeViaParent=5]="RequestsMadeViaParent",xt))();function Fs(Oe,oe){return{\u0275kind:Oe,\u0275providers:oe}}function qi(...Oe){const oe=[ur,pi,Se,{provide:Jt,useExisting:Se},{provide:It,useExisting:pi},{provide:ye,useValue:Oi,multi:!0},{provide:Lr,useValue:!0},{provide:Zs,useClass:dc}];for(const ce of Oe)oe.push(...ce.\u0275providers);return(0,R.MR2)(oe)}const Ks=new R.OlP("LEGACY_INTERCEPTOR_FN");let ta=(()=>{class Oe{}return Oe.\u0275fac=function(ce){return new(ce||Oe)},Oe.\u0275mod=R.oAB({type:Oe}),Oe.\u0275inj=R.cJS({providers:[qi(Fs(xt.LegacyInterceptors,[{provide:Ks,useFactory:be},{provide:ye,useExisting:Ks,multi:!0}]))]}),Oe})()},256:(Fn,mt,ae)=>{ae.d(mt,{tb:()=>wi,AFp:()=>lt,ip1:()=>rn,CZH:()=>Zt,hGG:()=>cS,z2F:()=>Xv,sBO:()=>Xb,Sil:()=>lc,_Vd:()=>jo,EJc:()=>Ye,Xts:()=>qa,SBq:()=>Qa,lqb:()=>Yl,qLn:()=>Qc,vpe:()=>Zo,XFs:()=>Xe,OlP:()=>yi,zs3:()=>Hr,ZZ4:()=>DM,aQg:()=>IM,soG:()=>ot,YKP:()=>Sv,h0i:()=>Th,PXZ:()=>En,R0b:()=>Jo,FiY:()=>$r,Lbi:()=>Gn,g9A:()=>Ot,Qsj:()=>ed,FYo:()=>Jc,JOm:()=>jr,tp0:()=>Uo,Rgc:()=>Dh,dDg:()=>ut,eoX:()=>Lt,GfV:()=>td,s_b:()=>zr,ifc:()=>us,MMx:()=>a_,Lck:()=>Xx,eFA:()=>co,Gpc:()=>Di,f3M:()=>Bi,$WT:()=>Ao,MR2:()=>Cp,_c5:()=>lS,c2e:()=>Dt,zSh:()=>Vi,wAp:()=>bn,vHH:()=>He,lri:()=>Me,rWj:()=>fe,D6c:()=>uS,cg1:()=>am,kL8:()=>Wg,dqk:()=>Ln,Z0I:()=>Lr,eJc:()=>E,CqO:()=>Cy,QGY:()=>Pg,F4k:()=>wy,RDi:()=>Wu,AaK:()=>Xt,qOj:()=>cy,TTD:()=>ua,_Bn:()=>bv,jDz:()=>Cv,xp6:()=>_,uIk:()=>Cg,ekj:()=>kg,Suo:()=>Gv,Xpm:()=>kn,lG2:()=>uu,Yz7:()=>In,cJS:()=>vr,oAB:()=>Cs,Yjl:()=>dl,Y36:()=>Of,_UZ:()=>Dg,qZA:()=>Qp,TgZ:()=>Jp,EpF:()=>Ey,n5z:()=>Dm,LFG:()=>Ut,$8M:()=>ga,$Z:()=>hg,NdJ:()=>Ng,CRH:()=>Wv,kcU:()=>B,O4$:()=>Mu,oxw:()=>Ry,Q6J:()=>Tg,iGM:()=>zv,KtG:()=>_u,Jf7:()=>If,CHM:()=>Ua,P3R:()=>Xl,Udp:()=>Bg,YNc:()=>by,_uU:()=>Z0,Oqu:()=>Ky,hij:()=>Hg,Gf:()=>ou});var U=ae(579),R=ae(727),st=ae(751),at=ae(189),qe=ae(421),Ft=ae(515),vt=ae(669),Jt=ae(76),Ve=ae(961),Le=ae(482);function fn(n,r,...o){if(!0===r)return void n();if(!1===r)return;const c=new Ve.Hp({next:()=>{c.unsubscribe(),n()}});return(0,qe.Xf)(r(...o)).subscribe(c)}function nt(n){for(let r in n)if(n[r]===nt)return r;throw Error("Could not find renamed property on target object.")}function Qt(n,r){for(const o in r)r.hasOwnProperty(o)&&!n.hasOwnProperty(o)&&(n[o]=r[o])}function Xt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Xt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const o=r.indexOf("\n");return-1===o?r:r.substring(0,o)}function Nn(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const Pn=nt({__forward_ref__:nt});function Di(n){return n.__forward_ref__=Di,n.toString=function(){return Xt(this())},n}function kt(n){return wt(n)?n():n}function wt(n){return"function"==typeof n&&n.hasOwnProperty(Pn)&&n.__forward_ref__===Di}function dt(n){return n&&!!n.\u0275providers}const ti="https://g.co/ng/security#xss";class He extends Error{constructor(r,o){super(St(r,o)),this.code=r}}function St(n,r){return`NG0${Math.abs(n)}${r?": "+r.trim():""}`}function Fe(n){return"string"==typeof n?n:null==n?"":String(n)}function Os(n,r){throw new He(-201,!1)}function fi(n,r){null==n&&function Mt(n,r,o,c){throw new Error(`ASSERTION ERROR: ${n}`+(null==c?"":` [Expected=> ${o} ${c} ${r} <=Actual]`))}(r,n,null,"!=")}function In(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function vr(n){return{providers:n.providers||[],imports:n.imports||[]}}function pi(n){return ll(n,Qo)||ll(n,dc)}function Lr(n){return null!==pi(n)}function ll(n,r){return n.hasOwnProperty(r)?n[r]:null}function lu(n){return n&&(n.hasOwnProperty(Zs)||n.hasOwnProperty(Oi))?n[Zs]:null}const Qo=nt({\u0275prov:nt}),Zs=nt({\u0275inj:nt}),dc=nt({ngInjectableDef:nt}),Oi=nt({ngInjectorDef:nt});var Xe=(()=>((Xe=Xe||{})[Xe.Default=0]="Default",Xe[Xe.Host=1]="Host",Xe[Xe.Self=2]="Self",Xe[Xe.SkipSelf=4]="SkipSelf",Xe[Xe.Optional=8]="Optional",Xe))();let xt;function qi(n){const r=xt;return xt=n,r}function xr(n,r,o){const c=pi(n);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:o&Xe.Optional?null:void 0!==r?r:void Os(Xt(n))}const Ln=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),mi={},ea="__NG_DI_FLAG__",ta="ngTempTokenPath",dr="ngTokenPath",na=/\n/gm,Oe="\u0275",oe="__source";let ce;function We(n){const r=ce;return ce=n,r}function ze(n,r=Xe.Default){if(void 0===ce)throw new He(-203,!1);return null===ce?xr(n,void 0,r):ce.get(n,r&Xe.Optional?null:void 0,r)}function Ut(n,r=Xe.Default){return(function Fs(){return xt}()||ze)(kt(n),r)}function Bi(n,r=Xe.Default){return Ut(n,Cn(r))}function Cn(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function si(n){const r=[];for(let o=0;o<n.length;o++){const c=kt(n[o]);if(Array.isArray(c)){if(0===c.length)throw new He(900,!1);let p,g=Xe.Default;for(let x=0;x<c.length;x++){const w=c[x],I=ws(w);"number"==typeof I?-1===I?p=w.token:g|=I:p=w}r.push(Ut(p,g))}else r.push(Ut(c))}return r}function Qr(n,r){return n[ea]=r,n.prototype[ea]=r,n}function ws(n){return n[ea]}function Un(n){return{toString:n}.toString()}var ri=(()=>((ri=ri||{})[ri.OnPush=0]="OnPush",ri[ri.Default=1]="Default",ri))(),us=(()=>{return(n=us||(us={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",us;var n})();const vi={},on=[],Us=nt({\u0275cmp:nt}),fo=nt({\u0275dir:nt}),ia=nt({\u0275pipe:nt}),cl=nt({\u0275mod:nt}),Bs=nt({\u0275fac:nt}),ra=nt({__NG_ELEMENT_ID__:nt});let Ra=0;function kn(n){return Un(()=>{const r=Do(n),o={...r,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ri.OnPush,directiveDefs:null,pipeDefs:null,dependencies:r.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||us.Emulated,id:"c"+Ra++,styles:n.styles||on,_:null,schemas:n.schemas||null,tView:null};hl(o);const c=n.dependencies;return o.directiveDefs=Pa(c,!1),o.pipeDefs=Pa(c,!0),o})}function fc(n){return Zn(n)||Zi(n)}function sa(n){return null!==n}function Cs(n){return Un(()=>({type:n.type,bootstrap:n.bootstrap||on,declarations:n.declarations||on,imports:n.imports||on,exports:n.exports||on,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Mr(n,r){if(null==n)return vi;const o={};for(const c in n)if(n.hasOwnProperty(c)){let p=n[c],g=p;Array.isArray(p)&&(g=p[1],p=p[0]),o[p]=c,r&&(r[p]=g)}return o}function uu(n){return Un(()=>{const r=Do(n);return hl(r),r})}function dl(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Zn(n){return n[Us]||null}function Zi(n){return n[fo]||null}function Ki(n){return n[ia]||null}function Ao(n){const r=Zn(n)||Zi(n)||Ki(n);return null!==r&&r.standalone}function hr(n,r){const o=n[cl]||null;if(!o&&!0===r)throw new Error(`Type ${Xt(n)} does not have '\u0275mod' property.`);return o}function Do(n){const r={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||on,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Mr(n.inputs,r),outputs:Mr(n.outputs)}}function hl(n){n.features?.forEach(r=>r(n))}function Pa(n,r){if(!n)return null;const o=r?Ki:fc;return()=>("function"==typeof n?n():n).map(c=>o(c)).filter(sa)}const ds=0,Rt=1,mn=2,Ri=3,Ci=4,hs=5,Wi=6,br=7,xi=8,fl=9,es=10,dn=11,oa=12,aa=13,du=14,Pi=15,Gi=16,Ji=17,fs=18,ps=19,Io=20,Na=21,oi=22,La=1,Oa=2,Sn=7,la=8,ml=9,ir=10;function ms(n){return Array.isArray(n)&&"object"==typeof n[La]}function rr(n){return Array.isArray(n)&&!0===n[La]}function hu(n){return 0!=(4&n.flags)}function Ts(n){return n.componentOffset>-1}function Fa(n){return 1==(1&n.flags)}function Sr(n){return!!n.template}function gi(n){return 0!=(256&n[mn])}function Js(n,r){return n.hasOwnProperty(Bs)?n[Bs]:null}class mc{constructor(r,o,c){this.previousValue=r,this.currentValue=o,this.firstChange=c}isFirstChange(){return this.firstChange}}function ua(){return gc}function gc(n){return n.type.prototype.ngOnChanges&&(n.setInput=pu),Fh}function Fh(){const n=mo(this),r=n?.current;if(r){const o=n.previous;if(o===vi)n.previous=r;else for(let c in r)o[c]=r[c];n.current=null,this.ngOnChanges(r)}}function pu(n,r,o,c){const p=this.declaredInputs[o],g=mo(n)||function Uh(n,r){return n[yl]=r}(n,{previous:vi,current:null}),x=g.current||(g.current={}),w=g.previous,I=w[p];x[p]=new mc(I&&I.currentValue,r,w===vi),n[c]=r}ua.ngInherit=!0;const yl="__ngSimpleChanges__";function mo(n){return n[yl]||null}const ks=function(n,r,o){},mu="svg";function Or(n){for(;Array.isArray(n);)n=n[ds];return n}function gu(n,r){return Or(r[n])}function gs(n,r){return Or(r[n.index])}function go(n,r){return n.data[r]}function sr(n,r){const o=r[n];return ms(o)?o:o[ds]}function _o(n){return 64==(64&n[mn])}function Qs(n,r){return null==r?null:n[r]}function Ro(n){n[fs]=0}function Vs(n,r){n[hs]+=r;let o=n,c=n[Ri];for(;null!==c&&(1===r&&1===o[hs]||-1===r&&0===o[hs]);)c[hs]+=r,o=c,c=c[Ri]}const Yt={lFrame:Sd(null),bindingsEnabled:!0};function zh(){return Yt.bindingsEnabled}function Ge(){return Yt.lFrame.lView}function Xn(){return Yt.lFrame.tView}function Ua(n){return Yt.lFrame.contextLView=n,n[xi]}function _u(n){return Yt.lFrame.contextLView=null,n}function or(){let n=vd();for(;null!==n&&64===n.type;)n=n.parent;return n}function vd(){return Yt.lFrame.currentTNode}function Gr(n,r){const o=Yt.lFrame;o.currentTNode=n,o.isParent=r}function Ba(){return Yt.lFrame.isParent}function K(){return Yt.lFrame.bindingIndex++}function xd(n,r){const o=Yt.lFrame;o.bindingIndex=o.bindingRootIndex=n,Md(r)}function Md(n){Yt.lFrame.currentDirectiveIndex=n}function Ml(){return Yt.lFrame.currentQueryIndex}function bd(n){Yt.lFrame.currentQueryIndex=n}function yu(n){const r=n[Rt];return 2===r.type?r.declTNode:1===r.type?n[Wi]:null}function bl(n,r,o){if(o&Xe.SkipSelf){let p=r,g=n;for(;!(p=p.parent,null!==p||o&Xe.Host||(p=yu(g),null===p||(g=g[Pi],10&p.type))););if(null===p)return!1;r=p,n=g}const c=Yt.lFrame=xu();return c.currentTNode=r,c.lView=n,!0}function vu(n){const r=xu(),o=n[Rt];Yt.lFrame=r,r.currentTNode=o.firstChild,r.lView=n,r.tView=o,r.contextLView=n,r.bindingIndex=o.bindingStartIndex,r.inI18n=!1}function xu(){const n=Yt.lFrame,r=null===n?null:n.child;return null===r?Sd(n):r}function Sd(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function $h(){const n=Yt.lFrame;return Yt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Kn=$h;function Ds(){const n=$h();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ar(){return Yt.lFrame.selectedIndex}function fa(n){Yt.lFrame.selectedIndex=n}function _i(){const n=Yt.lFrame;return go(n.tView,n.selectedIndex)}function Mu(){Yt.lFrame.currentNamespace=mu}function B(){!function P(){Yt.lFrame.currentNamespace=null}()}function _e(n,r){for(let o=r.directiveStart,c=r.directiveEnd;o<c;o++){const g=n.data[o].type.prototype,{ngAfterContentInit:x,ngAfterContentChecked:w,ngAfterViewInit:I,ngAfterViewChecked:F,ngOnDestroy:W}=g;x&&(n.contentHooks??(n.contentHooks=[])).push(-o,x),w&&((n.contentHooks??(n.contentHooks=[])).push(o,w),(n.contentCheckHooks??(n.contentCheckHooks=[])).push(o,w)),I&&(n.viewHooks??(n.viewHooks=[])).push(-o,I),F&&((n.viewHooks??(n.viewHooks=[])).push(o,F),(n.viewCheckHooks??(n.viewCheckHooks=[])).push(o,F)),null!=W&&(n.destroyHooks??(n.destroyHooks=[])).push(o,W)}}function Ae(n,r,o){Si(n,r,3,o)}function Ht(n,r,o,c){(3&n[mn])===o&&Si(n,r,o,c)}function Qn(n,r){let o=n[mn];(3&o)===r&&(o&=2047,o+=1,n[mn]=o)}function Si(n,r,o,c){const g=c??-1,x=r.length-1;let w=0;for(let I=void 0!==c?65535&n[fs]:0;I<x;I++)if("number"==typeof r[I+1]){if(w=r[I],null!=c&&w>=c)break}else r[I]<0&&(n[fs]+=65536),(w<g||-1==g)&&(gn(n,o,r,I),n[fs]=(4294901760&n[fs])+I+2),I++}function gn(n,r,o,c){const p=o[c]<0,g=o[c+1],w=n[p?-o[c]:o[c]];if(p){if(n[mn]>>11<n[fs]>>16&&(3&n[mn])===r){n[mn]+=2048,ks(4,w,g);try{g.call(w)}finally{ks(5,w,g)}}}else{ks(4,w,g);try{g.call(w)}finally{ks(5,w,g)}}}const _n=-1;class Yn{constructor(r,o,c){this.factory=r,this.resolving=!1,this.canSeeViewProviders=o,this.injectImpl=c}}function vs(n,r,o){let c=0;for(;c<o.length;){const p=o[c];if("number"==typeof p){if(0!==p)break;c++;const g=o[c++],x=o[c++],w=o[c++];n.setAttribute(r,x,w,g)}else{const g=p,x=o[++c];ka(g)?n.setProperty(r,g,x):n.setAttribute(r,g,x),c++}}return c}function bu(n){return 3===n||4===n||6===n}function ka(n){return 64===n.charCodeAt(0)}function pa(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let o=-1;for(let c=0;c<r.length;c++){const p=r[c];"number"==typeof p?o=p:0===o||jh(n,o,p,null,-1===o||2===o?r[++c]:null)}}return n}function jh(n,r,o,c,p){let g=0,x=n.length;if(-1===r)x=-1;else for(;g<n.length;){const w=n[g++];if("number"==typeof w){if(w===r){x=-1;break}if(w>r){x=g-1;break}}}for(;g<n.length;){const w=n[g];if("number"==typeof w)break;if(w===o){if(null===c)return void(null!==p&&(n[g+1]=p));if(c===n[g+1])return void(n[g+2]=p)}g++,null!==c&&g++,null!==p&&g++}-1!==x&&(n.splice(x,0,r),g=x+1),n.splice(g++,0,o),null!==c&&n.splice(g++,0,c),null!==p&&n.splice(g++,0,p)}function Su(n){return n!==_n}function Eu(n){return 32767&n}function vo(n,r){let o=function Wr(n){return n>>16}(n),c=r;for(;o>0;)c=c[Pi],o--;return c}let Sl=!0;function El(n){const r=Sl;return Sl=n,r}const Ed=255,Cl=5;let Is=0;const rs={};function ma(n,r){const o=Xh(n,r);if(-1!==o)return o;const c=r[Rt];c.firstCreatePass&&(n.injectorIndex=r.length,zs(c.data,n),zs(r,null),zs(c.blueprint,null));const p=yc(n,r),g=n.injectorIndex;if(Su(p)){const x=Eu(p),w=vo(p,r),I=w[Rt].data;for(let F=0;F<8;F++)r[g+F]=w[x+F]|I[x+F]}return r[g+8]=p,g}function zs(n,r){n.push(0,0,0,0,0,0,0,0,r)}function Xh(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function yc(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let o=0,c=null,p=r;for(;null!==p;){if(c=xc(p),null===c)return _n;if(o++,p=p[Pi],-1!==c.injectorIndex)return c.injectorIndex|o<<16}return _n}function No(n,r,o){!function yn(n,r,o){let c;"string"==typeof o?c=o.charCodeAt(0)||0:o.hasOwnProperty(ra)&&(c=o[ra]),null==c&&(c=o[ra]=Is++);const p=c&Ed;r.data[n+(p>>Cl)]|=1<<p}(n,r,o)}function Cr(n,r,o){if(o&Xe.Optional||void 0!==n)return n;Os()}function Tl(n,r,o,c){if(o&Xe.Optional&&void 0===c&&(c=null),!(o&(Xe.Self|Xe.Host))){const p=n[fl],g=qi(void 0);try{return p?p.get(r,c,o&Xe.Optional):xr(r,c,o&Xe.Optional)}finally{qi(g)}}return Cr(c,0,o)}function Yh(n,r,o,c=Xe.Default,p){if(null!==n){if(1024&r[mn]){const x=function Td(n,r,o,c,p){let g=n,x=r;for(;null!==g&&null!==x&&1024&x[mn]&&!(256&x[mn]);){const w=Lo(g,x,o,c|Xe.Self,rs);if(w!==rs)return w;let I=g.parent;if(!I){const F=x[Na];if(F){const W=F.get(o,rs,c);if(W!==rs)return W}I=xc(x),x=x[Pi]}g=I}return p}(n,r,o,c,rs);if(x!==rs)return x}const g=Lo(n,r,o,c,rs);if(g!==rs)return g}return Tl(r,o,c,p)}function Lo(n,r,o,c,p){const g=function vc(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(ra)?n[ra]:void 0;return"number"==typeof r?r>=0?r&Ed:Am:r}(o);if("function"==typeof g){if(!bl(r,n,c))return c&Xe.Host?Cr(p,0,c):Tl(r,o,c,p);try{const x=g(c);if(null!=x||c&Xe.Optional)return x;Os()}finally{Kn()}}else if("number"==typeof g){let x=null,w=Xh(n,r),I=_n,F=c&Xe.Host?r[Gi][Wi]:null;for((-1===w||c&Xe.SkipSelf)&&(I=-1===w?yc(n,r):r[w+8],I!==_n&&wu(c,!1)?(x=r[Rt],w=Eu(I),r=vo(I,r)):w=-1);-1!==w;){const W=r[Rt];if(Oo(g,w,W.data)){const J=Al(w,r,o,x,c,F);if(J!==rs)return J}I=r[w+8],I!==_n&&wu(c,r[Rt].data[w+8]===F)&&Oo(g,w,r)?(x=W,w=Eu(I),r=vo(I,r)):w=-1}}return p}function Al(n,r,o,c,p,g){const x=r[Rt],w=x.data[n+8],W=Va(w,x,o,null==c?Ts(w)&&Sl:c!=x&&0!=(3&w.type),p&Xe.Host&&g===w);return null!==W?Ha(r,x,W,w):rs}function Va(n,r,o,c,p){const g=n.providerIndexes,x=r.data,w=1048575&g,I=n.directiveStart,W=g>>20,le=p?w+W:n.directiveEnd;for(let pe=c?w:w+W;pe<le;pe++){const Pe=x[pe];if(pe<I&&o===Pe||pe>=I&&Pe.type===o)return pe}if(p){const pe=x[I];if(pe&&Sr(pe)&&pe.type===o)return I}return null}function Ha(n,r,o,c){let p=n[o];const g=r.data;if(function ai(n){return n instanceof Yn}(p)){const x=p;x.resolving&&function un(n,r){const o=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new He(-200,`Circular dependency in DI detected for ${n}${o}`)}(function gt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Fe(n)}(g[o]));const w=El(x.canSeeViewProviders);x.resolving=!0;const I=x.injectImpl?qi(x.injectImpl):null;bl(n,c,Xe.Default);try{p=n[o]=x.factory(void 0,g,n,c),r.firstCreatePass&&o>=c.directiveStart&&function te(n,r,o){const{ngOnChanges:c,ngOnInit:p,ngDoCheck:g}=r.type.prototype;if(c){const x=gc(r);(o.preOrderHooks??(o.preOrderHooks=[])).push(n,x),(o.preOrderCheckHooks??(o.preOrderCheckHooks=[])).push(n,x)}p&&(o.preOrderHooks??(o.preOrderHooks=[])).push(0-n,p),g&&((o.preOrderHooks??(o.preOrderHooks=[])).push(n,g),(o.preOrderCheckHooks??(o.preOrderCheckHooks=[])).push(n,g))}(o,g[o],r)}finally{null!==I&&qi(I),El(w),x.resolving=!1,Kn()}}return p}function Oo(n,r,o){return!!(o[r+(n>>Cl)]&1<<n)}function wu(n,r){return!(n&Xe.Self||n&Xe.Host&&r)}class Fo{constructor(r,o){this._tNode=r,this._lView=o}get(r,o,c){return Yh(this._tNode,this._lView,r,Cn(c),o)}}function Am(){return new Fo(or(),Ge())}function Dm(n){return Un(()=>{const r=n.prototype.constructor,o=r[Bs]||Cd(r),c=Object.prototype;let p=Object.getPrototypeOf(n.prototype).constructor;for(;p&&p!==c;){const g=p[Bs]||Cd(p);if(g&&g!==o)return g;p=Object.getPrototypeOf(p)}return g=>new g})}function Cd(n){return wt(n)?()=>{const r=Cd(kt(n));return r&&r()}:Js(n)}function xc(n){const r=n[Rt],o=r.type;return 2===o?r.declTNode:1===o?n[Wi]:null}function ga(n){return function wd(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const o=n.attrs;if(o){const c=o.length;let p=0;for(;p<c;){const g=o[p];if(bu(g))break;if(0===g)p+=2;else if("number"==typeof g)for(p++;p<c&&"string"==typeof o[p];)p++;else{if(g===r)return o[p+1];p+=2}}}return null}(or(),n)}const xo="__parameters__";function Rs(n,r,o){return Un(()=>{const c=function Gs(n){return function(...o){if(n){const c=n(...o);for(const p in c)this[p]=c[p]}}}(r);function p(...g){if(this instanceof p)return c.apply(this,g),this;const x=new p(...g);return w.annotation=x,w;function w(I,F,W){const J=I.hasOwnProperty(xo)?I[xo]:Object.defineProperty(I,xo,{value:[]})[xo];for(;J.length<=W;)J.push(null);return(J[W]=J[W]||[]).push(x),I}}return o&&(p.prototype=Object.create(o.prototype)),p.prototype.ngMetadataName=n,p.annotationCls=p,p})}class yi{constructor(r,o){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof o?this.__NG_ELEMENT_ID__=o:void 0!==o&&(this.\u0275prov=In({token:this,providedIn:o.providedIn||"root",factory:o.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Wa(n,r){n.forEach(o=>Array.isArray(o)?Wa(o,r):r(o))}function Ws(n,r,o){r>=n.length?n.push(o):n.splice(r,0,o)}function Mo(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function li(n,r,o){let c=Ec(n,r);return c>=0?n[1|c]=o:(c=~c,function Tu(n,r,o,c){let p=n.length;if(p==r)n.push(o,c);else if(1===p)n.push(c,n[0]),n[0]=o;else{for(p--,n.push(n[p-1],n[p]);p>r;)n[p]=n[p-2],p--;n[r]=o,n[r+1]=c}}(n,c,r,o)),c}function Sc(n,r){const o=Ec(n,r);if(o>=0)return n[1|o]}function Ec(n,r){return function Pm(n,r,o){let c=0,p=n.length>>o;for(;p!==c;){const g=c+(p-c>>1),x=n[g<<o];if(r===x)return g<<o;x>r?p=g:c=g+1}return~(p<<o)}(n,r,1)}const $r=Qr(Rs("Optional"),8),Uo=Qr(Rs("SkipSelf"),4);var jr=(()=>((jr=jr||{})[jr.Important=1]="Important",jr[jr.DashCase=2]="DashCase",jr))();const Bd=new Map;let Pu=0;const Dc="__ngContext__";function as(n,r){ms(r)?(n[Dc]=r[Io],function Ol(n){Bd.set(n[Io],n)}(r)):n[Dc]=r}let Vd;function Nc(n,r){return Vd(n,r)}function Lc(n){const r=n[Ri];return rr(r)?r[Ri]:r}function zd(n){return lf(n[aa])}function bo(n){return lf(n[Ci])}function lf(n){for(;null!==n&&!rr(n);)n=n[Ci];return n}function Ul(n,r,o,c,p){if(null!=c){let g,x=!1;rr(c)?g=c:ms(c)&&(x=!0,c=c[ds]);const w=Or(c);0===n&&null!==o?null==p?ro(r,o,w):Xr(r,o,w,p||null,!0):1===n&&null!==o?Xr(r,o,w,p||null,!0):2===n?function kc(n,r,o){const c=Vl(n,r);c&&function Wd(n,r,o,c){n.removeChild(r,o,c)}(n,c,r,o)}(r,w,x):3===n&&r.destroyNode(w),null!=g&&function yp(n,r,o,c,p){const g=o[Sn];g!==Or(o)&&Ul(r,n,c,g,p);for(let w=ir;w<o.length;w++){const I=o[w];xa(I[Rt],I,n,r,c,g)}}(r,n,g,o,p)}}function Lu(n,r,o){return n.createElement(r,o)}function Fu(n,r){const o=n[ml],c=o.indexOf(r),p=r[Ri];512&r[mn]&&(r[mn]&=-513,Vs(p,-1)),o.splice(c,1)}function Vr(n,r){if(n.length<=ir)return;const o=ir+r,c=n[o];if(c){const p=c[Ji];null!==p&&p!==n&&Fu(p,c),r>0&&(n[o-1][Ci]=c[Ci]);const g=Mo(n,ir+r);!function Gd(n,r){xa(n,r,r[dn],2,null,null),r[ds]=null,r[Wi]=null}(c[Rt],c);const x=g[ps];null!==x&&x.detachView(g[Rt]),c[Ri]=null,c[Ci]=null,c[mn]&=-65}return c}function va(n,r){if(!(128&r[mn])){const o=r[dn];o.destroyNode&&xa(n,r,o,3,null,null),function Bl(n){let r=n[aa];if(!r)return Vo(n[Rt],n);for(;r;){let o=null;if(ms(r))o=r[aa];else{const c=r[ir];c&&(o=c)}if(!o){for(;r&&!r[Ci]&&r!==n;)ms(r)&&Vo(r[Rt],r),r=r[Ri];null===r&&(r=n),ms(r)&&Vo(r[Rt],r),o=r&&r[Ci]}r=o}}(r)}}function Vo(n,r){if(!(128&r[mn])){r[mn]&=-65,r[mn]|=128,function gp(n,r){let o;if(null!=n&&null!=(o=n.destroyHooks))for(let c=0;c<o.length;c+=2){const p=r[o[c]];if(!(p instanceof Yn)){const g=o[c+1];if(Array.isArray(g))for(let x=0;x<g.length;x+=2){const w=p[g[x]],I=g[x+1];ks(4,w,I);try{I.call(w)}finally{ks(5,w,I)}}else{ks(4,p,g);try{g.call(p)}finally{ks(5,p,g)}}}}}(n,r),function Fc(n,r){const o=n.cleanup,c=r[br];let p=-1;if(null!==o)for(let g=0;g<o.length-1;g+=2)if("string"==typeof o[g]){const x=o[g+3];x>=0?c[p=x]():c[p=-x].unsubscribe(),g+=2}else{const x=c[p=o[g+1]];o[g].call(x)}if(null!==c){for(let g=p+1;g<c.length;g++)(0,c[g])();r[br]=null}}(n,r),1===r[Rt].type&&r[dn].destroy();const o=r[Ji];if(null!==o&&rr(r[Ri])){o!==r[Ri]&&Fu(o,r);const c=r[ps];null!==c&&c.detachView(n)}!function ja(n){Bd.delete(n[Io])}(r)}}function Uc(n,r,o){return function kl(n,r,o){let c=r;for(;null!==c&&40&c.type;)c=(r=c).parent;if(null===c)return o[ds];{const{componentOffset:p}=c;if(p>-1){const{encapsulation:g}=n.data[c.directiveStart+p];if(g===us.None||g===us.Emulated)return null}return gs(c,o)}}(n,r.parent,o)}function Xr(n,r,o,c,p){n.insertBefore(r,o,c,p)}function ro(n,r,o){n.appendChild(r,o)}function Uu(n,r,o,c,p){null!==c?Xr(n,r,o,c,p):ro(n,r,o)}function Vl(n,r){return n.parentNode(r)}let uf,Xd,zl,$d=function cf(n,r,o){return 40&n.type?gs(n,o):null};function Eo(n,r,o,c){const p=Uc(n,c,r),g=r[dn],w=function ls(n,r,o){return $d(n,r,o)}(c.parent||r[Wi],c,r);if(null!=p)if(Array.isArray(o))for(let I=0;I<o.length;I++)Uu(g,p,o[I],w,!1);else Uu(g,p,o,w,!1);void 0!==uf&&uf(g,c,r,o,p)}function Ho(n,r){if(null!==r){const o=r.type;if(3&o)return gs(r,n);if(4&o)return Bu(-1,n[r.index]);if(8&o){const c=r.child;if(null!==c)return Ho(n,c);{const p=n[r.index];return rr(p)?Bu(-1,p):Or(p)}}if(32&o)return Nc(r,n)()||Or(n[r.index]);{const c=jd(n,r);return null!==c?Array.isArray(c)?c[0]:Ho(Lc(n[Gi]),c):Ho(n,r.next)}}return null}function jd(n,r){return null!==r?n[Gi][Wi].projection[r.projection]:null}function Bu(n,r){const o=ir+n+1;if(o<r.length){const c=r[o],p=c[Rt].firstChild;if(null!==p)return Ho(c,p)}return r[Sn]}function Ir(n,r,o,c,p,g,x){for(;null!=o;){const w=c[o.index],I=o.type;if(x&&0===r&&(w&&as(Or(w),c),o.flags|=2),32!=(32&o.flags))if(8&I)Ir(n,r,o.child,c,p,g,!1),Ul(r,n,p,w,g);else if(32&I){const F=Nc(o,c);let W;for(;W=F();)Ul(r,n,p,W,g);Ul(r,n,p,w,g)}else 16&I?wo(n,r,c,o,p,g):Ul(r,n,p,w,g);o=x?o.projectionNext:o.next}}function xa(n,r,o,c,p,g){Ir(o,c,n.firstChild,r,p,g,!1)}function wo(n,r,o,c,p,g){const x=o[Gi],I=x[Wi].projection[c.projection];if(Array.isArray(I))for(let F=0;F<I.length;F++)Ul(r,n,p,I[F],g);else Ir(n,r,I,x[Ri],p,g,!0)}function Rr(n,r,o){""===o?n.removeAttribute(r,"class"):n.setAttribute(r,"class",o)}function zo(n,r,o){const{mergedAttrs:c,classes:p,styles:g}=o;null!==c&&vs(n,r,c),null!==p&&Rr(n,r,p),null!==g&&function ku(n,r,o){n.setAttribute(r,"style",o)}(n,r,g)}function Wu(n){Xd=n}function qd(n){return function hf(){if(void 0===zl&&(zl=null,Ln.trustedTypes))try{zl=Ln.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return zl}()?.createScriptURL(n)||n}class Zd{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ti})`}}function Gl(n){return n instanceof Zd?n.changingThisBreaksApplicationSecurity:n}function Vc(n,r){const o=function Kd(n){return n instanceof Zd&&n.getTypeName()||null}(n);if(null!=o&&o!==r){if("ResourceURL"===o&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${o} (see ${ti})`)}return o===r}const ju=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var tr=(()=>((tr=tr||{})[tr.NONE=0]="NONE",tr[tr.HTML=1]="HTML",tr[tr.STYLE=2]="STYLE",tr[tr.SCRIPT=3]="SCRIPT",tr[tr.URL=4]="URL",tr[tr.RESOURCE_URL=5]="RESOURCE_URL",tr))();function Ku(n){const r=so();return r?r.sanitize(tr.URL,n)||"":Vc(n,"URL")?Gl(n):function Wc(n){return(n=String(n)).match(ju)?n:"unsafe:"+n}(Fe(n))}function gf(n){const r=so();if(r)return qd(r.sanitize(tr.RESOURCE_URL,n)||"");if(Vc(n,"ResourceURL"))return qd(Gl(n));throw new He(904,!1)}function Xl(n,r,o){return function Ep(n,r){return"src"===r&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===r&&("base"===n||"link"===n)?gf:Ku}(r,o)(n)}function so(){const n=Ge();return n&&n[oa]}const qa=new yi("ENVIRONMENT_INITIALIZER"),vf=new yi("INJECTOR",-1),Zm=new yi("INJECTOR_DEF_TYPES");class wp{get(r,o=mi){if(o===mi){const c=new Error(`NullInjectorError: No provider for ${Xt(r)}!`);throw c.name="NullInjectorError",c}return o}}function Cp(n){return{\u0275providers:n}}function A_(...n){return{\u0275providers:Km(0,n),\u0275fromNgModule:!0}}function Km(n,...r){const o=[],c=new Set;let p;return Wa(r,g=>{const x=g;Tp(x,o,[],c)&&(p||(p=[]),p.push(x))}),void 0!==p&&Jm(p,o),o}function Jm(n,r){for(let o=0;o<n.length;o++){const{providers:p}=n[o];rh(p,g=>{r.push(g)})}}function Tp(n,r,o,c){if(!(n=kt(n)))return!1;let p=null,g=lu(n);const x=!g&&Zn(n);if(g||x){if(x&&!x.standalone)return!1;p=n}else{const I=n.ngModule;if(g=lu(I),!g)return!1;p=I}const w=c.has(p);if(x){if(w)return!1;if(c.add(p),x.dependencies){const I="function"==typeof x.dependencies?x.dependencies():x.dependencies;for(const F of I)Tp(F,r,o,c)}}else{if(!g)return!1;{if(null!=g.imports&&!w){let F;c.add(p);try{Wa(g.imports,W=>{Tp(W,r,o,c)&&(F||(F=[]),F.push(W))})}finally{}void 0!==F&&Jm(F,r)}if(!w){const F=Js(p)||(()=>new p);r.push({provide:p,useFactory:F,deps:on},{provide:Zm,useValue:p,multi:!0},{provide:qa,useValue:()=>Ut(p),multi:!0})}const I=g.providers;null==I||w||rh(I,W=>{r.push(W)})}}return p!==n&&void 0!==n.providers}function rh(n,r){for(let o of n)dt(o)&&(o=o.\u0275providers),Array.isArray(o)?rh(o,r):r(o)}const Qm=nt({provide:String,useValue:nt});function Yc(n){return null!==n&&"object"==typeof n&&Qm in n}function Co(n){return"function"==typeof n}const Vi=new yi("Set Injector scope."),Za={},bf={};let qc;function Ka(){return void 0===qc&&(qc=new wp),qc}class Yl{}class ql extends Yl{get destroyed(){return this._destroyed}constructor(r,o,c,p){super(),this.parent=o,this.source=c,this.scopes=p,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Kc(r,x=>this.processProvider(x)),this.records.set(vf,Wo(void 0,this)),p.has("environment")&&this.records.set(Yl,Wo(void 0,this));const g=this.records.get(Vi);null!=g&&"string"==typeof g.value&&this.scopes.add(g.value),this.injectorDefTypes=new Set(this.get(Zm.multi,on,Xe.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();for(const r of this._onDestroyHooks)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(r){this._onDestroyHooks.push(r)}runInContext(r){this.assertNotDestroyed();const o=We(this),c=qi(void 0);try{return r()}finally{We(o),qi(c)}}get(r,o=mi,c=Xe.Default){this.assertNotDestroyed(),c=Cn(c);const p=We(this),g=qi(void 0);try{if(!(c&Xe.SkipSelf)){let w=this.records.get(r);if(void 0===w){const I=function $o(n){return"function"==typeof n||"object"==typeof n&&n instanceof yi}(r)&&pi(r);w=I&&this.injectableDefInScope(I)?Wo(Ju(r),Za):null,this.records.set(r,w)}if(null!=w)return this.hydrate(r,w)}return(c&Xe.Self?Ka():this.parent).get(r,o=c&Xe.Optional&&o===mi?null:o)}catch(x){if("NullInjectorError"===x.name){if((x[ta]=x[ta]||[]).unshift(Xt(r)),p)throw x;return function ii(n,r,o,c){const p=n[ta];throw r[oe]&&p.unshift(r[oe]),n.message=function _t(n,r,o,c=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==Oe?n.slice(2):n;let p=Xt(r);if(Array.isArray(r))p=r.map(Xt).join(" -> ");else if("object"==typeof r){let g=[];for(let x in r)if(r.hasOwnProperty(x)){let w=r[x];g.push(x+":"+("string"==typeof w?JSON.stringify(w):Xt(w)))}p=`{${g.join(", ")}}`}return`${o}${c?"("+c+")":""}[${p}]: ${n.replace(na,"\n  ")}`}("\n"+n.message,p,o,c),n[dr]=p,n[ta]=null,n}(x,r,"R3InjectorError",this.source)}throw x}finally{qi(g),We(p)}}resolveInjectorInitializers(){const r=We(this),o=qi(void 0);try{const c=this.get(qa.multi,on,Xe.Self);for(const p of c)p()}finally{We(r),qi(o)}}toString(){const r=[],o=this.records;for(const c of o.keys())r.push(Xt(c));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new He(205,!1)}processProvider(r){let o=Co(r=kt(r))?r:kt(r&&r.provide);const c=function Sf(n){return Yc(n)?Wo(void 0,n.useValue):Wo(Zc(n),Za)}(r);if(Co(r)||!0!==r.multi)this.records.get(o);else{let p=this.records.get(o);p||(p=Wo(void 0,Za,!0),p.factory=()=>si(p.multi),this.records.set(o,p)),o=r,p.multi.push(r)}this.records.set(o,c)}hydrate(r,o){return o.value===Za&&(o.value=bf,o.value=o.factory()),"object"==typeof o.value&&o.value&&function Ef(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(o.value)&&this._ngOnDestroyHooks.add(o.value),o.value}injectableDefInScope(r){if(!r.providedIn)return!1;const o=kt(r.providedIn);return"string"==typeof o?"any"===o||this.scopes.has(o):this.injectorDefTypes.has(o)}}function Ju(n){const r=pi(n),o=null!==r?r.factory:Js(n);if(null!==o)return o;if(n instanceof yi)throw new He(204,!1);if(n instanceof Function)return function Dp(n){const r=n.length;if(r>0)throw function $s(n,r){const o=[];for(let c=0;c<n;c++)o.push(r);return o}(r,"?"),new He(204,!1);const o=function uc(n){return n&&(n[Qo]||n[dc])||null}(n);return null!==o?()=>o.factory(n):()=>new n}(n);throw new He(204,!1)}function Zc(n,r,o){let c;if(Co(n)){const p=kt(n);return Js(p)||Ju(p)}if(Yc(n))c=()=>kt(n.useValue);else if(function Mf(n){return!(!n||!n.useFactory)}(n))c=()=>n.useFactory(...si(n.deps||[]));else if(function xf(n){return!(!n||!n.useExisting)}(n))c=()=>Ut(kt(n.useExisting));else{const p=kt(n&&(n.useClass||n.provide));if(!function eg(n){return!!n.deps}(n))return Js(p)||Ju(p);c=()=>new p(...si(n.deps))}return c}function Wo(n,r,o=!1){return{factory:n,value:r,multi:o?[]:void 0}}function Kc(n,r){for(const o of n)Array.isArray(o)?Kc(o,r):o&&dt(o)?Kc(o.\u0275providers,r):r(o)}class wf{}class sh{}class Tf{resolveComponentFactory(r){throw function Ip(n){const r=Error(`No component factory found for ${Xt(n)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=n,r}(r)}}let jo=(()=>{class n{}return n.NULL=new Tf,n})();function Qu(){return Ja(or(),Ge())}function Ja(n,r){return new Qa(gs(n,r))}let Qa=(()=>{class n{constructor(o){this.nativeElement=o}}return n.__NG_ELEMENT_ID__=Qu,n})();function tg(n){return n instanceof Qa?n.nativeElement:n}class Jc{}let ed=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Af(){const n=Ge(),o=sr(or().index,n);return(ms(o)?o:n)[dn]}(),n})(),oh=(()=>{class n{}return n.\u0275prov=In({token:n,providedIn:"root",factory:()=>null}),n})();class td{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const el=new td("15.2.10"),ah={},nd="ngOriginalError";function lh(n){return n[nd]}class Qc{constructor(){this._console=console}handleError(r){const o=this._findOriginalError(r);this._console.error("ERROR",r),o&&this._console.error("ORIGINAL ERROR",o)}_findOriginalError(r){let o=r&&lh(r);for(;o&&lh(o);)o=lh(o);return o||null}}function If(n){return n.ownerDocument.defaultView}function Xo(n){return n instanceof Function?n():n}function Lp(n,r,o){let c=n.length;for(;;){const p=n.indexOf(r,o);if(-1===p)return p;if(0===p||n.charCodeAt(p-1)<=32){const g=r.length;if(p+g===c||n.charCodeAt(p+g)<=32)return p}o=p+1}}const P_="ng-template";function Lf(n,r,o){let c=0,p=!0;for(;c<n.length;){let g=n[c++];if("string"==typeof g&&p){const x=n[c++];if(o&&"class"===g&&-1!==Lp(x.toLowerCase(),r,0))return!0}else{if(1===g){for(;c<n.length&&"string"==typeof(g=n[c++]);)if(g.toLowerCase()===r)return!0;return!1}"number"==typeof g&&(p=!1)}}return!1}function og(n){return 4===n.type&&n.value!==P_}function ag(n,r,o){return r===(4!==n.type||o?n.value:P_)}function N_(n,r,o){let c=4;const p=n.attrs||[],g=function lg(n){for(let r=0;r<n.length;r++)if(bu(n[r]))return r;return n.length}(p);let x=!1;for(let w=0;w<r.length;w++){const I=r[w];if("number"!=typeof I){if(!x)if(4&c){if(c=2|1&c,""!==I&&!ag(n,I,o)||""===I&&1===r.length){if(mr(c))return!1;x=!0}}else{const F=8&c?I:r[++w];if(8&c&&null!==n.attrs){if(!Lf(n.attrs,F,o)){if(mr(c))return!1;x=!0}continue}const J=id(8&c?"class":I,p,og(n),o);if(-1===J){if(mr(c))return!1;x=!0;continue}if(""!==F){let le;le=J>g?"":p[J+1].toLowerCase();const pe=8&c?le:null;if(pe&&-1!==Lp(pe,F,0)||2&c&&F!==le){if(mr(c))return!1;x=!0}}}}else{if(!x&&!mr(c)&&!mr(I))return!1;if(x&&mr(I))continue;x=!1,c=I|1&c}}return mr(c)||x}function mr(n){return 0==(1&n)}function id(n,r,o,c){if(null===r)return-1;let p=0;if(c||!o){let g=!1;for(;p<r.length;){const x=r[p];if(x===n)return p;if(3===x||6===x)g=!0;else{if(1===x||2===x){let w=r[++p];for(;"string"==typeof w;)w=r[++p];continue}if(4===x)break;if(0===x){p+=4;continue}}p+=g?1:2}return-1}return function uh(n,r){let o=n.indexOf(4);if(o>-1)for(o++;o<n.length;){const c=n[o];if("number"==typeof c)return-1;if(c===r)return o;o++}return-1}(r,n)}function Op(n,r,o=!1){for(let c=0;c<r.length;c++)if(N_(n,r[c],o))return!0;return!1}function rd(n,r){return n?":not("+r.trim()+")":r}function dh(n){let r=n[0],o=1,c=2,p="",g=!1;for(;o<n.length;){let x=n[o];if("string"==typeof x)if(2&c){const w=n[++o];p+="["+x+(w.length>0?'="'+w+'"':"")+"]"}else 8&c?p+="."+x:4&c&&(p+=" "+x);else""!==p&&!mr(x)&&(r+=rd(g,p),p=""),c=x,g=g||!mr(c);o++}return""!==p&&(r+=rd(g,p)),r}const u={};function _(n){S(Xn(),Ge(),ar()+n,!1)}function S(n,r,o,c){if(!c)if(3==(3&r[mn])){const g=n.preOrderCheckHooks;null!==g&&Ae(r,g,o)}else{const g=n.preOrderHooks;null!==g&&Ht(r,g,0,o)}fa(o)}function Sa(n,r=null,o=null,c){const p=Kl(n,r,o,c);return p.resolveInjectorInitializers(),p}function Kl(n,r=null,o=null,c,p=new Set){const g=[o||on,A_(n)];return c=c||("object"==typeof n?void 0:Xt(n)),new ql(g,r||Ka(),c||null,p)}let Hr=(()=>{class n{static create(o,c){if(Array.isArray(o))return Sa({name:""},c,o,"");{const p=o.name??"";return Sa({name:p},o.parent,o.providers,p)}}}return n.THROW_IF_NOT_FOUND=mi,n.NULL=new wp,n.\u0275prov=In({token:n,providedIn:"any",factory:()=>Ut(vf)}),n.__NG_ELEMENT_ID__=-1,n})();function Of(n,r=Xe.Default){const o=Ge();return null===o?Ut(n,r):Yh(or(),o,kt(n),r)}function hg(){throw new Error("invalid")}function iu(n,r){const o=n.contentQueries;if(null!==o)for(let c=0;c<o.length;c+=2){const g=o[c+1];if(-1!==g){const x=n.data[g];bd(o[c]),x.contentQueries(2,r[g],g)}}}function kp(n,r,o,c,p,g,x,w,I,F,W){const J=r.blueprint.slice();return J[ds]=p,J[mn]=76|c,(null!==W||n&&1024&n[mn])&&(J[mn]|=1024),Ro(J),J[Ri]=J[Pi]=n,J[xi]=o,J[es]=x||n&&n[es],J[dn]=w||n&&n[dn],J[oa]=I||n&&n[oa]||null,J[fl]=F||n&&n[fl]||null,J[Wi]=g,J[Io]=function kd(){return Pu++}(),J[Na]=W,J[Gi]=2==r.type?n[Gi]:J,J}function Yo(n,r,o,c,p){let g=n.data[r];if(null===g)g=function Ff(n,r,o,c,p){const g=vd(),x=Ba(),I=n.data[r]=function fg(n,r,o,c,p,g){return{type:o,index:c,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:p,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,x?g:g&&g.parent,o,r,c,p);return null===n.firstChild&&(n.firstChild=I),null!==g&&(x?null==g.child&&null!==I.parent&&(g.child=I):null===g.next&&(g.next=I,I.prev=g)),I}(n,r,o,c,p),function Gh(){return Yt.lFrame.inI18n}()&&(g.flags|=32);else if(64&g.type){g.type=o,g.value=c,g.attrs=p;const x=function Po(){const n=Yt.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();g.injectorIndex=null===x?-1:x.injectorIndex}return Gr(g,!0),g}function Uf(n,r,o,c){if(0===o)return-1;const p=r.length;for(let g=0;g<o;g++)r.push(c),n.blueprint.push(c),n.data.push(null);return p}function Ql(n,r,o){vu(r);try{const c=n.viewQuery;null!==c&&_g(1,c,o);const p=n.template;null!==p&&s0(n,r,p,1,o),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&iu(n,r),n.staticViewQueries&&_g(2,n.viewQuery,o);const g=n.components;null!==g&&function r0(n,r){for(let o=0;o<r.length;o++)jM(n,r[o])}(r,g)}catch(c){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),c}finally{r[mn]&=-5,Ds()}}function tl(n,r,o,c){const p=r[mn];if(128!=(128&p)){vu(r);try{Ro(r),function wr(n){return Yt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==o&&s0(n,r,o,2,c);const x=3==(3&p);if(x){const F=n.preOrderCheckHooks;null!==F&&Ae(r,F,null)}else{const F=n.preOrderHooks;null!==F&&Ht(r,F,0,null),Qn(r,0)}if(function $M(n){for(let r=zd(n);null!==r;r=bo(r)){if(!r[Oa])continue;const o=r[ml];for(let c=0;c<o.length;c++){const p=o[c];512&p[mn]||Vs(p[Ri],1),p[mn]|=512}}}(r),function ny(n){for(let r=zd(n);null!==r;r=bo(r))for(let o=ir;o<r.length;o++){const c=r[o],p=c[Rt];_o(c)&&tl(p,c,p.template,c[xi])}}(r),null!==n.contentQueries&&iu(n,r),x){const F=n.contentCheckHooks;null!==F&&Ae(r,F)}else{const F=n.contentHooks;null!==F&&Ht(r,F,1),Qn(r,1)}!function X_(n,r){const o=n.hostBindingOpCodes;if(null!==o)try{for(let c=0;c<o.length;c++){const p=o[c];if(p<0)fa(~p);else{const g=p,x=o[++c],w=o[++c];xd(x,g),w(2,r[g])}}}finally{fa(-1)}}(n,r);const w=n.components;null!==w&&function OM(n,r){for(let o=0;o<r.length;o++)iy(n,r[o])}(r,w);const I=n.viewQuery;if(null!==I&&_g(2,I,c),x){const F=n.viewCheckHooks;null!==F&&Ae(r,F)}else{const F=n.viewHooks;null!==F&&Ht(r,F,2),Qn(r,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),r[mn]&=-41,512&r[mn]&&(r[mn]&=-513,Vs(r[Ri],-1))}finally{Ds()}}}function s0(n,r,o,c,p){const g=ar(),x=2&c;try{fa(-1),x&&r.length>oi&&S(n,r,oi,!1),ks(x?2:0,p),o(c,p)}finally{fa(g),ks(x?3:1,p)}}function Y_(n,r,o){if(hu(r)){const p=r.directiveEnd;for(let g=r.directiveStart;g<p;g++){const x=n.data[g];x.contentQueries&&x.contentQueries(1,o[g],g)}}}function ec(n,r,o){zh()&&(function u0(n,r,o,c){const p=o.directiveStart,g=o.directiveEnd;Ts(o)&&function ey(n,r,o){const c=gs(r,n),p=q_(o),g=n[es],x=od(n,kp(n,p,null,o.onPush?32:16,c,r,g,g.createRenderer(c,o),null,null,null));n[r.index]=x}(r,o,n.data[p+o.componentOffset]),n.firstCreatePass||ma(o,r),as(c,r);const x=o.initialInputs;for(let w=p;w<g;w++){const I=n.data[w],F=Ha(r,n,w,o);as(F,r),null!==x&&gg(0,w-p,F,I,0,x),Sr(I)&&(sr(o.index,r)[xi]=Ha(r,n,w,o))}}(n,r,o,gs(o,r)),64==(64&o.flags)&&Q_(n,r,o))}function Vp(n,r,o=gs){const c=r.localNames;if(null!==c){let p=r.index+1;for(let g=0;g<c.length;g+=2){const x=c[g+1],w=-1===x?o(r,n):n[x];n[p++]=w}}}function q_(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=tc(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):r}function tc(n,r,o,c,p,g,x,w,I,F){const W=oi+c,J=W+p,le=function FM(n,r){const o=[];for(let c=0;c<r;c++)o.push(c<n?null:u);return o}(W,J),pe="function"==typeof F?F():F;return le[Rt]={type:n,blueprint:le,template:o,queries:null,viewQuery:w,declTNode:r,data:le.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:J,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof x?x():x,firstChild:null,schemas:I,consts:pe,incompleteFirstPass:!1}}function Z_(n,r,o,c){const p=oy(r);null===o?p.push(c):(p.push(o),n.firstCreatePass&&yg(n).push(c,p.length-1))}function K_(n,r,o,c){for(let p in n)if(n.hasOwnProperty(p)){o=null===o?{}:o;const g=n[p];null===c?Hp(o,r,p,g):c.hasOwnProperty(p)&&Hp(o,r,c[p],g)}return o}function Hp(n,r,o,c){n.hasOwnProperty(o)?n[o].push(r,c):n[o]=[r,c]}function pg(n,r,o,c){if(zh()){const p=null===c?null:{"":-1},g=function HM(n,r){const o=n.directiveRegistry;let c=null,p=null;if(o)for(let g=0;g<o.length;g++){const x=o[g];if(Op(r,x.selectors,!1))if(c||(c=[]),Sr(x))if(null!==x.findHostDirectiveDefs){const w=[];p=p||new Map,x.findHostDirectiveDefs(x,w,p),c.unshift(...w,x),zp(n,r,w.length)}else c.unshift(x),zp(n,r,0);else p=p||new Map,x.findHostDirectiveDefs?.(x,c,p),c.push(x)}return null===c?null:[c,p]}(n,o);let x,w;null===g?x=w=null:[x,w]=g,null!==x&&J_(n,r,o,x,p,w),p&&function d0(n,r,o){if(r){const c=n.localNames=[];for(let p=0;p<r.length;p+=2){const g=o[r[p+1]];if(null==g)throw new He(-301,!1);c.push(r[p],g)}}}(o,c,p)}o.mergedAttrs=pa(o.mergedAttrs,o.attrs)}function J_(n,r,o,c,p,g){for(let F=0;F<c.length;F++)No(ma(o,r),n,c[F].type);!function mg(n,r,o){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+o,n.providerIndexes=r}(o,n.data.length,c.length);for(let F=0;F<c.length;F++){const W=c[F];W.providersResolver&&W.providersResolver(W)}let x=!1,w=!1,I=Uf(n,r,c.length,null);for(let F=0;F<c.length;F++){const W=c[F];o.mergedAttrs=pa(o.mergedAttrs,W.hostAttrs),GM(n,o,r,I,W),zM(I,W,p),null!==W.contentQueries&&(o.flags|=4),(null!==W.hostBindings||null!==W.hostAttrs||0!==W.hostVars)&&(o.flags|=64);const J=W.type.prototype;!x&&(J.ngOnChanges||J.ngOnInit||J.ngDoCheck)&&((n.preOrderHooks??(n.preOrderHooks=[])).push(o.index),x=!0),!w&&(J.ngOnChanges||J.ngDoCheck)&&((n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(o.index),w=!0),I++}!function o0(n,r,o){const p=r.directiveEnd,g=n.data,x=r.attrs,w=[];let I=null,F=null;for(let W=r.directiveStart;W<p;W++){const J=g[W],le=o?o.get(J):null,Pe=le?le.outputs:null;I=K_(J.inputs,W,I,le?le.inputs:null),F=K_(J.outputs,W,F,Pe);const rt=null===I||null===x||og(r)?null:WM(I,W,x);w.push(rt)}null!==I&&(I.hasOwnProperty("class")&&(r.flags|=8),I.hasOwnProperty("style")&&(r.flags|=16)),r.initialInputs=w,r.inputs=I,r.outputs=F}(n,o,g)}function Q_(n,r,o){const c=o.directiveStart,p=o.directiveEnd,g=o.index,x=function Wh(){return Yt.lFrame.currentDirectiveIndex}();try{fa(g);for(let w=c;w<p;w++){const I=n.data[w],F=r[w];Md(w),(null!==I.hostBindings||0!==I.hostVars||null!==I.hostAttrs)&&VM(I,F)}}finally{fa(-1),Md(x)}}function VM(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function zp(n,r,o){r.componentOffset=o,(n.components??(n.components=[])).push(r.index)}function zM(n,r,o){if(o){if(r.exportAs)for(let c=0;c<r.exportAs.length;c++)o[r.exportAs[c]]=n;Sr(r)&&(o[""]=n)}}function GM(n,r,o,c,p){n.data[c]=p;const g=p.factory||(p.factory=Js(p.type)),x=new Yn(g,Sr(p),Of);n.blueprint[c]=x,o[c]=x,function Xi(n,r,o,c,p){const g=p.hostBindings;if(g){let x=n.hostBindingOpCodes;null===x&&(x=n.hostBindingOpCodes=[]);const w=~r.index;(function kM(n){let r=n.length;for(;r>0;){const o=n[--r];if("number"==typeof o&&o<0)return o}return 0})(x)!=w&&x.push(w),x.push(o,c,g)}}(n,r,c,Uf(n,o,p.hostVars,u),p)}function nc(n,r,o,c,p,g){const x=gs(n,r);!function Gp(n,r,o,c,p,g,x){if(null==g)n.removeAttribute(r,p,o);else{const w=null==x?Fe(g):x(g,c||"",p);n.setAttribute(r,p,w,o)}}(r[dn],x,g,n.value,o,c,p)}function gg(n,r,o,c,p,g){const x=g[r];if(null!==x){const w=c.setInput;for(let I=0;I<x.length;){const F=x[I++],W=x[I++],J=x[I++];null!==w?c.setInput(o,J,F,W):o[W]=J}}}function WM(n,r,o){let c=null,p=0;for(;p<o.length;){const g=o[p];if(0!==g)if(5!==g){if("number"==typeof g)break;if(n.hasOwnProperty(g)){null===c&&(c=[]);const x=n[g];for(let w=0;w<x.length;w+=2)if(x[w]===r){c.push(g,x[w+1],o[p+1]);break}}p+=2}else p+=2;else p+=4}return c}function ty(n,r,o,c){return[n,!0,!1,r,null,0,c,o,null,null]}function iy(n,r){const o=sr(r,n);if(_o(o)){const c=o[Rt];48&o[mn]?tl(c,o,c.template,o[xi]):o[hs]>0&&Wp(o)}}function Wp(n){for(let c=zd(n);null!==c;c=bo(c))for(let p=ir;p<c.length;p++){const g=c[p];if(_o(g))if(512&g[mn]){const x=g[Rt];tl(x,g,x.template,g[xi])}else g[hs]>0&&Wp(g)}const o=n[Rt].components;if(null!==o)for(let c=0;c<o.length;c++){const p=sr(o[c],n);_o(p)&&p[hs]>0&&Wp(p)}}function jM(n,r){const o=sr(r,n),c=o[Rt];(function ry(n,r){for(let o=r.length;o<n.blueprint.length;o++)r.push(n.blueprint[o])})(c,o),Ql(c,o,o[xi])}function od(n,r){return n[aa]?n[du][Ci]=r:n[aa]=r,n[du]=r,r}function ic(n){for(;n;){n[mn]|=32;const r=Lc(n);if(gi(n)&&!r)return n;n=r}return null}function rc(n,r,o,c=!0){const p=r[es];p.begin&&p.begin();try{tl(n,r,n.template,o)}catch(x){throw c&&sc(r,x),x}finally{p.end&&p.end()}}function _g(n,r,o){bd(0),r(n,o)}function oy(n){return n[br]||(n[br]=[])}function yg(n){return n.cleanup||(n.cleanup=[])}function sc(n,r){const o=n[fl],c=o?o.get(Qc,null):null;c&&c.handleError(r)}function ph(n,r,o,c,p){for(let g=0;g<o.length;){const x=o[g++],w=o[g++],I=r[x],F=n.data[x];null!==F.setInput?F.setInput(I,p,c,w):I[w]=p}}function vg(n,r,o){let c=o?n.styles:null,p=o?n.classes:null,g=0;if(null!==r)for(let x=0;x<r.length;x++){const w=r[x];"number"==typeof w?g=w:1==g?p=Nn(p,w):2==g&&(c=Nn(c,w+": "+r[++x]+";"))}o?n.styles=c:n.stylesWithoutHost=c,o?n.classes=p:n.classesWithoutHost=p}function Bf(n,r,o,c,p=!1){for(;null!==o;){const g=r[o.index];if(null!==g&&c.push(Or(g)),rr(g))for(let w=ir;w<g.length;w++){const I=g[w],F=I[Rt].firstChild;null!==F&&Bf(I[Rt],I,F,c)}const x=o.type;if(8&x)Bf(n,r,o.child,c);else if(32&x){const w=Nc(o,r);let I;for(;I=w();)c.push(I)}else if(16&x){const w=jd(r,o);if(Array.isArray(w))c.push(...w);else{const I=Lc(r[Gi]);Bf(I[Rt],I,w,c,!0)}}o=p?o.projectionNext:o.next}return c}class $p{get rootNodes(){const r=this._lView,o=r[Rt];return Bf(o,r,o.firstChild,[])}constructor(r,o){this._lView=r,this._cdRefInjectingView=o,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[xi]}set context(r){this._lView[xi]=r}get destroyed(){return 128==(128&this._lView[mn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[Ri];if(rr(r)){const o=r[la],c=o?o.indexOf(this):-1;c>-1&&(Vr(r,c),Mo(o,c))}this._attachedToViewContainer=!1}va(this._lView[Rt],this._lView)}onDestroy(r){Z_(this._lView[Rt],this._lView,null,r)}markForCheck(){ic(this._cdRefInjectingView||this._lView)}detach(){this._lView[mn]&=-65}reattach(){this._lView[mn]|=64}detectChanges(){rc(this._lView[Rt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new He(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function km(n,r){xa(n,r,r[dn],2,null,null)}(this._lView[Rt],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new He(902,!1);this._appRef=r}}class f0 extends $p{constructor(r){super(r),this._view=r}detectChanges(){const r=this._view;rc(r[Rt],r,r[xi],!1)}checkNoChanges(){}get context(){return null}}class xg extends jo{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const o=Zn(r);return new jp(o,this.ngModule)}}function Mg(n){const r=[];for(let o in n)n.hasOwnProperty(o)&&r.push({propName:n[o],templateName:o});return r}class qM{constructor(r,o){this.injector=r,this.parentInjector=o}get(r,o,c){c=Cn(c);const p=this.injector.get(r,ah,c);return p!==ah||o===ah?p:this.parentInjector.get(r,o,c)}}class jp extends sh{get inputs(){return Mg(this.componentDef.inputs)}get outputs(){return Mg(this.componentDef.outputs)}constructor(r,o){super(),this.componentDef=r,this.ngModule=o,this.componentType=r.type,this.selector=function f(n){return n.map(dh).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!o}create(r,o,c,p){let g=(p=p||this.ngModule)instanceof Yl?p:p?.injector;g&&null!==this.componentDef.getStandaloneInjector&&(g=this.componentDef.getStandaloneInjector(g)||g);const x=g?new qM(r,g):r,w=x.get(Jc,null);if(null===w)throw new He(407,!1);const I=x.get(oh,null),F=w.createRenderer(null,this.componentDef),W=this.componentDef.selectors[0][0]||"div",J=c?function UM(n,r,o){return n.selectRootElement(r,o===us.ShadowDom)}(F,c,this.componentDef.encapsulation):Lu(F,W,function YM(n){const r=n.toLowerCase();return"svg"===r?mu:"math"===r?"math":null}(W)),le=this.componentDef.onPush?288:272,pe=tc(0,null,null,1,0,null,null,null,null,null),Pe=kp(null,pe,null,le,null,null,w,F,I,x,null);let rt,Pt;vu(Pe);try{const Gt=this.componentDef;let Mn,Je=null;Gt.findHostDirectiveDefs?(Mn=[],Je=new Map,Gt.findHostDirectiveDefs(Gt,Mn,Je),Mn.push(Gt)):Mn=[Gt];const Bn=function ly(n,r){const o=n[Rt],c=oi;return n[c]=r,Yo(o,c,2,"#host",null)}(Pe,J),yr=function ZM(n,r,o,c,p,g,x,w){const I=p[Rt];!function Xp(n,r,o,c){for(const p of n)r.mergedAttrs=pa(r.mergedAttrs,p.hostAttrs);null!==r.mergedAttrs&&(vg(r,r.mergedAttrs,!0),null!==o&&zo(c,o,r))}(c,n,r,x);const F=g.createRenderer(r,o),W=kp(p,q_(o),null,o.onPush?32:16,p[n.index],n,g,F,w||null,null,null);return I.firstCreatePass&&zp(I,n,c.length-1),od(p,W),p[n.index]=W}(Bn,J,Gt,Mn,Pe,w,F);Pt=go(pe,oi),J&&function KM(n,r,o,c){if(c)vs(n,o,["ng-version",el.full]);else{const{attrs:p,classes:g}=function h(n){const r=[],o=[];let c=1,p=2;for(;c<n.length;){let g=n[c];if("string"==typeof g)2===p?""!==g&&r.push(g,n[++c]):8===p&&o.push(g);else{if(!mr(p))break;p=g}c++}return{attrs:r,classes:o}}(r.selectors[0]);p&&vs(n,o,p),g&&g.length>0&&Rr(n,o,g.join(" "))}}(F,Gt,J,c),void 0!==o&&function Pr(n,r,o){const c=n.projection=[];for(let p=0;p<r.length;p++){const g=o[p];c.push(null!=g?Array.from(g):null)}}(Pt,this.ngContentSelectors,o),rt=function gr(n,r,o,c,p,g){const x=or(),w=p[Rt],I=gs(x,p);J_(w,p,x,o,null,c);for(let W=0;W<o.length;W++)as(Ha(p,w,x.directiveStart+W,x),p);Q_(w,p,x),I&&as(I,p);const F=Ha(p,w,x.directiveStart+x.componentOffset,x);if(n[xi]=p[xi]=F,null!==g)for(const W of g)W(F,r);return Y_(w,x,n),F}(yr,Gt,Mn,Je,Pe,[Yp]),Ql(pe,Pe,null)}finally{Ds()}return new ay(this.componentType,rt,Ja(Pt,Pe),Pe,Pt)}}class ay extends wf{constructor(r,o,c,p,g){super(),this.location=c,this._rootLView=p,this._tNode=g,this.instance=o,this.hostView=this.changeDetectorRef=new f0(p),this.componentType=r}setInput(r,o){const c=this._tNode.inputs;let p;if(null!==c&&(p=c[r])){const g=this._rootLView;ph(g[Rt],g,p,r,o),ic(sr(this._tNode.index,g))}}get injector(){return new Fo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function Yp(){const n=or();_e(Ge()[Rt],n)}function cy(n){let r=function p0(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),o=!0;const c=[n];for(;r;){let p;if(Sr(n))p=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new He(903,!1);p=r.\u0275dir}if(p){if(o){c.push(p);const x=n;x.inputs=qp(n.inputs),x.declaredInputs=qp(n.declaredInputs),x.outputs=qp(n.outputs);const w=p.hostBindings;w&&QM(n,w);const I=p.viewQuery,F=p.contentQueries;if(I&&Zp(n,I),F&&Sg(n,F),Qt(n.inputs,p.inputs),Qt(n.declaredInputs,p.declaredInputs),Qt(n.outputs,p.outputs),Sr(p)&&p.data.animation){const W=n.data;W.animation=(W.animation||[]).concat(p.data.animation)}}const g=p.features;if(g)for(let x=0;x<g.length;x++){const w=g[x];w&&w.ngInherit&&w(n),w===cy&&(o=!1)}}r=Object.getPrototypeOf(r)}!function JM(n){let r=0,o=null;for(let c=n.length-1;c>=0;c--){const p=n[c];p.hostVars=r+=p.hostVars,p.hostAttrs=pa(p.hostAttrs,o=pa(o,p.hostAttrs))}}(c)}function qp(n){return n===vi?{}:n===on?[]:n}function Zp(n,r){const o=n.viewQuery;n.viewQuery=o?(c,p)=>{r(c,p),o(c,p)}:r}function Sg(n,r){const o=n.contentQueries;n.contentQueries=o?(c,p,g)=>{r(c,p,g),o(c,p,g)}:r}function QM(n,r){const o=n.hostBindings;n.hostBindings=o?(c,p)=>{r(c,p),o(c,p)}:r}function kf(n){return!!wg(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function wg(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Ns(n,r,o){return!Object.is(n[r],o)&&(n[r]=o,!0)}function Cg(n,r,o,c){const p=Ge();return Ns(p,K(),r)&&(Xn(),nc(_i(),p,n,r,o,c)),Cg}function by(n,r,o,c,p,g,x,w){const I=Ge(),F=Xn(),W=n+oi,J=F.firstCreatePass?function b0(n,r,o,c,p,g,x,w,I){const F=r.consts,W=Yo(r,n,4,x||null,Qs(F,w));pg(r,o,W,Qs(F,I)),_e(r,W);const J=W.tView=tc(2,W,c,p,g,r.directiveRegistry,r.pipeRegistry,null,r.schemas,F);return null!==r.queries&&(r.queries.template(r,W),J.queries=r.queries.embeddedTView(W)),W}(W,F,I,r,o,c,p,g,x):F.data[W];Gr(J,!1);const le=I[dn].createComment("");Eo(F,I,le,J),as(le,I),od(I,I[W]=ty(le,I,le,J)),Fa(J)&&ec(F,I,J),null!=x&&Vp(I,J,w)}function Tg(n,r,o){const c=Ge();return Ns(c,K(),r)&&function To(n,r,o,c,p,g,x,w){const I=gs(r,o);let W,F=r.inputs;!w&&null!=F&&(W=F[c])?(ph(n,o,W,c,p),Ts(r)&&function l0(n,r){const o=sr(r,n);16&o[mn]||(o[mn]|=32)}(o,r.index)):3&r.type&&(c=function a0(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(c),p=null!=x?x(p,r.value||"",c):p,g.setProperty(I,c,p))}(Xn(),_i(),c,n,r,c[dn],o,!1),Tg}function Ag(n,r,o,c,p){const x=p?"class":"style";ph(n,o,r.inputs[x],x,c)}function Jp(n,r,o,c){const p=Ge(),g=Xn(),x=oi+n,w=p[dn],I=g.firstCreatePass?function w0(n,r,o,c,p,g){const x=r.consts,I=Yo(r,n,2,c,Qs(x,p));return pg(r,o,I,Qs(x,g)),null!==I.attrs&&vg(I,I.attrs,!1),null!==I.mergedAttrs&&vg(I,I.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,I),I}(x,g,p,r,o,c):g.data[x],F=p[x]=Lu(w,r,function G(){return Yt.lFrame.currentNamespace}()),W=Fa(I);return Gr(I,!0),zo(w,F,I),32!=(32&I.flags)&&Eo(g,p,F,I),0===function Vh(){return Yt.lFrame.elementDepthCount}()&&as(F,p),function Hh(){Yt.lFrame.elementDepthCount++}(),W&&(ec(g,p,I),Y_(g,I,p)),null!==c&&Vp(p,I),Jp}function Qp(){let n=or();Ba()?function Hs(){Yt.lFrame.isParent=!1}():(n=n.parent,Gr(n,!1));const r=n;!function yo(){Yt.lFrame.elementDepthCount--}();const o=Xn();return o.firstCreatePass&&(_e(o,n),hu(n)&&o.queries.elementEnd(n)),null!=r.classesWithoutHost&&function is(n){return 0!=(8&n.flags)}(r)&&Ag(o,r,Ge(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function pr(n){return 0!=(16&n.flags)}(r)&&Ag(o,r,Ge(),r.stylesWithoutHost,!1),Qp}function Dg(n,r,o,c){return Jp(n,r,o,c),Qp(),Dg}function Ey(){return Ge()}function Pg(n){return!!n&&"function"==typeof n.then}function wy(n){return!!n&&"function"==typeof n.subscribe}const Cy=wy;function Ng(n,r,o,c){const p=Ge(),g=Xn(),x=or();return function Ay(n,r,o,c,p,g,x){const w=Fa(c),F=n.firstCreatePass&&yg(n),W=r[xi],J=oy(r);let le=!0;if(3&c.type||x){const rt=gs(c,r),Pt=x?x(rt):rt,Gt=J.length,Mn=x?Bn=>x(Or(Bn[c.index])):c.index;let Je=null;if(!x&&w&&(Je=function T0(n,r,o,c){const p=n.cleanup;if(null!=p)for(let g=0;g<p.length-1;g+=2){const x=p[g];if(x===o&&p[g+1]===c){const w=r[br],I=p[g+2];return w.length>I?w[I]:null}"string"==typeof x&&(g+=2)}return null}(n,r,p,c.index)),null!==Je)(Je.__ngLastListenerFn__||Je).__ngNextListenerFn__=g,Je.__ngLastListenerFn__=g,le=!1;else{g=Iy(c,r,W,g,!1);const Bn=o.listen(Pt,p,g);J.push(g,Bn),F&&F.push(p,Mn,Gt,Gt+1)}}else g=Iy(c,r,W,g,!1);const pe=c.outputs;let Pe;if(le&&null!==pe&&(Pe=pe[p])){const rt=Pe.length;if(rt)for(let Pt=0;Pt<rt;Pt+=2){const yr=r[Pe[Pt]][Pe[Pt+1]].subscribe(g),Jr=J.length;J.push(g,yr),F&&F.push(p,c.index,Jr,-(Jr+1))}}}(g,p,p[dn],x,n,r,c),Ng}function Dy(n,r,o,c){try{return ks(6,r,o),!1!==o(c)}catch(p){return sc(n,p),!1}finally{ks(7,r,o)}}function Iy(n,r,o,c,p){return function g(x){if(x===Function)return c;ic(n.componentOffset>-1?sr(n.index,r):r);let I=Dy(r,o,c,x),F=g.__ngNextListenerFn__;for(;F;)I=Dy(r,o,F,x)&&I,F=F.__ngNextListenerFn__;return p&&!1===I&&(x.preventDefault(),x.returnValue=!1),I}}function Ry(n=1){return function ha(n){return(Yt.lFrame.contextLView=function _s(n,r){for(;n>0;)r=r[Pi],n--;return r}(n,Yt.lFrame.contextLView))[xi]}(n)}function em(n,r){return n<<17|r<<2}function ru(n){return n>>17&32767}function Og(n){return 2|n}function ld(n){return(131068&n)>>2}function Fg(n,r){return-131069&n|r<<2}function Ug(n){return 1|n}function Hy(n,r,o,c,p){const g=n[o+1],x=null===r;let w=c?ru(g):ld(g),I=!1;for(;0!==w&&(!1===I||x);){const W=n[w+1];F0(n[w],r)&&(I=!0,n[w+1]=c?Ug(W):Og(W)),w=c?ru(W):ld(W)}I&&(n[o+1]=c?Og(g):Ug(g))}function F0(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&Ec(n,r)>=0}function Bg(n,r,o){return wa(n,r,o,!1),Bg}function kg(n,r){return wa(n,r,null,!0),kg}function wa(n,r,o,c){const p=Ge(),g=Xn(),x=function eo(n){const r=Yt.lFrame,o=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,o}(2);g.firstUpdatePass&&function qy(n,r,o,c){const p=n.data;if(null===p[o+1]){const g=p[ar()],x=function Yy(n,r){return r>=n.expandoStartIndex}(n,o);(function q0(n,r){return 0!=(n.flags&(r?8:16))})(g,c)&&null===r&&!x&&(r=!1),r=function $0(n,r,o,c){const p=function da(n){const r=Yt.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let g=c?r.residualClasses:r.residualStyles;if(null===p)0===(c?r.classBindings:r.styleBindings)&&(o=tm(o=Zy(null,n,r,o,c),r.attrs,c),g=null);else{const x=r.directiveStylingLast;if(-1===x||n[x]!==p)if(o=Zy(p,n,r,o,c),null===g){let I=function ob(n,r,o){const c=o?r.classBindings:r.styleBindings;if(0!==ld(c))return n[ru(c)]}(n,r,c);void 0!==I&&Array.isArray(I)&&(I=Zy(null,n,r,I[1],c),I=tm(I,r.attrs,c),function ab(n,r,o,c){n[ru(o?r.classBindings:r.styleBindings)]=c}(n,r,c,I))}else g=function lb(n,r,o){let c;const p=r.directiveEnd;for(let g=1+r.directiveStylingLast;g<p;g++)c=tm(c,n[g].hostAttrs,o);return tm(c,r.attrs,o)}(n,r,c)}return void 0!==g&&(c?r.residualClasses=g:r.residualStyles=g),o}(p,g,r,c),function L0(n,r,o,c,p,g){let x=g?r.classBindings:r.styleBindings,w=ru(x),I=ld(x);n[c]=o;let W,F=!1;if(Array.isArray(o)?(W=o[1],(null===W||Ec(o,W)>0)&&(F=!0)):W=o,p)if(0!==I){const le=ru(n[w+1]);n[c+1]=em(le,w),0!==le&&(n[le+1]=Fg(n[le+1],c)),n[w+1]=function P0(n,r){return 131071&n|r<<17}(n[w+1],c)}else n[c+1]=em(w,0),0!==w&&(n[w+1]=Fg(n[w+1],c)),w=c;else n[c+1]=em(I,0),0===w?w=c:n[I+1]=Fg(n[I+1],c),I=c;F&&(n[c+1]=Og(n[c+1])),Hy(n,W,c,!0),Hy(n,W,c,!1),function O0(n,r,o,c,p){const g=p?n.residualClasses:n.residualStyles;null!=g&&"string"==typeof r&&Ec(g,r)>=0&&(o[c+1]=Ug(o[c+1]))}(r,W,n,c,g),x=em(w,I),g?r.classBindings=x:r.styleBindings=x}(p,g,r,o,x,c)}}(g,n,x,c),r!==u&&Ns(p,x,r)&&function X0(n,r,o,c,p,g,x,w){if(!(3&r.type))return;const I=n.data,F=I[w+1],W=function N0(n){return 1==(1&n)}(F)?Y0(I,r,o,p,ld(F),x):void 0;Vg(W)||(Vg(g)||function R0(n){return 2==(2&n)}(F)&&(g=Y0(I,null,o,p,w,x)),function Ss(n,r,o,c,p){if(r)p?n.addClass(o,c):n.removeClass(o,c);else{let g=-1===c.indexOf("-")?void 0:jr.DashCase;null==p?n.removeStyle(o,c,g):("string"==typeof p&&p.endsWith("!important")&&(p=p.slice(0,-10),g|=jr.Important),n.setStyle(o,c,p,g))}}(c,x,gu(ar(),o),p,g))}(g,g.data[ar()],p,p[dn],n,p[x+1]=function hb(n,r){return null==n||""===n||("string"==typeof r?n+=r:"object"==typeof n&&(n=Xt(Gl(n)))),n}(r,o),c,x)}function Zy(n,r,o,c,p){let g=null;const x=o.directiveEnd;let w=o.directiveStylingLast;for(-1===w?w=o.directiveStart:w++;w<x&&(g=r[w],c=tm(c,g.hostAttrs,p),g!==n);)w++;return null!==n&&(o.directiveStylingLast=w),c}function tm(n,r,o){const c=o?1:2;let p=-1;if(null!==r)for(let g=0;g<r.length;g++){const x=r[g];"number"==typeof x?p=x:p===c&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),li(n,x,!!o||r[++g]))}return void 0===n?null:n}function Y0(n,r,o,c,p,g){const x=null===r;let w;for(;p>0;){const I=n[p],F=Array.isArray(I),W=F?I[1]:I,J=null===W;let le=o[p+1];le===u&&(le=J?on:void 0);let pe=J?Sc(le,c):W===c?le:void 0;if(F&&!Vg(pe)&&(pe=Sc(I,c)),Vg(pe)&&(w=pe,x))return w;const Pe=n[p+1];p=x?ru(Pe):ld(Pe)}if(null!==r){let I=g?r.residualClasses:r.residualStyles;null!=I&&(w=Sc(I,c))}return w}function Vg(n){return void 0!==n}function Z0(n,r=""){const o=Ge(),c=Xn(),p=n+oi,g=c.firstCreatePass?Yo(c,p,1,r,null):c.data[p],x=o[p]=function So(n,r){return n.createText(r)}(o[dn],r);Eo(c,o,x,g),Gr(g,!1)}function Ky(n){return Hg("",n,""),Ky}function Hg(n,r,o){const c=Ge(),p=function gh(n,r,o,c){return Ns(n,K(),o)?r+Fe(o)+c:u}(c,n,r,o);return p!==u&&function Ea(n,r,o){const c=gu(r,n);!function bs(n,r,o){n.setValue(r,o)}(n[dn],c,o)}(c,ar(),p),Hg}const oc=void 0;var wh=["en",[["a","p"],["AM","PM"],oc],[["AM","PM"],oc,oc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],oc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],oc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",oc,"{1} 'at' {0}",oc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function dd(n){const o=Math.floor(Math.abs(n)),c=n.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===c?1:5}];let hd={};function am(n){const r=function tv(n){return n.toLowerCase().replace(/_/g,"-")}(n);let o=Hf(r);if(o)return o;const c=r.split("-")[0];if(o=Hf(c),o)return o;if("en"===c)return wh;throw new He(701,!1)}function Wg(n){return am(n)[bn.PluralCase]}function Hf(n){return n in hd||(hd[n]=Ln.ng&&Ln.ng.common&&Ln.ng.common.locales&&Ln.ng.common.locales[n]),hd[n]}var bn=(()=>((bn=bn||{})[bn.LocaleId=0]="LocaleId",bn[bn.DayPeriodsFormat=1]="DayPeriodsFormat",bn[bn.DayPeriodsStandalone=2]="DayPeriodsStandalone",bn[bn.DaysFormat=3]="DaysFormat",bn[bn.DaysStandalone=4]="DaysStandalone",bn[bn.MonthsFormat=5]="MonthsFormat",bn[bn.MonthsStandalone=6]="MonthsStandalone",bn[bn.Eras=7]="Eras",bn[bn.FirstDayOfWeek=8]="FirstDayOfWeek",bn[bn.WeekendRange=9]="WeekendRange",bn[bn.DateFormat=10]="DateFormat",bn[bn.TimeFormat=11]="TimeFormat",bn[bn.DateTimeFormat=12]="DateTimeFormat",bn[bn.NumberSymbols=13]="NumberSymbols",bn[bn.NumberFormats=14]="NumberFormats",bn[bn.CurrencyCode=15]="CurrencyCode",bn[bn.CurrencySymbol=16]="CurrencySymbol",bn[bn.CurrencyName=17]="CurrencyName",bn[bn.Currencies=18]="Currencies",bn[bn.Directionality=19]="Directionality",bn[bn.PluralCase=20]="PluralCase",bn[bn.ExtraData=21]="ExtraData",bn))();const Ch="en-US";let jg=Ch;function r_(n,r,o,c,p){if(n=kt(n),Array.isArray(n))for(let g=0;g<n.length;g++)r_(n[g],r,o,c,p);else{const g=Xn(),x=Ge();let w=Co(n)?n:kt(n.provide),I=Zc(n);const F=or(),W=1048575&F.providerIndexes,J=F.directiveStart,le=F.providerIndexes>>20;if(Co(n)||!n.multi){const pe=new Yn(I,p,Of),Pe=s_(w,r,p?W:W+le,J);-1===Pe?(No(ma(F,x),g,w),gm(g,n,r.length),r.push(w),F.directiveStart++,F.directiveEnd++,p&&(F.providerIndexes+=1048576),o.push(pe),x.push(pe)):(o[Pe]=pe,x[Pe]=pe)}else{const pe=s_(w,r,W+le,J),Pe=s_(w,r,W,W+le),Pt=Pe>=0&&o[Pe];if(p&&!Pt||!p&&!(pe>=0&&o[pe])){No(ma(F,x),g,w);const Gt=function jx(n,r,o,c,p){const g=new Yn(n,o,Of);return g.multi=[],g.index=r,g.componentProviders=0,Mv(g,p,c&&!o),g}(p?$x:Wx,o.length,p,c,I);!p&&Pt&&(o[Pe].providerFactory=Gt),gm(g,n,r.length,0),r.push(w),F.directiveStart++,F.directiveEnd++,p&&(F.providerIndexes+=1048576),o.push(Gt),x.push(Gt)}else gm(g,n,pe>-1?pe:Pe,Mv(o[p?Pe:pe],I,!p&&c));!p&&c&&Pt&&o[Pe].componentProviders++}}}function gm(n,r,o,c){const p=Co(r),g=function Ap(n){return!!n.useClass}(r);if(p||g){const I=(g?kt(r.useClass):r).prototype.ngOnDestroy;if(I){const F=n.destroyHooks||(n.destroyHooks=[]);if(!p&&r.multi){const W=F.indexOf(o);-1===W?F.push(o,[c,I]):F[W+1].push(c,I)}else F.push(o,I)}}}function Mv(n,r,o){return o&&n.componentProviders++,n.multi.push(r)-1}function s_(n,r,o,c){for(let p=o;p<c;p++)if(r[p]===n)return p;return-1}function Wx(n,r,o,c){return o_(this.multi,[])}function $x(n,r,o,c){const p=this.multi;let g;if(this.providerFactory){const x=this.providerFactory.componentProviders,w=Ha(o,o[Rt],this.providerFactory.index,c);g=w.slice(0,x),o_(p,g);for(let I=x;I<w.length;I++)g.push(w[I])}else g=[],o_(p,g);return g}function o_(n,r){for(let o=0;o<n.length;o++)r.push((0,n[o])());return r}function bv(n,r=[]){return o=>{o.providersResolver=(c,p)=>function xv(n,r,o){const c=Xn();if(c.firstCreatePass){const p=Sr(n);r_(o,c.data,c.blueprint,p,!0),r_(r,c.data,c.blueprint,p,!1)}}(c,p?p(n):n,r)}}class Th{}class Sv{}function Xx(n,r){return new Ev(n,r??null)}class Ev extends Th{constructor(r,o){super(),this._parent=o,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new xg(this);const c=hr(r);this._bootstrapComponents=Xo(c.bootstrap),this._r3Injector=Kl(r,o,[{provide:Th,useValue:this},{provide:jo,useValue:this.componentFactoryResolver}],Xt(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(o=>o()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class _m extends Sv{constructor(r){super(),this.moduleType=r}create(r){return new Ev(this.moduleType,r)}}class wv extends Th{constructor(r,o,c){super(),this.componentFactoryResolver=new xg(this),this.instance=null;const p=new ql([...r,{provide:Th,useValue:this},{provide:jo,useValue:this.componentFactoryResolver}],o||Ka(),c,new Set(["environment"]));this.injector=p,p.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function a_(n,r,o=null){return new wv(n,r,o).injector}let Yx=(()=>{class n{constructor(o){this._injector=o,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(o){if(!o.standalone)return null;if(!this.cachedInjectors.has(o.id)){const c=Km(0,o.type),p=c.length>0?a_([c],this._injector,`Standalone[${o.type.name}]`):null;this.cachedInjectors.set(o.id,p)}return this.cachedInjectors.get(o.id)}ngOnDestroy(){try{for(const o of this.cachedInjectors.values())null!==o&&o.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=In({token:n,providedIn:"environment",factory:()=>new n(Ut(Yl))}),n})();function Cv(n){n.getStandaloneInjector=r=>r.get(Yx).getOrCreateStandaloneInjector(n)}function d_(n){return r=>{setTimeout(n,void 0,r)}}const Zo=class pM extends U.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,o,c){let p=r,g=o||(()=>null),x=c;if(r&&"object"==typeof r){const I=r;p=I.next?.bind(I),g=I.error?.bind(I),x=I.complete?.bind(I)}this.__isAsync&&(g=d_(g),p&&(p=d_(p)),x&&(x=d_(x)));const w=super.subscribe({next:p,error:g,complete:x});return r instanceof R.w0&&r.add(w),w}};function Uv(){return this._results[Symbol.iterator]()}class Ah{get changes(){return this._changes||(this._changes=new Zo)}constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const o=Ah.prototype;o[Symbol.iterator]||(o[Symbol.iterator]=Uv)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,o){return this._results.reduce(r,o)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,o){const c=this;c.dirty=!1;const p=function Mi(n){return n.flat(Number.POSITIVE_INFINITY)}(r);(this._changesDetected=!function Nt(n,r,o){if(n.length!==r.length)return!1;for(let c=0;c<n.length;c++){let p=n[c],g=r[c];if(o&&(p=o(p),g=o(g)),g!==p)return!1}return!0}(c._results,p,o))&&(c._results=p,c.length=p.length,c.last=p[this.length-1],c.first=p[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Dh=(()=>{class n{}return n.__NG_ELEMENT_ID__=kv,n})();const Bv=Dh,h_=class extends Bv{constructor(r,o,c){super(),this._declarationLView=r,this._declarationTContainer=o,this.elementRef=c}createEmbeddedView(r,o){const c=this._declarationTContainer.tView,p=kp(this._declarationLView,c,r,16,null,c.declTNode,null,null,null,null,o||null);p[Ji]=this._declarationLView[this._declarationTContainer.index];const x=this._declarationLView[ps];return null!==x&&(p[ps]=x.createEmbeddedView(c)),Ql(c,p,r),new $p(p)}};function kv(){return qf(or(),Ge())}function qf(n,r){return 4&n.type?new h_(r,n,Ja(n,r)):null}let zr=(()=>{class n{}return n.__NG_ELEMENT_ID__=Es,n})();function Es(){return f_(or(),Ge())}const ol=zr,xm=class extends ol{constructor(r,o,c){super(),this._lContainer=r,this._hostTNode=o,this._hostLView=c}get element(){return Ja(this._hostTNode,this._hostLView)}get injector(){return new Fo(this._hostTNode,this._hostLView)}get parentInjector(){const r=yc(this._hostTNode,this._hostLView);if(Su(r)){const o=vo(r,this._hostLView),c=Eu(r);return new Fo(o[Rt].data[c+8],o)}return new Fo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const o=Mm(this._lContainer);return null!==o&&o[r]||null}get length(){return this._lContainer.length-ir}createEmbeddedView(r,o,c){let p,g;"number"==typeof c?p=c:null!=c&&(p=c.index,g=c.injector);const x=r.createEmbeddedView(o||{},g);return this.insert(x,p),x}createComponent(r,o,c,p,g){const x=r&&!function Ga(n){return"function"==typeof n}(r);let w;if(x)w=o;else{const J=o||{};w=J.index,c=J.injector,p=J.projectableNodes,g=J.environmentInjector||J.ngModuleRef}const I=x?r:new jp(Zn(r)),F=c||this.parentInjector;if(!g&&null==I.ngModule){const le=(x?F:this.parentInjector).get(Yl,null);le&&(g=le)}const W=I.create(F,p,void 0,g);return this.insert(W.hostView,w),W}insert(r,o){const c=r._lView,p=c[Rt];if(function Er(n){return rr(n[Ri])}(c)){const W=this.indexOf(r);if(-1!==W)this.detach(W);else{const J=c[Ri],le=new xm(J,J[Wi],J[Ri]);le.detach(le.indexOf(r))}}const g=this._adjustIndex(o),x=this._lContainer;!function Ou(n,r,o,c){const p=ir+c,g=o.length;c>0&&(o[p-1][Ci]=r),c<g-ir?(r[Ci]=o[p],Ws(o,ir+c,r)):(o.push(r),r[Ci]=null),r[Ri]=o;const x=r[Ji];null!==x&&o!==x&&function Xa(n,r){const o=n[ml];r[Gi]!==r[Ri][Ri][Gi]&&(n[Oa]=!0),null===o?n[ml]=[r]:o.push(r)}(x,r);const w=r[ps];null!==w&&w.insertView(n),r[mn]|=64}(p,c,x,g);const w=Bu(g,x),I=c[dn],F=Vl(I,x[Sn]);return null!==F&&function mp(n,r,o,c,p,g){c[ds]=p,c[Wi]=r,xa(n,c,o,1,p,g)}(p,x[Wi],I,c,F,w),r.attachToViewContainerRef(),Ws(Kr(x),g,r),r}move(r,o){return this.insert(r,o)}indexOf(r){const o=Mm(this._lContainer);return null!==o?o.indexOf(r):-1}remove(r){const o=this._adjustIndex(r,-1),c=Vr(this._lContainer,o);c&&(Mo(Kr(this._lContainer),o),va(c[Rt],c))}detach(r){const o=this._adjustIndex(r,-1),c=Vr(this._lContainer,o);return c&&null!=Mo(Kr(this._lContainer),o)?new $p(c):null}_adjustIndex(r,o=0){return r??this.length+o}};function Mm(n){return n[la]}function Kr(n){return n[la]||(n[la]=[])}function f_(n,r){let o;const c=r[n.index];if(rr(c))o=c;else{let p;if(8&n.type)p=Or(c);else{const g=r[dn];p=g.createComment("");const x=gs(n,r);Xr(g,Vl(g,x),p,function _p(n,r){return n.nextSibling(r)}(g,x),!1)}r[n.index]=o=ty(c,r,p,n),od(r,o)}return new xm(o,n,r)}class Ih{constructor(r){this.queryList=r,this.matches=null}clone(){return new Ih(this.queryList)}setDirty(){this.queryList.setDirty()}}class Rh{constructor(r=[]){this.queries=r}createEmbeddedView(r){const o=r.queries;if(null!==o){const c=null!==r.contentQueries?r.contentQueries[0]:o.length,p=[];for(let g=0;g<c;g++){const x=o.getByIndex(g);p.push(this.queries[x.indexInDeclarationView].clone())}return new Rh(p)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let o=0;o<this.queries.length;o++)null!==i(r,o).matches&&this.queries[o].setDirty()}}class Ta{constructor(r,o,c=null){this.predicate=r,this.flags=o,this.read=c}}class Ko{constructor(r=[]){this.queries=r}elementStart(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(r,o)}elementEnd(r){for(let o=0;o<this.queries.length;o++)this.queries[o].elementEnd(r)}embeddedTView(r){let o=null;for(let c=0;c<this.length;c++){const p=null!==o?o.length:0,g=this.getByIndex(c).embeddedTView(r,p);g&&(g.indexInDeclarationView=c,null!==o?o.push(g):o=[g])}return null!==o?new Ko(o):null}template(r,o){for(let c=0;c<this.queries.length;c++)this.queries[c].template(r,o)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class ac{constructor(r,o=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=o}elementStart(r,o){this.isApplyingToNode(o)&&this.matchTNode(r,o)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,o){this.elementStart(r,o)}embeddedTView(r,o){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,o),new ac(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const o=this._declarationNodeIndex;let c=r.parent;for(;null!==c&&8&c.type&&c.index!==o;)c=c.parent;return o===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(r,o){const c=this.metadata.predicate;if(Array.isArray(c))for(let p=0;p<c.length;p++){const g=c[p];this.matchTNodeWithReadOption(r,o,Vv(o,g)),this.matchTNodeWithReadOption(r,o,Va(o,r,g,!1,!1))}else c===Dh?4&o.type&&this.matchTNodeWithReadOption(r,o,-1):this.matchTNodeWithReadOption(r,o,Va(o,r,c,!1,!1))}matchTNodeWithReadOption(r,o,c){if(null!==c){const p=this.metadata.read;if(null!==p)if(p===Qa||p===zr||p===Dh&&4&o.type)this.addMatch(o.index,-2);else{const g=Va(o,r,p,!1,!1);null!==g&&this.addMatch(o.index,g)}else this.addMatch(o.index,c)}}addMatch(r,o){null===this.matches?this.matches=[r,o]:this.matches.push(r,o)}}function Vv(n,r){const o=n.localNames;if(null!==o)for(let c=0;c<o.length;c+=2)if(o[c]===r)return o[c+1];return null}function gM(n,r,o,c){return-1===o?function mM(n,r){return 11&n.type?Ja(n,r):4&n.type?qf(n,r):null}(r,n):-2===o?function _M(n,r,o){return o===Qa?Ja(r,n):o===Dh?qf(r,n):o===zr?f_(r,n):void 0}(n,r,c):Ha(n,n[Rt],o,r)}function Hv(n,r,o,c){const p=r[ps].queries[c];if(null===p.matches){const g=n.data,x=o.matches,w=[];for(let I=0;I<x.length;I+=2){const F=x[I];w.push(F<0?null:gM(r,g[F],x[I+1],o.metadata.read))}p.matches=w}return p.matches}function p_(n,r,o,c){const p=n.queries.getByIndex(o),g=p.matches;if(null!==g){const x=Hv(n,r,p,o);for(let w=0;w<g.length;w+=2){const I=g[w];if(I>0)c.push(x[w/2]);else{const F=g[w+1],W=r[-I];for(let J=ir;J<W.length;J++){const le=W[J];le[Ji]===le[Ri]&&p_(le[Rt],le,F,c)}if(null!==W[ml]){const J=W[ml];for(let le=0;le<J.length;le++){const pe=J[le];p_(pe[Rt],pe,F,c)}}}}}return c}function zv(n){const r=Ge(),o=Xn(),c=Ml();bd(c+1);const p=i(o,c);if(n.dirty&&function kh(n){return 4==(4&n[mn])}(r)===(2==(2&p.metadata.flags))){if(null===p.matches)n.reset([]);else{const g=p.crossesNgTemplate?p_(o,r,c,[]):Hv(o,r,p,c);n.reset(g,tg),n.notifyOnChanges()}return!0}return!1}function ou(n,r,o){const c=Xn();c.firstCreatePass&&(e(c,new Ta(n,r,o),-1),2==(2&r)&&(c.staticViewQueries=!0)),l(c,Ge(),r)}function Gv(n,r,o,c){const p=Xn();if(p.firstCreatePass){const g=or();e(p,new Ta(r,o,c),g.index),function t(n,r){const o=n.contentQueries||(n.contentQueries=[]);r!==(o.length?o[o.length-1]:-1)&&o.push(n.queries.length-1,r)}(p,n),2==(2&o)&&(p.staticContentQueries=!0)}l(p,Ge(),o)}function Wv(){return function yM(n,r){return n[ps].queries[r].queryList}(Ge(),Ml())}function l(n,r,o){const c=new Ah(4==(4&o));Z_(n,r,c,c.destroy),null===r[ps]&&(r[ps]=new Rh),r[ps].queries.push(new Ih(c))}function e(n,r,o){null===n.queries&&(n.queries=new Ko),n.queries.track(new ac(r,o))}function i(n,r){return n.queries.getByIndex(r)}function E(n){return!!hr(n)}function en(...n){}const rn=new yi("Application Initializer");let Zt=(()=>{class n{constructor(o){this.appInits=o,this.resolve=en,this.reject=en,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,p)=>{this.resolve=c,this.reject=p})}runInitializers(){if(this.initialized)return;const o=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let p=0;p<this.appInits.length;p++){const g=this.appInits[p]();if(Pg(g))o.push(g);else if(Cy(g)){const x=new Promise((w,I)=>{g.subscribe({complete:w,error:I})});o.push(x)}}Promise.all(o).then(()=>{c()}).catch(p=>{this.reject(p)}),0===o.length&&c(),this.initialized=!0}}return n.\u0275fac=function(o){return new(o||n)(Ut(rn,8))},n.\u0275prov=In({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const lt=new yi("AppId",{providedIn:"root",factory:function Vt(){return`${an()}${an()}${an()}`}});function an(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Ot=new yi("Platform Initializer"),Gn=new yi("Platform ID",{providedIn:"platform",factory:()=>"unknown"});let Dt=(()=>{class n{log(o){console.log(o)}warn(o){console.warn(o)}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=In({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ot=new yi("LocaleId",{providedIn:"root",factory:()=>Bi(ot,Xe.Optional|Xe.SkipSelf)||function Kt(){return typeof $localize<"u"&&$localize.locale||Ch}()}),Ye=new yi("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Ai{constructor(r,o){this.ngModuleFactory=r,this.componentFactories=o}}let lc=(()=>{class n{compileModuleSync(o){return new _m(o)}compileModuleAsync(o){return Promise.resolve(this.compileModuleSync(o))}compileModuleAndAllComponentsSync(o){const c=this.compileModuleSync(o),g=Xo(hr(o).declarations).reduce((x,w)=>{const I=Zn(w);return I&&x.push(new jp(I)),x},[]);return new Ai(c,g)}compileModuleAndAllComponentsAsync(o){return Promise.resolve(this.compileModuleAndAllComponentsSync(o))}clearCache(){}clearCacheFor(o){}getModuleId(o){}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=In({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $v=(()=>Promise.resolve(0))();function Ph(n){typeof Zone>"u"?$v.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Jo{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:o=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Zo(!1),this.onMicrotaskEmpty=new Zo(!1),this.onStable=new Zo(!1),this.onError=new Zo(!1),typeof Zone>"u")throw new He(908,!1);Zone.assertZonePatched();const p=this;p._nesting=0,p._outer=p._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(p._inner=p._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(p._inner=p._inner.fork(Zone.longStackTraceZoneSpec)),p.shouldCoalesceEventChangeDetection=!c&&o,p.shouldCoalesceRunChangeDetection=c,p.lastRequestAnimationFrameId=-1,p.nativeRequestAnimationFrame=function jv(){let n=Ln.requestAnimationFrame,r=Ln.cancelAnimationFrame;if(typeof Zone<"u"&&n&&r){const o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o);const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function EM(n){const r=()=>{!function SM(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ln,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,__(n),n.isCheckStableRunning=!0,g_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),__(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(o,c,p,g,x,w)=>{try{return Y(n),o.invokeTask(p,g,x,w)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||n.shouldCoalesceRunChangeDetection)&&r(),de(n)}},onInvoke:(o,c,p,g,x,w,I)=>{try{return Y(n),o.invoke(p,g,x,w,I)}finally{n.shouldCoalesceRunChangeDetection&&r(),de(n)}},onHasTask:(o,c,p,g)=>{o.hasTask(p,g),c===p&&("microTask"==g.change?(n._hasPendingMicrotasks=g.microTask,__(n),g_(n)):"macroTask"==g.change&&(n.hasPendingMacrotasks=g.macroTask))},onHandleError:(o,c,p,g)=>(o.handleError(p,g),n.runOutsideAngular(()=>n.onError.emit(g)),!1)})}(p)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Jo.isInAngularZone())throw new He(909,!1)}static assertNotInAngularZone(){if(Jo.isInAngularZone())throw new He(909,!1)}run(r,o,c){return this._inner.run(r,o,c)}runTask(r,o,c,p){const g=this._inner,x=g.scheduleEventTask("NgZoneEvent: "+p,r,bM,en,en);try{return g.runTask(x,o,c)}finally{g.cancelTask(x)}}runGuarded(r,o,c){return this._inner.runGuarded(r,o,c)}runOutsideAngular(r){return this._outer.run(r)}}const bM={};function g_(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function __(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Y(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function de(n){n._nesting--,g_(n)}class xe{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Zo,this.onMicrotaskEmpty=new Zo,this.onStable=new Zo,this.onError=new Zo}run(r,o,c){return r.apply(o,c)}runGuarded(r,o,c){return r.apply(o,c)}runOutsideAngular(r){return r()}runTask(r,o,c,p){return r.apply(o,c)}}const Me=new yi(""),fe=new yi("");let jt,ut=(()=>{class n{constructor(o,c,p){this._ngZone=o,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,jt||(function tn(n){jt=n}(p),p.addToWindow(c)),this._watchAngularEvents(),o.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Jo.assertNotInAngularZone(),Ph(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ph(()=>{for(;0!==this._callbacks.length;){let o=this._callbacks.pop();clearTimeout(o.timeoutId),o.doneCb(this._didWork)}this._didWork=!1});else{let o=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(o)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(o=>({source:o.source,creationLocation:o.creationLocation,data:o.data})):[]}addCallback(o,c,p){let g=-1;c&&c>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(x=>x.timeoutId!==g),o(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:o,timeoutId:g,updateCb:p})}whenStable(o,c,p){if(p&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(o,c,p),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(o){this.registry.registerApplication(o,this)}unregisterApplication(o){this.registry.unregisterApplication(o)}findProviders(o,c,p){return[]}}return n.\u0275fac=function(o){return new(o||n)(Ut(Jo),Ut(Lt),Ut(fe))},n.\u0275prov=In({token:n,factory:n.\u0275fac}),n})(),Lt=(()=>{class n{constructor(){this._applications=new Map}registerApplication(o,c){this._applications.set(o,c)}unregisterApplication(o){this._applications.delete(o)}unregisterAllApplications(){this._applications.clear()}getTestability(o){return this._applications.get(o)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(o,c=!0){return jt?.findTestabilityInTree(this,o,c)??null}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=In({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const cn=!1;let vn=null;const xn=new yi("AllowMultipleToken"),ei=new yi("PlatformDestroyListeners"),wi=new yi("appBootstrapListener");class En{constructor(r,o){this.name=r,this.token=o}}function co(n,r,o=[]){const c=`Platform: ${r}`,p=new yi(c);return(g=[])=>{let x=uo();if(!x||x.injector.get(xn,!1)){const w=[...o,...g,{provide:p,useValue:!0}];n?n(w):function cr(n){if(vn&&!vn.get(xn,!1))throw new He(400,!1);vn=n;const r=n.get(Ls);(function lo(n){const r=n.get(Ot,null);r&&r.forEach(o=>o())})(n)}(function nr(n=[],r){return Hr.create({name:r,providers:[{provide:Vi,useValue:"platform"},{provide:ei,useValue:new Set([()=>vn=null])},...n]})}(w,c))}return function Kf(n){const r=uo();if(!r)throw new He(401,!1);return r}()}}function uo(){return vn?.get(Ls)??null}let Ls=(()=>{class n{constructor(o){this._injector=o,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(o,c){const p=function Sm(n,r){let o;return o="noop"===n?new xe:("zone.js"===n?void 0:n)||new Jo(r),o}(c?.ngZone,function qs(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(c)),g=[{provide:Jo,useValue:p}];return p.run(()=>{const x=Hr.create({providers:g,parent:this.injector,name:o.moduleType.name}),w=o.create(x),I=w.injector.get(Qc,null);if(!I)throw new He(402,!1);return p.runOutsideAngular(()=>{const F=p.onError.subscribe({next:W=>{I.handleError(W)}});w.onDestroy(()=>{Yv(this._modules,w),F.unsubscribe()})}),function au(n,r,o){try{const c=o();return Pg(c)?c.catch(p=>{throw r.runOutsideAngular(()=>n.handleError(p)),p}):c}catch(c){throw r.runOutsideAngular(()=>n.handleError(c)),c}}(I,p,()=>{const F=w.injector.get(Zt);return F.runInitializers(),F.donePromise.then(()=>(function Xg(n){fi(n,"Expected localeId to be defined"),"string"==typeof n&&(jg=n.toLowerCase().replace(/_/g,"-"))}(w.injector.get(ot,Ch)||Ch),this._moduleDoBootstrap(w),w))})})}bootstrapModule(o,c=[]){const p=Ob({},c);return function Nr(n,r,o){const c=new _m(o);return Promise.resolve(c)}(0,0,o).then(g=>this.bootstrapModuleFactory(g,p))}_moduleDoBootstrap(o){const c=o.injector.get(Xv);if(o._bootstrapComponents.length>0)o._bootstrapComponents.forEach(p=>c.bootstrap(p));else{if(!o.instance.ngDoBootstrap)throw new He(-403,!1);o.instance.ngDoBootstrap(c)}this._modules.push(o)}onDestroy(o){this._destroyListeners.push(o)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new He(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const o=this._injector.get(ei,null);o&&(o.forEach(c=>c()),o.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(o){return new(o||n)(Ut(Hr))},n.\u0275prov=In({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function Ob(n,r){return Array.isArray(r)?r.reduce(Ob,n):{...n,...r}}let Xv=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(o,c,p){this._zone=o,this._injector=c,this._exceptionHandler=p,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const g=new st.y(w=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{w.next(this._stable),w.complete()})}),x=new st.y(w=>{let I;this._zone.runOutsideAngular(()=>{I=this._zone.onStable.subscribe(()=>{Jo.assertNotInAngularZone(),Ph(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,w.next(!0))})})});const F=this._zone.onUnstable.subscribe(()=>{Jo.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{w.next(!1)}))});return()=>{I.unsubscribe(),F.unsubscribe()}});this.isStable=function It(...n){const r=(0,vt.yG)(n),o=(0,vt._6)(n,1/0),c=n;return c.length?1===c.length?(0,qe.Xf)(c[0]):(0,at.J)(o)((0,Jt.D)(c,r)):Ft.E}(g,x.pipe(function pt(n={}){const{connector:r=(()=>new U.x),resetOnError:o=!0,resetOnComplete:c=!0,resetOnRefCountZero:p=!0}=n;return g=>{let x,w,I,F=0,W=!1,J=!1;const le=()=>{w?.unsubscribe(),w=void 0},pe=()=>{le(),x=I=void 0,W=J=!1},Pe=()=>{const rt=x;pe(),rt?.unsubscribe()};return(0,Le.e)((rt,Pt)=>{F++,!J&&!W&&le();const Gt=I=I??r();Pt.add(()=>{F--,0===F&&!J&&!W&&(w=fn(Pe,p))}),Gt.subscribe(Pt),!x&&F>0&&(x=new Ve.Hp({next:Mn=>Gt.next(Mn),error:Mn=>{J=!0,le(),w=fn(pe,o,Mn),Gt.error(Mn)},complete:()=>{W=!0,le(),w=fn(pe,c),Gt.complete()}}),(0,qe.Xf)(rt).subscribe(x))})(g)}}()))}bootstrap(o,c){const p=o instanceof sh;if(!this._injector.get(Zt).done){!p&&Ao(o);throw new He(405,cn)}let x;x=p?o:this._injector.get(jo).resolveComponentFactory(o),this.componentTypes.push(x.componentType);const w=function zi(n){return n.isBoundToModule}(x)?void 0:this._injector.get(Th),F=x.create(Hr.NULL,[],c||x.selector,w),W=F.location.nativeElement,J=F.injector.get(Me,null);return J?.registerApplication(W),F.onDestroy(()=>{this.detachView(F.hostView),Yv(this.components,F),J?.unregisterApplication(W)}),this._loadComponent(F),F}tick(){if(this._runningTick)throw new He(101,!1);try{this._runningTick=!0;for(let o of this._views)o.detectChanges()}catch(o){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(o))}finally{this._runningTick=!1}}attachView(o){const c=o;this._views.push(c),c.attachToAppRef(this)}detachView(o){const c=o;Yv(this._views,c),c.detachFromAppRef()}_loadComponent(o){this.attachView(o.hostView),this.tick(),this.components.push(o);const c=this._injector.get(wi,[]);c.push(...this._bootstrapListeners),c.forEach(p=>p(o))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(o=>o()),this._views.slice().forEach(o=>o.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(o){return this._destroyListeners.push(o),()=>Yv(this._destroyListeners,o)}destroy(){if(this._destroyed)throw new He(406,!1);const o=this._injector;o.destroy&&!o.destroyed&&o.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(o){return new(o||n)(Ut(Jo),Ut(Yl),Ut(Qc))},n.\u0275prov=In({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Yv(n,r){const o=n.indexOf(r);o>-1&&n.splice(o,1)}let Xb=(()=>{class n{}return n.__NG_ELEMENT_ID__=Yb,n})();function Yb(n){return function qb(n,r,o){if(Ts(n)&&!o){const c=sr(n.index,r);return new $p(c,c)}return 47&n.type?new $p(r[Gi],r):null}(or(),Ge(),16==(16&n))}class Vb{constructor(){}supports(r){return kf(r)}create(r){return new tS(r)}}const eS=(n,r)=>r;class tS{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||eS}forEachItem(r){let o;for(o=this._itHead;null!==o;o=o._next)r(o)}forEachOperation(r){let o=this._itHead,c=this._removalsHead,p=0,g=null;for(;o||c;){const x=!c||o&&o.currentIndex<zb(c,p,g)?o:c,w=zb(x,p,g),I=x.currentIndex;if(x===c)p--,c=c._nextRemoved;else if(o=o._next,null==x.previousIndex)p++;else{g||(g=[]);const F=w-p,W=I-p;if(F!=W){for(let le=0;le<F;le++){const pe=le<g.length?g[le]:g[le]=0,Pe=pe+le;W<=Pe&&Pe<F&&(g[le]=pe+1)}g[x.previousIndex]=W-F}}w!==I&&r(x,w,I)}}forEachPreviousItem(r){let o;for(o=this._previousItHead;null!==o;o=o._nextPrevious)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachMovedItem(r){let o;for(o=this._movesHead;null!==o;o=o._nextMoved)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}forEachIdentityChange(r){let o;for(o=this._identityChangesHead;null!==o;o=o._nextIdentityChange)r(o)}diff(r){if(null==r&&(r=[]),!kf(r))throw new He(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let p,g,x,o=this._itHead,c=!1;if(Array.isArray(r)){this.length=r.length;for(let w=0;w<this.length;w++)g=r[w],x=this._trackByFn(w,g),null!==o&&Object.is(o.trackById,x)?(c&&(o=this._verifyReinsertion(o,g,x,w)),Object.is(o.item,g)||this._addIdentityChange(o,g)):(o=this._mismatch(o,g,x,w),c=!0),o=o._next}else p=0,function v0(n,r){if(Array.isArray(n))for(let o=0;o<n.length;o++)r(n[o]);else{const o=n[Symbol.iterator]();let c;for(;!(c=o.next()).done;)r(c.value)}}(r,w=>{x=this._trackByFn(p,w),null!==o&&Object.is(o.trackById,x)?(c&&(o=this._verifyReinsertion(o,w,x,p)),Object.is(o.item,w)||this._addIdentityChange(o,w)):(o=this._mismatch(o,w,x,p),c=!0),o=o._next,p++}),this.length=p;return this._truncate(o),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,o,c,p){let g;return null===r?g=this._itTail:(g=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._reinsertAfter(r,g,p)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(c,p))?(Object.is(r.item,o)||this._addIdentityChange(r,o),this._moveAfter(r,g,p)):r=this._addAfter(new nS(o,c),g,p),r}_verifyReinsertion(r,o,c,p){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==g?r=this._reinsertAfter(g,r._prev,p):r.currentIndex!=p&&(r.currentIndex=p,this._addToMoves(r,p)),r}_truncate(r){for(;null!==r;){const o=r._next;this._addToRemovals(this._unlink(r)),r=o}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,o,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const p=r._prevRemoved,g=r._nextRemoved;return null===p?this._removalsHead=g:p._nextRemoved=g,null===g?this._removalsTail=p:g._prevRemoved=p,this._insertAfter(r,o,c),this._addToMoves(r,c),r}_moveAfter(r,o,c){return this._unlink(r),this._insertAfter(r,o,c),this._addToMoves(r,c),r}_addAfter(r,o,c){return this._insertAfter(r,o,c),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,o,c){const p=null===o?this._itHead:o._next;return r._next=p,r._prev=o,null===p?this._itTail=r:p._prev=r,null===o?this._itHead=r:o._next=r,null===this._linkedRecords&&(this._linkedRecords=new Hb),this._linkedRecords.put(r),r.currentIndex=c,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const o=r._prev,c=r._next;return null===o?this._itHead=c:o._next=c,null===c?this._itTail=o:c._prev=o,r}_addToMoves(r,o){return r.previousIndex===o||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Hb),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,o){return r.item=o,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class nS{constructor(r,o){this.item=r,this.trackById=o,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class iS{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,o){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===o||o<=c.currentIndex)&&Object.is(c.trackById,r))return c;return null}remove(r){const o=r._prevDup,c=r._nextDup;return null===o?this._head=c:o._nextDup=c,null===c?this._tail=o:c._prevDup=o,null===this._head}}class Hb{constructor(){this.map=new Map}put(r){const o=r.trackById;let c=this.map.get(o);c||(c=new iS,this.map.set(o,c)),c.add(r)}get(r,o){const p=this.map.get(r);return p?p.get(r,o):null}remove(r){const o=r.trackById;return this.map.get(o).remove(r)&&this.map.delete(o),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function zb(n,r,o){const c=n.previousIndex;if(null===c)return c;let p=0;return o&&c<o.length&&(p=o[c]),c+r+p}class Gb{constructor(){}supports(r){return r instanceof Map||wg(r)}create(){return new rS}}class rS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let o;for(o=this._mapHead;null!==o;o=o._next)r(o)}forEachPreviousItem(r){let o;for(o=this._previousMapHead;null!==o;o=o._nextPrevious)r(o)}forEachChangedItem(r){let o;for(o=this._changesHead;null!==o;o=o._nextChanged)r(o)}forEachAddedItem(r){let o;for(o=this._additionsHead;null!==o;o=o._nextAdded)r(o)}forEachRemovedItem(r){let o;for(o=this._removalsHead;null!==o;o=o._nextRemoved)r(o)}diff(r){if(r){if(!(r instanceof Map||wg(r)))throw new He(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let o=this._mapHead;if(this._appendAfter=null,this._forEach(r,(c,p)=>{if(o&&o.key===p)this._maybeAddToChanges(o,c),this._appendAfter=o,o=o._next;else{const g=this._getOrCreateRecordForKey(p,c);o=this._insertBeforeOrAppend(o,g)}}),o){o._prev&&(o._prev._next=null),this._removalsHead=o;for(let c=o;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,o){if(r){const c=r._prev;return o._next=r,o._prev=c,r._prev=o,c&&(c._next=o),r===this._mapHead&&(this._mapHead=o),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=o,o._prev=this._appendAfter):this._mapHead=o,this._appendAfter=o,null}_getOrCreateRecordForKey(r,o){if(this._records.has(r)){const p=this._records.get(r);this._maybeAddToChanges(p,o);const g=p._prev,x=p._next;return g&&(g._next=x),x&&(x._prev=g),p._next=null,p._prev=null,p}const c=new sS(r);return this._records.set(r,c),c.currentValue=o,this._addToAdditions(c),c}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,o){Object.is(o,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=o,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,o){r instanceof Map?r.forEach(o):Object.keys(r).forEach(c=>o(r[c],c))}}class sS{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Wb(){return new DM([new Vb])}let DM=(()=>{class n{constructor(o){this.factories=o}static create(o,c){if(null!=c){const p=c.factories.slice();o=o.concat(p)}return new n(o)}static extend(o){return{provide:n,useFactory:c=>n.create(o,c||Wb()),deps:[[n,new Uo,new $r]]}}find(o){const c=this.factories.find(p=>p.supports(o));if(null!=c)return c;throw new He(901,!1)}}return n.\u0275prov=In({token:n,providedIn:"root",factory:Wb}),n})();function $b(){return new IM([new Gb])}let IM=(()=>{class n{constructor(o){this.factories=o}static create(o,c){if(c){const p=c.factories.slice();o=o.concat(p)}return new n(o)}static extend(o){return{provide:n,useFactory:c=>n.create(o,c||$b()),deps:[[n,new Uo,new $r]]}}find(o){const c=this.factories.find(p=>p.supports(o));if(c)return c;throw new He(901,!1)}}return n.\u0275prov=In({token:n,providedIn:"root",factory:$b}),n})();const lS=co(null,"core",[]);let cS=(()=>{class n{constructor(o){}}return n.\u0275fac=function(o){return new(o||n)(Ut(Xv))},n.\u0275mod=Cs({type:n}),n.\u0275inj=vr({}),n})();function uS(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}},582:(Fn,mt,ae)=>{function pt(ye,be,Se,Ee){return new(Se||(Se=Promise))(function(je,Wt){function hi(Ii){try{Mt(Ee.next(Ii))}catch(Ui){Wt(Ui)}}function fi(Ii){try{Mt(Ee.throw(Ii))}catch(Ui){Wt(Ui)}}function Mt(Ii){Ii.done?je(Ii.value):function et(je){return je instanceof Se?je:new Se(function(Wt){Wt(je)})}(Ii.value).then(hi,fi)}Mt((Ee=Ee.apply(ye,be||[])).next())})}function wt(ye){return this instanceof wt?(this.v=ye,this):new wt(ye)}function dt(ye,be,Se){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var et,Ee=Se.apply(ye,be||[]),je=[];return et=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),hi("next"),hi("throw"),hi("return",function Wt(In){return function(Li){return Promise.resolve(Li).then(In,Ui)}}),et[Symbol.asyncIterator]=function(){return this},et;function hi(In,Li){Ee[In]&&(et[In]=function(vr){return new Promise(function(pi,Lr){je.push([In,vr,pi,Lr])>1||fi(In,vr)})},Li&&(et[In]=Li(et[In])))}function fi(In,Li){try{!function Mt(In){In.value instanceof wt?Promise.resolve(In.value.v).then(Ii,Ui):ho(je[0][2],In)}(Ee[In](Li))}catch(vr){ho(je[0][3],vr)}}function Ii(In){fi("next",In)}function Ui(In){fi("throw",In)}function ho(In,Li){In(Li),je.shift(),je.length&&fi(je[0][0],je[0][1])}}function ti(ye){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Se,be=ye[Symbol.asyncIterator];return be?be.call(ye):(ye=function Xt(ye){var be="function"==typeof Symbol&&Symbol.iterator,Se=be&&ye[be],Ee=0;if(Se)return Se.call(ye);if(ye&&"number"==typeof ye.length)return{next:function(){return ye&&Ee>=ye.length&&(ye=void 0),{value:ye&&ye[Ee++],done:!ye}}};throw new TypeError(be?"Object is not iterable.":"Symbol.iterator is not defined.")}(ye),Se={},Ee("next"),Ee("throw"),Ee("return"),Se[Symbol.asyncIterator]=function(){return this},Se);function Ee(je){Se[je]=ye[je]&&function(Wt){return new Promise(function(hi,fi){!function et(je,Wt,hi,fi){Promise.resolve(fi).then(function(Mt){je({value:Mt,done:hi})},Wt)}(hi,fi,(Wt=ye[je](Wt)).done,Wt.value)})}}}ae.d(mt,{FC:()=>dt,KL:()=>ti,mG:()=>pt,qq:()=>wt}),"function"==typeof SuppressedError&&SuppressedError}},Fn=>{Fn(Fn.s=989)}]);